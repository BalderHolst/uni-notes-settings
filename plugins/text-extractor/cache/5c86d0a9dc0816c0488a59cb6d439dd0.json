{"path":"Lessons/Semester 3/signalbehandling/Slides/lektion 9 - Design af IIR filtre.pdf","text":"Lektion 9: Design af IIR ﬁltre Signalbehandling Christoffer Sloth chsl@mmmi.sdu.dk SDU Robotics The Maersk Mc-Kinney Moller Institute University of Southern Denmark 1Agenda Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 2Introduktion Pensum for Signalbehandling Datakonvertering og digital signalbehandling herunder: 1 ▶ ideel og praktisk sampling og rekonstruktion ▶ aliasing ▶ kvantisering og dynamikområde ▶ konverteringsprincipper (A/D og D/A) ▶ implementationsprincipper (Sample & Hold, A/D, D/A) ▶ multirate sampling ▶ diskret-tid signaler og systemer i tids- og frekvensdomænet ▶ Z-transformationen ▶ overføringsfunktion for lineære tidsinvariante systemer ▶ systemanalyse ▶ frekvensanalyse ▶ lineær fase systemer ▶ realisationsstrukturer for diskret-tid systemer ▶ hovedanvendelse af digital signalbehandling herunder digitale IIR-ﬁltre og transformation af analoge ﬁltre samt digitale FIR-ﬁltre og vindues-funktioner 1 Baseret på https://odin.sdu.dk/sitecore/index.php?a=fagbesk&id=65003&listid=9093&lang=da 3Introduktion Course Overview ▶ Lektion 1: Filterfunktioner ▶ Lektion 2: Sampling og rekonstruktion ▶ Lektion 3: Fast Fourier transformation (I) ▶ Lektion 4: Fast Fourier transformation (II) ▶ Lektion 5: Introduktion til z-transformation ▶ Lektion 6: Systemanalyse i z-domæne ▶ Lektion 7: Digitale realisationsstrukturer ▶ Lektion 8: Introduktion til IIR-ﬁltre ▶ Lektion 9: Design af IIR-ﬁltre ▶ Lektion 10: Introduktion til FIR-ﬁltre ▶ Lektion 11: Design af FIR-ﬁltre ▶ Lektion 12: Anvendelse af digital signalbehandling 4Intoduktion Motivation Digitale ﬁltre opdeles i to kategorier, i henhold til deres impulsrespons ▶ Inﬁnite Impulse Response ﬁlters (IIR-ﬁltre) ▶ Har altid poler ▶ Finite Impulse Response ﬁlters (FIR-ﬁltre) ▶ Har kun nulpunkter ▶ Kan implementeres med lineær fasekarakteristik 5Introduktion Design af digitale IIR ﬁltre Et IIR-ﬁlter designes ved at følge proceduren 1. Filtrets speciﬁkationer opstilles 2. Filtrets z-domæne overføringsfunktion opstilles ved brug af ▶ Matched z-transformation ▶ Impuls invariant z-transformation ▶ Bilineær z-transformation 3. Der vælges optimal realisationsstruktur 4. Der fremstilles program til signalprocessor eller tegnes diagram for hardwareløsning 6Bilineær z-transformation Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 7Deﬁnition Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 8Bilineær z-transformation Introduktion Formålet med bilineær z-transformation er at eliminere aliaseringsfejlen som opstår ved både matched z-transformation og impuls invariant z-transformation. Ved bilineær z-transformation substitueres s i H(s) med en funktion af z (s = f (z)) dvs. H(z) = H(s)|s=f (z) Relationen mellem s og z er z = esT , hvilket medfører at s = 1 T ln(z) Det ønskes at indsætte denne relation i stedet for s i overføringsfunktionen, men dette leder ikke til en rationel funktion i z. Derfor approksimeres ln(z). 8Bilineær z-transformation Introduktion Formålet med bilineær z-transformation er at eliminere aliaseringsfejlen som opstår ved både matched z-transformation og impuls invariant z-transformation. Ved bilineær z-transformation substitueres s i H(s) med en funktion af z (s = f (z)) dvs. H(z) = H(s)|s=f (z) Relationen mellem s og z er z = esT , hvilket medfører at s = 1 T ln(z) Det ønskes at indsætte denne relation i stedet for s i overføringsfunktionen, men dette leder ikke til en rationel funktion i z. Derfor approksimeres ln(z). 8Bilineær z-transformation Introduktion Formålet med bilineær z-transformation er at eliminere aliaseringsfejlen som opstår ved både matched z-transformation og impuls invariant z-transformation. Ved bilineær z-transformation substitueres s i H(s) med en funktion af z (s = f (z)) dvs. H(z) = H(s)|s=f (z) Relationen mellem s og z er z = esT , hvilket medfører at s = 1 T ln(z) Det ønskes at indsætte denne relation i stedet for s i overføringsfunktionen, men dette leder ikke til en rationel funktion i z. Derfor approksimeres ln(z). 8Bilineær z-transformation Introduktion Formålet med bilineær z-transformation er at eliminere aliaseringsfejlen som opstår ved både matched z-transformation og impuls invariant z-transformation. Ved bilineær z-transformation substitueres s i H(s) med en funktion af z (s = f (z)) dvs. H(z) = H(s)|s=f (z) Relationen mellem s og z er z = esT , hvilket medfører at s = 1 T ln(z) Det ønskes at indsætte denne relation i stedet for s i overføringsfunktionen, men dette leder ikke til en rationel funktion i z. Derfor approksimeres ln(z). 9Bilineær z-transformation Approksimation af logaritme Den naturlige logaritme er deﬁneret som en undelig sum ln z = 2 [ z − 1 z + 1 + 1 3 ( z − 1 z + 1 )3 + 1 5 ( z − 1 z + 1 )5 + · · · ] Indsættelse af defﬁnitionen direkte i overføringsfunktionen vil give en overføringsfunktion med uendelig orden. Derfor approksimeres logaritmen som ln z ≈ 2 z − 1 z + 1 0 0.5 1 1.5 2 -4 -3 -2 -1 0 1 9Bilineær z-transformation Approksimation af logaritme Den naturlige logaritme er deﬁneret som en undelig sum ln z = 2 [ z − 1 z + 1 + 1 3 ( z − 1 z + 1 )3 + 1 5 ( z − 1 z + 1 )5 + · · · ] Indsættelse af defﬁnitionen direkte i overføringsfunktionen vil give en overføringsfunktion med uendelig orden. Derfor approksimeres logaritmen som ln z ≈ 2 z − 1 z + 1 0 0.5 1 1.5 2 -4 -3 -2 -1 0 1 10Bilineær z-transformation Princip En diskret overføringsfunktion fås dermed ved bilineær z-transformation som H(z) = H(s)|s= 2 T 1−z−1 1+z−1 Betragtes en første ordens overføringsfunktion H(s) = 1 τ s + 1 fås H(z) = 1 τ 2 T 1−z−1 1+z−1 + 1 = 1 + z−1 2τ T + 1 + (1 − 2τ T )z−1 10Bilineær z-transformation Princip En diskret overføringsfunktion fås dermed ved bilineær z-transformation som H(z) = H(s)|s= 2 T 1−z−1 1+z−1 Betragtes en første ordens overføringsfunktion H(s) = 1 τ s + 1 fås H(z) = 1 τ 2 T 1−z−1 1+z−1 + 1 = 1 + z−1 2τ T + 1 + (1 − 2τ T )z−1 11Bilineær z-transformation Relation mellem s- og z-plan (amplitude) Relationen s = 2 T z − 1 z + 1 kan omskrives til z = 2 T + s 2 T − s Lad s = σ + jΩ så gælder det at |z| = √( 2 T + σ)2 + Ω2 √( 2 T − σ)2 + Ω2 11Bilineær z-transformation Relation mellem s- og z-plan (amplitude) Relationen s = 2 T z − 1 z + 1 kan omskrives til z = 2 T + s 2 T − s Lad s = σ + jΩ så gælder det at |z| = √( 2 T + σ)2 + Ω2 √( 2 T − σ)2 + Ω2 11Bilineær z-transformation Relation mellem s- og z-plan (amplitude) Relationen s = 2 T z − 1 z + 1 kan omskrives til z = 2 T + s 2 T − s Lad s = σ + jΩ så gælder det at |z| = √( 2 T + σ)2 + Ω2 √( 2 T − σ)2 + Ω2 σ jΩ Im(z) Re(z) 11Bilineær z-transformation Relation mellem s- og z-plan (amplitude) Relationen s = 2 T z − 1 z + 1 kan omskrives til z = 2 T + s 2 T − s Lad s = σ + jΩ så gælder det at |z| = √( 2 T + σ)2 + Ω2 √( 2 T − σ)2 + Ω2 σ jΩ Im(z) Re(z) Imaginæraksen for s-planen (σ = 0) mappes til enhedscirklen |z| = 1. 11Bilineær z-transformation Relation mellem s- og z-plan (amplitude) Relationen s = 2 T z − 1 z + 1 kan omskrives til z = 2 T + s 2 T − s Lad s = σ + jΩ så gælder det at |z| = √( 2 T + σ)2 + Ω2 √( 2 T − σ)2 + Ω2 σ jΩ Im(z) Re(z) Imaginæraksen for s-planen (σ = 0) mappes til enhedscirklen |z| = 1. Venstre halvplan af s-planen (σ < 0) mappes til det indre af enhedscirklen |z| < 1. 11Bilineær z-transformation Relation mellem s- og z-plan (amplitude) Relationen s = 2 T z − 1 z + 1 kan omskrives til z = 2 T + s 2 T − s Lad s = σ + jΩ så gælder det at |z| = √( 2 T + σ)2 + Ω2 √( 2 T − σ)2 + Ω2 σ jΩ Im(z) Re(z) Imaginæraksen for s-planen (σ = 0) mappes til enhedscirklen |z| = 1. Venstre halvplan af s-planen (σ < 0) mappes til det indre af enhedscirklen |z| < 1. Højre halvplan af s-planen (σ > 0) mappes til z-planen foruden enhedscirklen og dens indre |z|>1. 12Bilineær z-transformation Relation mellem s- og z-plan (fase) Fra z = 2 T + σ + jΩ 2 T − σ − jΩ ses det at argumentet af z for σ = 0 er ∠z = tan −1 ΩT 2 + tan−1 ΩT 2 = 2 tan−1 ΩT 2 12Bilineær z-transformation Relation mellem s- og z-plan (fase) Fra z = 2 T + σ + jΩ 2 T − σ − jΩ ses det at argumentet af z for σ = 0 er ∠z = tan −1 ΩT 2 + tan−1 ΩT 2 = 2 tan−1 ΩT 2 12Bilineær z-transformation Relation mellem s- og z-plan (fase) Fra z = 2 T + σ + jΩ 2 T − σ − jΩ ses det at argumentet af z for σ = 0 er ∠z = tan −1 ΩT 2 + tan−1 ΩT 2 = 2 tan−1 ΩT 2 σ jΩ Im(z) Re(z) 12Bilineær z-transformation Relation mellem s- og z-plan (fase) Fra z = 2 T + σ + jΩ 2 T − σ − jΩ ses det at argumentet af z for σ = 0 er ∠z = tan −1 ΩT 2 + tan−1 ΩT 2 = 2 tan−1 ΩT 2 σ jΩ Im(z) Re(z) Origo for s-planen mappes til z = 1∠0 ◦. 12Bilineær z-transformation Relation mellem s- og z-plan (fase) Fra z = 2 T + σ + jΩ 2 T − σ − jΩ ses det at argumentet af z for σ = 0 er ∠z = tan −1 ΩT 2 + tan−1 ΩT 2 = 2 tan−1 ΩT 2 σ jΩ Im(z) Re(z) ∞ -∞ Origo for s-planen mappes til z = 1∠0 ◦. For Ω gående imod ±∞ går argumentet for z imod ±180◦. 12Bilineær z-transformation Relation mellem s- og z-plan (fase) Fra z = 2 T + σ + jΩ 2 T − σ − jΩ ses det at argumentet af z for σ = 0 er ∠z = tan −1 ΩT 2 + tan−1 ΩT 2 = 2 tan−1 ΩT 2 Frekvensområdet 0 < f < ∞ for det analoge ﬁlter transformeres til frekvensområdet 0 < f < fo for det digitale ﬁlter. σ jΩ Im(z) Re(z) ∞ -∞ Origo for s-planen mappes til z = 1∠0 ◦. For Ω gående imod ±∞ går argumentet for z imod ±180◦. 13Warping og prewarping Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 14Bilineær z-transformation Frekvens warping (I) Da frekvensområdet 0 < f < ∞ for det analoge ﬁlter transformeres til frekvensområdet 0 < f < fo for det digitale ﬁlter, bliver frekvensaksen deformeret. Dette påvirker afskæringsfrekvensen ωa og stopbåndsfrekvensen ωs for det digitale ﬁlter. |H(Ω)| |Hs| |HDC | Ω ΩsΩa |H(ω)| |Hs| |HDC | ω ωsωa 2πfo 15Bilineær z-transformation Frekvens warping (II) Relationen mellem Ω og ω ﬁndes ved at indsætte z = ejωT i s = σ + jΩ = 2 T 1 − z−1 1 + z−1 Dette giver s = 2 T 1 − e−jωT 1 + e−jωT = 2 T ejωT /2 − e−jωT /2 ejωT /2 + e−jωT /2 = 2 T j sin(ωT /2) cos(ωT /2) = 2 T j tan(ωT /2) f o 2 f o 4 f o f o 2 f o 15Bilineær z-transformation Frekvens warping (II) Relationen mellem Ω og ω ﬁndes ved at indsætte z = ejωT i s = σ + jΩ = 2 T 1 − z−1 1 + z−1 Dette giver s = 2 T 1 − e−jωT 1 + e−jωT = 2 T ejωT /2 − e−jωT /2 ejωT /2 + e−jωT /2 = 2 T j sin(ωT /2) cos(ωT /2) = 2 T j tan(ωT /2) f o 2 f o 4 f o f o 2 f o 15Bilineær z-transformation Frekvens warping (II) Relationen mellem Ω og ω ﬁndes ved at indsætte z = ejωT i s = σ + jΩ = 2 T 1 − z−1 1 + z−1 Dette giver s = 2 T 1 − e−jωT 1 + e−jωT = 2 T ejωT /2 − e−jωT /2 ejωT /2 + e−jωT /2 = 2 T j sin(ωT /2) cos(ωT /2) = 2 T j tan(ωT /2) f o 2 f o 4 f o f o 2 f o 16Bilineær z-transformation Frekvens warping (III) Konsekvensen af frekvens warping kan ses af følgende båndpasﬁlter. |Ha| |Hs| Ω4Ω3Ω2Ω1 |H(Ω)| Analogt ﬁlter Ω Ω ω 2πfo|Ha||Hs|ω4ω3ω2ω1|H(ω)|Digitaltﬁlterω 17Bilineær z-transformation Eksempel (I) Et analogt 5. ordens Butterworth lavpasﬁlter H(s) har -3 dB afskæringsfrekvens f3 = 3 kHz og -30 dB stopbåndsfrekvens f30 = 6 kHz. Filtret digitaliseres ved bilineær z-transformation med samplefrekvens 16 kHz. Ved brug af ligningen ω = 2 T tan−1 ( ΩT 2 ) [rad/s] ﬁndes -3 dB afskæringsfrekvensen og -30 dB stopbåndsfrekvens for det digitale ﬁlter ω3 = 17, 03k rad/s og ω30 = 27, 74k rad/s hvilket svarer til 2,7 kHz og 4,4 kHz. 17Bilineær z-transformation Eksempel (I) Et analogt 5. ordens Butterworth lavpasﬁlter H(s) har -3 dB afskæringsfrekvens f3 = 3 kHz og -30 dB stopbåndsfrekvens f30 = 6 kHz. Filtret digitaliseres ved bilineær z-transformation med samplefrekvens 16 kHz. Ved brug af ligningen ω = 2 T tan−1 ( ΩT 2 ) [rad/s] ﬁndes -3 dB afskæringsfrekvensen og -30 dB stopbåndsfrekvens for det digitale ﬁlter ω3 = 17, 03k rad/s og ω30 = 27, 74k rad/s hvilket svarer til 2,7 kHz og 4,4 kHz. 18Bilineær z-transformation Eksempel (II) Konsekvensen af frekvens warping for lavpasﬁltret ses af følgende amplitude-karakteristik. f [Hz] |H(f )| [dB] 2,7k Analogﬁlter Digitalt ﬁlter 0 -3 -30 3k 4,4k 6k 19Bilineær z-transformation Prewarping Ideen ved prewarping er at for-forvrænge det analoge ﬁlters afskæringsfrekvens Ωa og stopbåndsfrekvens Ωs således at det digitale ﬁlters afskæringsfrekvens ωa og stopbåndsfrekvens ωs kommer til at ligge ved ønskede frekvenser. Ω ω |H| |Hs| |HDC | ωs Ωsωa Ωa Prewarped analogﬁlter Digitalt ﬁlter De prewarpede frekvenser ﬁndes ud fra Ω = 2 T tan(ωT /2) [rad/s] 20Bilineær z-transformation Eksempel (I) For at designe et digitalt ﬁlter med -3 dB afskæringsfrekvens på 3 kHz og -30 dB stopbåndsfrekvens ≤ 6 kHz, så skal de tilsvarende (Prewarpede) frekvenser ﬁndes for et analogt ﬁlter ved brug af Ω = 2 T tan ( ωT 2 ) [rad/s] Når samplefrekvensen er 16 kHz bliver disse frekvenser Ω3 = 21, 38k rad/s og Ω30 = 77, 25k rad/s hvilket svarer til 3,4 kHz og 12,3 kHz. Nu kan et frekvensnormeret lavpasﬁlter designes med stopbåndsfrekvens f30 f3 = 12, 3k 3, 4k = 3, 6 20Bilineær z-transformation Eksempel (I) For at designe et digitalt ﬁlter med -3 dB afskæringsfrekvens på 3 kHz og -30 dB stopbåndsfrekvens ≤ 6 kHz, så skal de tilsvarende (Prewarpede) frekvenser ﬁndes for et analogt ﬁlter ved brug af Ω = 2 T tan ( ωT 2 ) [rad/s] Når samplefrekvensen er 16 kHz bliver disse frekvenser Ω3 = 21, 38k rad/s og Ω30 = 77, 25k rad/s hvilket svarer til 3,4 kHz og 12,3 kHz. Nu kan et frekvensnormeret lavpasﬁlter designes med stopbåndsfrekvens f30 f3 = 12, 3k 3, 4k = 3, 6 20Bilineær z-transformation Eksempel (I) For at designe et digitalt ﬁlter med -3 dB afskæringsfrekvens på 3 kHz og -30 dB stopbåndsfrekvens ≤ 6 kHz, så skal de tilsvarende (Prewarpede) frekvenser ﬁndes for et analogt ﬁlter ved brug af Ω = 2 T tan ( ωT 2 ) [rad/s] Når samplefrekvensen er 16 kHz bliver disse frekvenser Ω3 = 21, 38k rad/s og Ω30 = 77, 25k rad/s hvilket svarer til 3,4 kHz og 12,3 kHz. Nu kan et frekvensnormeret lavpasﬁlter designes med stopbåndsfrekvens f30 f3 = 12, 3k 3, 4k = 3, 6 21Bilineær z-transformation Eksempel (II) For det speciﬁkke ﬁlter er det nødvendige ordenstal 3. Proceduren for at ﬁnde det digitale ﬁlter ud fra det frekvensnormerede prototype ﬁlter er 1. Denormer prototypeﬁltret til den prewarpede afskæringsfrekvens Ωa 2. Find det digitale ﬁlter ved bilineær z-transformation Det er dog muligt at ﬁnde det digitale ﬁlter direkte ud fra prototypeﬁltret ved brug af H(z) = H(s)| s=C 1−z−1 1+z−1 hvor C er prewarpingkonstanten, der benyttes i stedet for 2 T , for at skalere frekvensen. 21Bilineær z-transformation Eksempel (II) For det speciﬁkke ﬁlter er det nødvendige ordenstal 3. Proceduren for at ﬁnde det digitale ﬁlter ud fra det frekvensnormerede prototype ﬁlter er 1. Denormer prototypeﬁltret til den prewarpede afskæringsfrekvens Ωa 2. Find det digitale ﬁlter ved bilineær z-transformation Det er dog muligt at ﬁnde det digitale ﬁlter direkte ud fra prototypeﬁltret ved brug af H(z) = H(s)| s=C 1−z−1 1+z−1 hvor C er prewarpingkonstanten, der benyttes i stedet for 2 T , for at skalere frekvensen. 22Bilineær z-transformation Eksempel (III) Prewarpingkonstanten bestemmes ud fra relationen Ωa = C tan ( ωaT 2 ) [rad/s] hvor Ωa er afskæringsfrekvensen for det frekvensnormerede analoge ﬁlter (som altid er 1 rad/s) og ωa er den ønskede afskæringsfrekvens for det digitale ﬁlter. Derfor bliver prewarpingkonstanten C = 1 tan ( ωaT 2 ) = cot ( ωaT 2 ) 22Bilineær z-transformation Eksempel (III) Prewarpingkonstanten bestemmes ud fra relationen Ωa = C tan ( ωaT 2 ) [rad/s] hvor Ωa er afskæringsfrekvensen for det frekvensnormerede analoge ﬁlter (som altid er 1 rad/s) og ωa er den ønskede afskæringsfrekvens for det digitale ﬁlter. Derfor bliver prewarpingkonstanten C = 1 tan ( ωaT 2 ) = cot ( ωaT 2 ) 23Koefﬁcienter af 1. ordens systemer Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 24Bilineær z-transformation Koefﬁcienter af 1. ordens systemer Et første ordens system har formen H(s) = A1s + A0 B1s + B0 og ved bilineær z-transformation fås H(z) = H(s)| s=C 1−z−1 1+z−1 = A1C 1−z−1 1+z−1 + A0 B1C 1−z−1 1+z−1 + B0 = A1C(1 − z−1) + A0(1 + z−1) B1C(1 − z−1) + B0(1 + z−1) = A0+A1C B0+B1C + A0−A1C B0+B1C z−1 1 + B0−B1C B0+B1C z−1 Dermed bliver det digitale ﬁlter H(z) = a0 + a1z−1 1 + b1z−1 hvor a0 = A0 + A1C B0 + B1C , a1 = A0 − A1C B0 + B1C , b1 = B0 − B1C B0 + B1C 24Bilineær z-transformation Koefﬁcienter af 1. ordens systemer Et første ordens system har formen H(s) = A1s + A0 B1s + B0 og ved bilineær z-transformation fås H(z) = H(s)| s=C 1−z−1 1+z−1 = A1C 1−z−1 1+z−1 + A0 B1C 1−z−1 1+z−1 + B0 = A1C(1 − z−1) + A0(1 + z−1) B1C(1 − z−1) + B0(1 + z−1) = A0+A1C B0+B1C + A0−A1C B0+B1C z−1 1 + B0−B1C B0+B1C z−1 Dermed bliver det digitale ﬁlter H(z) = a0 + a1z−1 1 + b1z−1 hvor a0 = A0 + A1C B0 + B1C , a1 = A0 − A1C B0 + B1C , b1 = B0 − B1C B0 + B1C 25Bilineær z-transformation Eksempel (I) Betragt det frekvensnormerede 1. ordens lavpasﬁlter H(s) = 1 s + 1 hvilket svarer til A0 = 1 A1 = 0 B0 = 1 B1 = 1 Et digitalt ﬁlter med afskæringsfrekvens 300 Hz ønskes designet med en samplingfrekvens på 16 kHz. For at ﬁnde det digitale ﬁlters koefﬁcienter udregnes prewarpingkonstanten C = cot ( ωaT 2 ) = 16, 957 Ved brug af formlerne for a0, a1, b1 ﬁndes H(z) = 0, 056 + 0, 056z−1 1 − 0, 889z−1 25Bilineær z-transformation Eksempel (I) Betragt det frekvensnormerede 1. ordens lavpasﬁlter H(s) = 1 s + 1 hvilket svarer til A0 = 1 A1 = 0 B0 = 1 B1 = 1 Et digitalt ﬁlter med afskæringsfrekvens 300 Hz ønskes designet med en samplingfrekvens på 16 kHz. For at ﬁnde det digitale ﬁlters koefﬁcienter udregnes prewarpingkonstanten C = cot ( ωaT 2 ) = 16, 957 Ved brug af formlerne for a0, a1, b1 ﬁndes H(z) = 0, 056 + 0, 056z−1 1 − 0, 889z−1 25Bilineær z-transformation Eksempel (I) Betragt det frekvensnormerede 1. ordens lavpasﬁlter H(s) = 1 s + 1 hvilket svarer til A0 = 1 A1 = 0 B0 = 1 B1 = 1 Et digitalt ﬁlter med afskæringsfrekvens 300 Hz ønskes designet med en samplingfrekvens på 16 kHz. For at ﬁnde det digitale ﬁlters koefﬁcienter udregnes prewarpingkonstanten C = cot ( ωaT 2 ) = 16, 957 Ved brug af formlerne for a0, a1, b1 ﬁndes H(z) = 0, 056 + 0, 056z−1 1 − 0, 889z−1 26Bilineær z-transformation Eksempel (II) Filtret har et nulpunkt i z = −1 og en pol i z = 0, 889 og har følgende realisationsstruktur. x(n) + + y(n) 0,056 z-1 0,889 0,056 Re(z) Im(z) 27Bilineær z-transformation Eksempel (III) Det ses af amplitudekarakteristikken for ﬁltret at aliaseringsfejlen er elimineret ved bilineær z-transformation. f [Hz] |H(f )| [dB] 300 Analogﬁlter Matched 0 -3 10k Bilineær 28Koefﬁcienter af 2. ordens systemer Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 29Bilineær z-transformation Koefﬁcienter af 2. ordens systemer Et 2. ordens system har formen H(s) = A2s 2 + A1s + A0 B2s2 + B1s + B0 og ved bilineær z-transformation fås H(z) = H(s)| s=C 1−z−1 1+z−1 = A2 (C 1−z−1 1+z−1 )2 + A1 (C 1−z−1 1+z−1 ) + A0 B2 (C 1−z−1 1+z−1 )2 + B1 (C 1−z−1 1+z−1 ) + B0 = A0+A1C+A2C2 B0+B1C+B2C2 + 2(A0−A2C2) B0+B1C+B2C2 z−1 + A0−A1C+A2C2 B0+B1C+B2C2 z−2 1 + 2(B0−B2C2) B0+B1C+B2C2 z−1 + B0−B1C+B2C2 B0+B1C+B2C2 z−2 Dermed bliver det digitale ﬁlter H(z) = a0 + a1z−1 + a2z−2 1 + b1z−1 + b2z−2 hvor a0 = A0 + A1C + A2C 2 B0 + B1C + B2C 2 , a1 = 2(A0 − A2C 2) B0 + B1C + B2C 2 , a2 = A0 − A1C + A2C 2 B0 + B1C + B2C 2 29Bilineær z-transformation Koefﬁcienter af 2. ordens systemer Et 2. ordens system har formen H(s) = A2s 2 + A1s + A0 B2s2 + B1s + B0 og ved bilineær z-transformation fås H(z) = H(s)| s=C 1−z−1 1+z−1 = A2 (C 1−z−1 1+z−1 )2 + A1 (C 1−z−1 1+z−1 ) + A0 B2 (C 1−z−1 1+z−1 )2 + B1 (C 1−z−1 1+z−1 ) + B0 = A0+A1C+A2C2 B0+B1C+B2C2 + 2(A0−A2C2) B0+B1C+B2C2 z−1 + A0−A1C+A2C2 B0+B1C+B2C2 z−2 1 + 2(B0−B2C2) B0+B1C+B2C2 z−1 + B0−B1C+B2C2 B0+B1C+B2C2 z−2 Dermed bliver det digitale ﬁlter H(z) = a0 + a1z−1 + a2z−2 1 + b1z−1 + b2z−2 hvor a0 = A0 + A1C + A2C 2 B0 + B1C + B2C 2 , a1 = 2(A0 − A2C 2) B0 + B1C + B2C 2 , a2 = A0 − A1C + A2C 2 B0 + B1C + B2C 2 29Bilineær z-transformation Koefﬁcienter af 2. ordens systemer H(z) = H(s)|s=C 1−z−1 1+z−1 = A2 (C 1−z−1 1+z−1 )2 + A1 (C 1−z−1 1+z−1 ) + A0 B2 (C 1−z−1 1+z−1 )2 + B1 (C 1−z−1 1+z−1 ) + B0 = A0+A1C+A2C2 B0+B1C+B2C2 + 2(A0−A2C2) B0+B1C+B2C2 z−1 + A0−A1C+A2C2 B0+B1C+B2C2 z−2 1 + 2(B0−B2C2) B0+B1C+B2C2 z−1 + B0−B1C+B2C2 B0+B1C+B2C2 z−2 Dermed bliver det digitale ﬁlter H(z) = a0 + a1z−1 + a2z−2 1 + b1z−1 + b2z−2 hvor a0 = A0 + A1C + A2C 2 B0 + B1C + B2C 2 , a1 = 2(A0 − A2C 2) B0 + B1C + B2C 2 , a2 = A0 − A1C + A2C 2 B0 + B1C + B2C 2 30Bilineær z-transformation Eksempel (I) Betragt følgende frekvensnormerede 2. ordens Butterworth lavpasﬁlter H(s) = 1 s2 + 1, 414s + 1 Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens 800 Hz og samplefrekvens 8 kHz. Det digitale ﬁlter designes ved at ﬁnde prewarpingkonstanten C = cot ( ωaT 2 ) = 3, 078 hvorefter ﬁlterkoefﬁcienterne kan beregnes til a0 = 0, 07 a1 = 0, 13 a2 = 0, 07 b1 = −1, 14 b2 = 0, 41 Slutteligt bliver ﬁltrets overføringsfunktion H(z) = 0, 07 + 0, 13z−1 + 0, 07z−2 1 − 1, 14z−1 + 0, 41z−2 30Bilineær z-transformation Eksempel (I) Betragt følgende frekvensnormerede 2. ordens Butterworth lavpasﬁlter H(s) = 1 s2 + 1, 414s + 1 Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens 800 Hz og samplefrekvens 8 kHz. Det digitale ﬁlter designes ved at ﬁnde prewarpingkonstanten C = cot ( ωaT 2 ) = 3, 078 hvorefter ﬁlterkoefﬁcienterne kan beregnes til a0 = 0, 07 a1 = 0, 13 a2 = 0, 07 b1 = −1, 14 b2 = 0, 41 Slutteligt bliver ﬁltrets overføringsfunktion H(z) = 0, 07 + 0, 13z−1 + 0, 07z−2 1 − 1, 14z−1 + 0, 41z−2 30Bilineær z-transformation Eksempel (I) Betragt følgende frekvensnormerede 2. ordens Butterworth lavpasﬁlter H(s) = 1 s2 + 1, 414s + 1 Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens 800 Hz og samplefrekvens 8 kHz. Det digitale ﬁlter designes ved at ﬁnde prewarpingkonstanten C = cot ( ωaT 2 ) = 3, 078 hvorefter ﬁlterkoefﬁcienterne kan beregnes til a0 = 0, 07 a1 = 0, 13 a2 = 0, 07 b1 = −1, 14 b2 = 0, 41 Slutteligt bliver ﬁltrets overføringsfunktion H(z) = 0, 07 + 0, 13z−1 + 0, 07z−2 1 − 1, 14z−1 + 0, 41z−2 30Bilineær z-transformation Eksempel (I) Betragt følgende frekvensnormerede 2. ordens Butterworth lavpasﬁlter H(s) = 1 s2 + 1, 414s + 1 Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens 800 Hz og samplefrekvens 8 kHz. Det digitale ﬁlter designes ved at ﬁnde prewarpingkonstanten C = cot ( ωaT 2 ) = 3, 078 hvorefter ﬁlterkoefﬁcienterne kan beregnes til a0 = 0, 07 a1 = 0, 13 a2 = 0, 07 b1 = −1, 14 b2 = 0, 41 Slutteligt bliver ﬁltrets overføringsfunktion H(z) = 0, 07 + 0, 13z−1 + 0, 07z−2 1 − 1, 14z−1 + 0, 41z−2 31Bilineær z-transformation Eksempel (II) Det digitale ﬁlter har to nulpunkter i z = −1 og poler i z = 0, 57 ± j0, 29. Realisationsstrukturen for ﬁltret er vist herunder. + + + +0,13 z-1 z-1 1,14 0,06 0,07-0,41 Re(z) Im(z)x(n) y(n) 32Bilineær z-transformation Eksempel (III) f [Hz] |H(f )| [dB] 800 Analogﬁlter Matched og impuls invariant 0 -3 10k Bilineær f [Hz] |ϕ(f )| [◦] 800 Analogﬁlter Matched 10k Impuls invariant og bilineær 33Bilineær z-transformation Eksempel (IV) nT [µs] h(nT ) 0,3 0,2 0,1 0 -1 750650500250 Matched Impuls invariant Bilineær 34Eksempel Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 35Bilineær z-transformation Design procedure Følgende er proceduren for design af digitale ﬁltre ved brug af bilineær z-transformation 1. Prewarping konstanten bestemmes som C = cot ωiT 2 hvor i = a ved lavpasﬁlterdesign og i = c ved design af båndpas- og båndstopﬁltre. 2. Ordenstallet for ﬁltret bestemmes på baggrund af den prewarpede stopbåndsfrekvens. 3. Den frekvensnormerede og faktoriserede analoge overføringsfunktion H(s) opstilles. 4. Den digitale overføringsfunktions koefﬁcienter beregnes. 5. Filtret implementeres som en kaskadekoblet realisationsstruktur. 36Bilineær z-transformation Design af højpasﬁlter (I) Design et 0,5 dB Chebyshev højpasﬁlter med speciﬁkationer som vist i ﬁguren. -60 H(f ) [dB] f [Hz] f0,5 = 500f60 = 100 0 Bestem prewarping konstanten ud fra afskæringsfrekvensen f0,5 C = cot 2πf0,5T 2 = 5, 027 Bestem ordenstallet på baggrund af den prewarpede stopbåndsfrekvens Ω60 = C tan 2πf60T 2 = 0, 1975 36Bilineær z-transformation Design af højpasﬁlter (I) Design et 0,5 dB Chebyshev højpasﬁlter med speciﬁkationer som vist i ﬁguren. -60 H(f ) [dB] f [Hz] f0,5 = 500f60 = 100 0 Bestem prewarping konstanten ud fra afskæringsfrekvensen f0,5 C = cot 2πf0,5T 2 = 5, 027 Bestem ordenstallet på baggrund af den prewarpede stopbåndsfrekvens Ω60 = C tan 2πf60T 2 = 0, 1975 36Bilineær z-transformation Design af højpasﬁlter (I) Design et 0,5 dB Chebyshev højpasﬁlter med speciﬁkationer som vist i ﬁguren. -60 H(f ) [dB] f [Hz] f0,5 = 500f60 = 100 0 Bestem prewarping konstanten ud fra afskæringsfrekvensen f0,5 C = cot 2πf0,5T 2 = 5, 027 Bestem ordenstallet på baggrund af den prewarpede stopbåndsfrekvens Ω60 = C tan 2πf60T 2 = 0, 1975 37Bilineær z-transformation Design af højpasﬁlter (II) Ordenstallet ﬁndes fra et 0,5 dB Chebyshev lavpasﬁlter med normeret stopbåndsfrekvens Ω0,5 Ω60 = 1 0, 1975 = 5, 063 Ordenstallet aﬂæses til N = 4. Fra tabelopslag har 0,5 dB Chebyshev lavpasﬁltret overføringsfunktion Hlp(s) = 0, 35641 s2 + 0, 84668s + 0, 35641 1, 06352 s2 + 0, 35071s + 1, 06352 Et høspasﬁlter opnås ved at erstatte s med 1/s Hhp(s) = s 2 s2 + 2, 376s + 2, 806 s 2 s2 + 0, 3298s + 0, 9403 37Bilineær z-transformation Design af højpasﬁlter (II) Ordenstallet ﬁndes fra et 0,5 dB Chebyshev lavpasﬁlter med normeret stopbåndsfrekvens Ω0,5 Ω60 = 1 0, 1975 = 5, 063 Ordenstallet aﬂæses til N = 4. Fra tabelopslag har 0,5 dB Chebyshev lavpasﬁltret overføringsfunktion Hlp(s) = 0, 35641 s2 + 0, 84668s + 0, 35641 1, 06352 s2 + 0, 35071s + 1, 06352 Et høspasﬁlter opnås ved at erstatte s med 1/s Hhp(s) = s 2 s2 + 2, 376s + 2, 806 s 2 s2 + 0, 3298s + 0, 9403 37Bilineær z-transformation Design af højpasﬁlter (II) Ordenstallet ﬁndes fra et 0,5 dB Chebyshev lavpasﬁlter med normeret stopbåndsfrekvens Ω0,5 Ω60 = 1 0, 1975 = 5, 063 Ordenstallet aﬂæses til N = 4. Fra tabelopslag har 0,5 dB Chebyshev lavpasﬁltret overføringsfunktion Hlp(s) = 0, 35641 s2 + 0, 84668s + 0, 35641 1, 06352 s2 + 0, 35071s + 1, 06352 Et høspasﬁlter opnås ved at erstatte s med 1/s Hhp(s) = s 2 s2 + 2, 376s + 2, 806 s 2 s2 + 0, 3298s + 0, 9403 38Bilineær z-transformation Design af højpasﬁlter (III) Den digitale overføringsfunktion fås ved bilineær z-transformation til H(z) = 0, 6315 − 1, 2629z−1 + 0, 6315z−2 1 − 1, 1227z−1 + 0, 4031z−2 · 0, 9068 − 1, 814z−1 + 0, 9068z−2 1 − 1, 7461z−1 + 0, 8810z−2 f [Hz] |H(f )| [dB] 500 0 -60 100 38Bilineær z-transformation Design af højpasﬁlter (III) Den digitale overføringsfunktion fås ved bilineær z-transformation til H(z) = 0, 6315 − 1, 2629z−1 + 0, 6315z−2 1 − 1, 1227z−1 + 0, 4031z−2 · 0, 9068 − 1, 814z−1 + 0, 9068z−2 1 − 1, 7461z−1 + 0, 8810z−2 f [Hz] |H(f )| [dB] 500 0 -60 100 39Opsummering Introduktion Bilineær z-transformation Deﬁnition Warping og prewarping Koefﬁcienter af 1. ordens systemer Koefﬁcienter af 2. ordens systemer Eksempel Opsummering 40Opsummering Filter design Et IIR-ﬁlter designes ved at følge proceduren 1. Filtrets speciﬁkationer opstilles 2. Filtrets z-domæne overføringsfunktion opstilles ved brug af ▶ Matched z-transformation ▶ Impuls invariant z-transformation ▶ Bilineær z-transformation 3. Der vælges optimal realisationsstruktur 4. Der fremstilles program til signalprocessor eller tegnes diagram for hardwareløsning 41Opsummering Bilineær z-transformation En diskret overføringsfunktion fås ved bilineær z-transformation som H(z) = H(s)|s= 2 T 1−z−1 1+z−1 Da frekvensområdet 0 < f < ∞ for det analoge ﬁlter transformeres til frekvensområdet 0 < f < fo for det digitale ﬁlter, bliver frekvensaksen deformeret. Dette kaldes frekvens warping, og er årsagen til at udføre prewarping. 42Opsummering Design procedure Følgende er proceduren for design af digitale ﬁltre ved brug af bilineær z-transformation 1. Prewarping konstanten bestemmes som C = cot ωiT 2 hvor i = a ved lavpasﬁlterdesign og i = c ved design af båndpas- og båndstopﬁltre. 2. Ordenstallet for ﬁltret bestemmes på baggrund af den prewarpede stopbåndsfrekvens. 3. Den frekvensnormerede og faktoriserede analoge overføringsfunktion H(s) opstilles. 4. Den digitale overføringsfunktions koefﬁcienter beregnes. 5. Filtret implementeres som en kaskadekoblet realisationsstruktur.","libVersion":"0.2.4","langs":""}