{"path":"Lessons/Semester 3/signalbehandling/PDFs/lektion 7 - Digitale realisationsstrukturer.pdf","text":"Lektion 7: Digitale realisationsstrukturer Signalbehandling Christoffer Sloth chsl@mmmi.sdu.dk SDU Robotics The Maersk Mc-Kinney Moller Institute University of Southern Denmark 1Agenda Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 2Introduktion Pensum for Signalbehandling Datakonvertering og digital signalbehandling herunder: 1 ▶ ideel og praktisk sampling og rekonstruktion ▶ aliasing ▶ kvantisering og dynamikområde ▶ konverteringsprincipper (A/D og D/A) ▶ implementationsprincipper (Sample & Hold, A/D, D/A) ▶ multirate sampling ▶ diskret-tid signaler og systemer i tids- og frekvensdomænet ▶ Z-transformationen ▶ overføringsfunktion for lineære tidsinvariante systemer ▶ systemanalyse ▶ frekvensanalyse ▶ lineær fase systemer ▶ realisationsstrukturer for diskret-tid systemer ▶ hovedanvendelse af digital signalbehandling herunder digitale IIR-ﬁltre og transformation af analoge ﬁltre samt digitale FIR-ﬁltre og vindues-funktioner 1 Baseret på https://odin.sdu.dk/sitecore/index.php?a=fagbesk&id=65003&listid=9093&lang=da 3Introduktion Lektionsplan ▶ Lektion 1: Filterfunktioner ▶ Lektion 2: Sampling og rekonstruktion ▶ Lektion 3: Fast Fourier transformation (I) ▶ Lektion 4: Fast Fourier transformation (II) ▶ Lektion 5: Introduktion til z-transformation ▶ Lektion 6: Systemanalyse i z-domæne ▶ Lektion 7: Digitale realisationsstrukturer ▶ Lektion 8: Introduktion til IIR-ﬁltre ▶ Lektion 9: Design af IIR-ﬁltre ▶ Lektion 10: Introduktion til FIR-ﬁltre ▶ Lektion 11: Design af FIR-ﬁltre ▶ Lektion 12: Anvendelse af digital signalbehandling 4Tidsdiskret systemteori Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 5Tidsdiskret foldning Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 6Tidsdiskret foldning Deﬁnition Tidsdiskret foldning kan benyttes til udregning af udgangssekvensen for et tidsdiskret system ved brug af indgangssekvensen x(n) og impulsresponset h(n). H(z) h(n) x(n) y(n) = x(n) ∗ h(n) Foldningssummen er deﬁneret som y(n) = x(n) ∗ h(n) = n∑ m=0 x(m)h(n − m) Udgangssekvensen y(n) kan også udregnes ved y(n) = h(n) ∗ x(n) = n∑ m=0 h(m)x(n − m) 6Tidsdiskret foldning Deﬁnition Tidsdiskret foldning kan benyttes til udregning af udgangssekvensen for et tidsdiskret system ved brug af indgangssekvensen x(n) og impulsresponset h(n). H(z) h(n) x(n) y(n) = x(n) ∗ h(n) Foldningssummen er deﬁneret som y(n) = x(n) ∗ h(n) = n∑ m=0 x(m)h(n − m) Udgangssekvensen y(n) kan også udregnes ved y(n) = h(n) ∗ x(n) = n∑ m=0 h(m)x(n − m) 6Tidsdiskret foldning Deﬁnition Tidsdiskret foldning kan benyttes til udregning af udgangssekvensen for et tidsdiskret system ved brug af indgangssekvensen x(n) og impulsresponset h(n). H(z) h(n) x(n) y(n) = x(n) ∗ h(n) Foldningssummen er deﬁneret som y(n) = x(n) ∗ h(n) = n∑ m=0 x(m)h(n − m) Udgangssekvensen y(n) kan også udregnes ved y(n) = h(n) ∗ x(n) = n∑ m=0 h(m)x(n − m) 7Tidsdiskret foldning Eksempel (I) Vi betragter et system med følgende impulsrespons og indgangssekvens. h(n) = 0, 5n x(n) = u(n) − u(n − 4) 1 0,5 n 1 n 0 1 2 3 4 5 6 7 8 0 1 2 3 4 5 6 7 8 Det ønskes at bestemme udgangssekvensen y(n) ved brug af tidsdiskret foldning y(n) = h(n) ∗ x(n) = 0, 5 n ∗ [u(n) − u(n − 4)] hvor u(n) er enhedsspringsekvensen. 7Tidsdiskret foldning Eksempel (I) Vi betragter et system med følgende impulsrespons og indgangssekvens. h(n) = 0, 5n x(n) = u(n) − u(n − 4) 1 0,5 n 1 n 0 1 2 3 4 5 6 7 8 0 1 2 3 4 5 6 7 8 Det ønskes at bestemme udgangssekvensen y(n) ved brug af tidsdiskret foldning y(n) = h(n) ∗ x(n) = 0, 5 n ∗ [u(n) − u(n − 4)] hvor u(n) er enhedsspringsekvensen. 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) h(m) x(n − m) m n = 0 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 1 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 2 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) For n = 3 haves y(3) = h(0)x(3) + h(1)x(2) + h(2)x(1) + h(3)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 3 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) For n = 3 haves y(3) = h(0)x(3) + h(1)x(2) + h(2)x(1) + h(3)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 4 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) For n = 3 haves y(3) = h(0)x(3) + h(1)x(2) + h(2)x(1) + h(3)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 5 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) For n = 3 haves y(3) = h(0)x(3) + h(1)x(2) + h(2)x(1) + h(3)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 6 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) For n = 3 haves y(3) = h(0)x(3) + h(1)x(2) + h(2)x(1) + h(3)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 7 8Tidsdiskret foldning Eksempel (II) Udgangssekvensen udregnes ved brug af y(n) = n∑ m=0 h(m)x(n − m) For n = 0 haves y(0) = h(0)x(0) For n = 1 haves y(1) = h(0)x(1) + h(1)x(0) For n = 2 haves y(2) = h(0)x(2) + h(1)x(1) + h(2)x(0) For n = 3 haves y(3) = h(0)x(3) + h(1)x(2) + h(2)x(1) + h(3)x(0) h(m) x(n − m) m 1 0,5 0 1 2 3 4 5 6 7 8 n y(n) 0 1 2 3 4 5 6 7 8 n = 8 9Overblik over z-domæneanalyse Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 10Overblik over z-domæneanalyse Transformationer Den z-transformerede af en kausal sekvens x(n) er deﬁneret som X(z) = Z{x(n)} = ∞∑ n=0 x(n)z−n hvor z ∈ C. Laplacetransformation af signalet x(t) er deﬁneret som X(s) = L{x(t)} = ∫ ∞ 0− x(t)e−stdt hvor s ∈ C. 11Overblik over z-domæneanalyse System beskrivelse Vi betragter en differensligning kan skrives som y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Ved z-transformation fås overføringsfunktionen H(z) = Y (z) X(z) = ∑N i=0 aiz−i 1 + ∑N i=1 biz−i Vi betragter en differentialligning kan skrives som y(t) = N∑ i=0 aix(i)(t) − N∑ i=1 biy(i)(t) Ved Laplacetransformation fås overføringsfunktionen H(s) = Y (s) X(s) = ∑N i=0 ais i 1 + ∑N i=1 bisi 12Overblik over z-domæneanalyse Frekvensrespons Et systems frekvensrespons er responset (udgangssignalet) når et sinudialt input påtrykkes et system. For at studere et tidsdiskret systems respons til sinusformede signaler kan der kigges udelukkende på værdier for z, der ligger på enhedscirklen, dvs. z = ejωT Frekvensresponset er givet af M (ω) = |H(ejωT )| og ϕ(ω) = ∠H(ejωT ) For at studere et tidskontinuert systems respons til sinusformede signaler kan der kigges udelukkende på værdier for s, der ligger på imaginæraksen, dvs. s = jω Frekvensresponset er givet af M (ω) = |H(jω)| og ϕ(ω) = ∠H(jω) 13Overblik over z-domæneanalyse Stabilitet Lad H(z) være overføringsfunktionen for et tidsdiskret system med poler p1, p2, . . . , pN ∈ C. Så gælder det at systemet er stabilt hvis alle poler ligger indenfor enhedscirklen, dvs. |pi| < 1 for i = 1, 2, . . . , N Lad H(s) være overføringsfunktionen for et tidskontinuert system med poler p1, p2, . . . , pN ∈ C. Så gælder det at systemet er stabilt hvis alle poler ligger i venstre halvplan, dvs. Re (pi) < 0 for i = 1, 2, . . . , N 14Overblik over z-domæneanalyse Impulsrespons En enhedssample δ(n) er en sekvens givet som δ(n) = { 1 for n = 0 0 ellers Impulsresponset for et tidsdiskret system kaldes h(n), og er identisk med systemets udgangssekvens når inputsekvensen er en enhedssample δ(n). En impuls δ(t) er et meget kort og kraftigt signal, der har følgende egenskab ∫ ∞ −∞ u(τ )δ(t − τ )dτ = u(t) hvor u er en kontinuerlig funktion og δ er en Dirac delta-funktion. Impulsresponset h(t − τ ) for et lineært tidsinvariant system deﬁneres som responset (outputtet) til tiden t når en impuls er tilføjet som input til tiden τ . 15Overblik over z-domæneanalyse Foldning til udregning af respons Udgangssekvensen y(n) kan også udregnes ved y(n) = h(n) ∗ x(n) = n∑ m=0 h(m)x(n − m) For lineære tidsinvariante systemer gælder det at y(t) = ∫ ∞ −∞ h(τ )u(t − τ )dτ Denne ligning kaldes foldningsintegralet. 16Direkte realisationsstrukturer Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 17Direkte realisationsstrukturer Introduktion I det følgende tages der udgangspunkt i differensligningen y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Ved z-transformation fås følgende overføringsfunktion H(z) = Y (z) X(z) = ∑N i=0 aiz−i 1 + ∑N i=1 biz−i Differensligningen kan implementeres på ﬂere måder. Vi kigger på ▶ Direkte type 1 strukturen ▶ Direkte type 2 strukturen 17Direkte realisationsstrukturer Introduktion I det følgende tages der udgangspunkt i differensligningen y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Ved z-transformation fås følgende overføringsfunktion H(z) = Y (z) X(z) = ∑N i=0 aiz−i 1 + ∑N i=1 biz−i Differensligningen kan implementeres på ﬂere måder. Vi kigger på ▶ Direkte type 1 strukturen ▶ Direkte type 2 strukturen 17Direkte realisationsstrukturer Introduktion I det følgende tages der udgangspunkt i differensligningen y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Ved z-transformation fås følgende overføringsfunktion H(z) = Y (z) X(z) = ∑N i=0 aiz−i 1 + ∑N i=1 biz−i Differensligningen kan implementeres på ﬂere måder. Vi kigger på ▶ Direkte type 1 strukturen ▶ Direkte type 2 strukturen 18Direkte realisationsstrukturer Blokdiagrammer og signalgrafer Blokdiagrammer og signalgrafer benyttes til at illustrere implementeringen af tidsdiskrete systemer. x(n) + y(n) z-1 z-1 a0 a2 + + -b1 -b2 x(n) y(n) z-1 z-1 a0 a2 -b1 -b2 19Direkte type 1 Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 20Direkte type 1 Overblik Følgende differensligning ønskes implementeret y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Første del af strukturen er N∑ i=0 aix(n − i) 20Direkte type 1 Overblik Følgende differensligning ønskes implementeret y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Første del af strukturen er N∑ i=0 aix(n − i) z-1 + + + + z-1 z-1 y(n) -b1 -b2 -b3 + z-1 -bN -1 -bN x(n) + + + + a1 z-1 z-1 z-1 a0 a2 a3 + z-1 aN -1 aN 20Direkte type 1 Overblik Følgende differensligning ønskes implementeret y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Første del af strukturen er N∑ i=0 aix(n − i) Anden del af strukturen er − N∑ i=1 biy(n − i) z-1 + + + + z-1 z-1 y(n) -b1 -b2 -b3 + z-1 -bN -1 -bN x(n) a1 z-1 z-1 z-1 a0 a2 a3 z-1 aN -1 aN + + + + + 20Direkte type 1 Overblik Følgende differensligning ønskes implementeret y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) Første del af strukturen er N∑ i=0 aix(n − i) Anden del af strukturen er − N∑ i=1 biy(n − i) z-1 + + + + z-1 z-1 y(n) -b1 -b2 -b3 + z-1 -bN -1 -bN x(n) + + + + a1 z-1 z-1 z-1 a0 a2 a3 + z-1 aN -1 aN 21Direkte type 1 Eksempel (I) Betragt følgende 4. ordens højpasﬁlter H(z) = Y (z) X(z) = a0 + a1z−1 + a2z−2 + a3z−3 + a4z−4 1 + b1z−1 + b2z−2 + b3z−3 + b4z−4 givet ved overføringsfunktionen H(z) = Y (z) X(z) = 0, 60 − 2, 39z−1 + 3, 60z−2 − 2, 39z−3 + 0, 60z−4 1 − 2, 98z−1 + 3, 43z−2 − 1, 78z−3 + 0, 36z−4 Ved invers z-transformation fås y(n) − 2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) Dermed kan y(n) skrives som y(n) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) − (−2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4)) 21Direkte type 1 Eksempel (I) Betragt følgende 4. ordens højpasﬁlter H(z) = Y (z) X(z) = a0 + a1z−1 + a2z−2 + a3z−3 + a4z−4 1 + b1z−1 + b2z−2 + b3z−3 + b4z−4 givet ved overføringsfunktionen H(z) = Y (z) X(z) = 0, 60 − 2, 39z−1 + 3, 60z−2 − 2, 39z−3 + 0, 60z−4 1 − 2, 98z−1 + 3, 43z−2 − 1, 78z−3 + 0, 36z−4 Ved invers z-transformation fås y(n) − 2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) Dermed kan y(n) skrives som y(n) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) − (−2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4)) 21Direkte type 1 Eksempel (I) Betragt følgende 4. ordens højpasﬁlter H(z) = Y (z) X(z) = a0 + a1z−1 + a2z−2 + a3z−3 + a4z−4 1 + b1z−1 + b2z−2 + b3z−3 + b4z−4 givet ved overføringsfunktionen H(z) = Y (z) X(z) = 0, 60 − 2, 39z−1 + 3, 60z−2 − 2, 39z−3 + 0, 60z−4 1 − 2, 98z−1 + 3, 43z−2 − 1, 78z−3 + 0, 36z−4 Ved invers z-transformation fås y(n) − 2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) Dermed kan y(n) skrives som y(n) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) − (−2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4)) 22Direkte type 1 Eksempel (II) Implementeringen af følgende differensligning er vist i ﬁguren. y(n) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) − (−2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4)) z-1 x(n) + + + + z-1 + + + + z-1 z-1 y(n) a1 z-1 z-1 z-1 z-1 -b1 a0 a2 a3 a4 -b2 -b3 -b4 22Direkte type 1 Eksempel (II) Implementeringen af følgende differensligning er vist i ﬁguren. y(n) = 0, 60x(n) − 2, 39x(n − 1) + 3, 60x(n − 2) − 2, 39x(n − 3) + 0, 60x(n − 4) − (−2, 98y(n − 1) + 3, 43y(n − 2) − 1, 78y(n − 3) + 0, 36y(n − 4)) z-1 x(n) + + + + z-1 + + + + z-1 z-1 y(n) -2,39 z-1 z-1 z-1 z-1 2,98 0,6 3,60 -2,39 0,60 -3,42 1,78 -0,36 23Direkte type 2 Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 24Direkte type 2 Motivation Direkte type 1 strukturen benytter 2N forsinkelseselementer, dvs. 2N værdier skal gennem i ﬁltret. Direkte type 2 strukturen benytter kun N forsinkelseselementer, hvilket kræver mindre hukommelse. Overføringsfunktionen H(z) = Y (z) X(z) = ∑N i=0 aiz−i 1 + ∑N i=1 biz−i kan skrives som H(z) = W (z) X(z) Y (z) W (z) = 1 1 + ∑N i=1 biz−i | {z } H1(z) N∑ i=0 aiz−i | {z } H2(z) 24Direkte type 2 Motivation Direkte type 1 strukturen benytter 2N forsinkelseselementer, dvs. 2N værdier skal gennem i ﬁltret. Direkte type 2 strukturen benytter kun N forsinkelseselementer, hvilket kræver mindre hukommelse. Overføringsfunktionen H(z) = Y (z) X(z) = ∑N i=0 aiz−i 1 + ∑N i=1 biz−i kan skrives som H(z) = W (z) X(z) Y (z) W (z) = 1 1 + ∑N i=1 biz−i | {z } H1(z) N∑ i=0 aiz−i | {z } H2(z) 25Direkte type 2 Motivation Vi betragter H(z) = H1(z)H2(z) hvor H1(z) = W (z) X(z) = 1 1 + ∑N i=1 biz−i H2(z) = Y (z) W (z) = N∑ i=0 aiz−i x(n) + + + + + y(n) a1 z-1 z-1 z-1 z-1 a0 a2 a3 aN -1 aN z-1 + + + + + z-1 z-1 z-1 w(n) -b1 -b2 -b3 -bN -1 w(n) -bN 25Direkte type 2 Motivation Vi betragter H(z) = H1(z)H2(z) hvor H1(z) = W (z) X(z) = 1 1 + ∑N i=1 biz−i H2(z) = Y (z) W (z) = N∑ i=0 aiz−i Da alle forsinkelsesblokke indeholder værdier w(n − i), så kan strukturen omskrives. x(n) + + + + + + + + + + y(n) a1 z-1 z-1 z-1 z-1 -b1 a0 a2 a3 aN -b2 -b3 w(n) -bN -bN -1 aN -1 26Direkte type 2 Eksempel Betragt samme 4. ordens overføringsfunktion som i sidste eksempel H(z) = Y (z) X(z) = a0 + a1z−1 + a2z−2 + a3z−3 + a4z−4 1 + b1z−1 + b2z−2 + b3z−3 + b4z−4 x(n) + + + + + + + + y(n) a1 z-1 z-1 z-1 z-1 -b1 a0 a2 a3 a4 -b2 -b3 w(n) -b4 26Direkte type 2 Eksempel Betragt samme 4. ordens overføringsfunktion som i sidste eksempel H(z) = Y (z) X(z) = 0, 60 − 2, 39z−1 + 3, 60z−2 − 2, 39z−3 + 0, 60z−4 1 − 2, 98z−1 + 3, 43z−2 − 1, 78z−3 + 0, 36z−4 x(n) + + + + + + + + y(n) -2,39 z-1 z-1 z-1 z-1 2,98 0,60 3,60 -2,39 0,60 -3,43 1,78 w(n) -0,36 27Kaskade- og parallelrealisation Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 28Kaskade og parallelrealisation Motivation Når et ﬁlter skal implementeres, så representeres koefﬁcienterne med et endeligt antal bits, hvilket betyder at de afrundes. Derfor er det vigtigt at mindske ﬁltrets koefﬁcientfølsomhed. Følgende giver stor koefﬁcientfølsomhed 1. Systemets poler eller nulpunkter er placeret tæt sammen i z-planet. Dette sker fx hvis amplitudekarakteristikken har stejle ﬂanker. 2. Systemet har poler med lille polargument. Dette sker samplefrekvensen er valgt høj i forhold til systemets afskæringsfrekvens. 3. Systemet er af høj orden. Dette sker hvis systemet implementeres i een direkte type 1 eller type 2 realisationsstruktur. 29Kaskaderealisation Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 30Kaskaderealisation Princip Et højereordens system implementeres ofte som en kaskadekobling givet som følger H(z) = H1(z) · H2(z) · H3(z) · · · · · HM (z) x(n) y(n)H1(z) H2(z) H3(z) HM (z) De M sektioner af systemet er 1. ordens eller 2. ordens overføringsfunktioner på formen Hk(z) = a0k + a1kz−1 1 + b1kz−1 eller Hk(z) = a0k + a1kz−1 + a2kz−2 1 + b1kz−1 + b2kz−2 hvor k = 1, 2, . . . , M angiver sektionsnummeret. 30Kaskaderealisation Princip Et højereordens system implementeres ofte som en kaskadekobling givet som følger H(z) = H1(z) · H2(z) · H3(z) · · · · · HM (z) x(n) y(n)H1(z) H2(z) H3(z) HM (z) De M sektioner af systemet er 1. ordens eller 2. ordens overføringsfunktioner på formen Hk(z) = a0k + a1kz−1 1 + b1kz−1 eller Hk(z) = a0k + a1kz−1 + a2kz−2 1 + b1kz−1 + b2kz−2 hvor k = 1, 2, . . . , M angiver sektionsnummeret. 31Kaskaderealisation Skalering For at undgå aritmetisk overﬂow kan skaleringsfaktorer indføres imellem sektionerne. x(n) y(n)H1(z)A1 H2(z)A2 A3 HM (z)AM AM +1 32Kaskaderealisation Eksempel (I) Betragt følgende 3. ordens højpasﬁlter H(z) = 0, 3947 − 1, 1841z−1 + 1, 1841z−2 − 0, 3947z−3 1 − 1, 289z−1 + 0, 8070z−2 − 0, 06173z−3 Filtret skal implementeres som en kaskade at to direkte type 2 strukturer. Overføringsfunktionen skrives på standard form som H(z) = 0, 3947 z3 − 3z2 + 3z − 1 z3 − 1, 289z2 + 0, 8070z − 0, 06173 Overføringsfunktionen H(z) har tre nulpunkter: z1 = z2 = z3 = 1 og tre poler: p1 = 0, 08802 og p2 = p ∗ 3 = 0, 6005 + j0, 5837. Systemet H(z) skrives som en kaskade af to overføringsfunktioner H1(z) og H2(z). 32Kaskaderealisation Eksempel (I) Betragt følgende 3. ordens højpasﬁlter H(z) = 0, 3947 − 1, 1841z−1 + 1, 1841z−2 − 0, 3947z−3 1 − 1, 289z−1 + 0, 8070z−2 − 0, 06173z−3 Filtret skal implementeres som en kaskade at to direkte type 2 strukturer. Overføringsfunktionen skrives på standard form som H(z) = 0, 3947 z3 − 3z2 + 3z − 1 z3 − 1, 289z2 + 0, 8070z − 0, 06173 Overføringsfunktionen H(z) har tre nulpunkter: z1 = z2 = z3 = 1 og tre poler: p1 = 0, 08802 og p2 = p ∗ 3 = 0, 6005 + j0, 5837. Systemet H(z) skrives som en kaskade af to overføringsfunktioner H1(z) og H2(z). 32Kaskaderealisation Eksempel (I) Betragt følgende 3. ordens højpasﬁlter H(z) = 0, 3947 − 1, 1841z−1 + 1, 1841z−2 − 0, 3947z−3 1 − 1, 289z−1 + 0, 8070z−2 − 0, 06173z−3 Filtret skal implementeres som en kaskade at to direkte type 2 strukturer. Overføringsfunktionen skrives på standard form som H(z) = 0, 3947 z3 − 3z2 + 3z − 1 z3 − 1, 289z2 + 0, 8070z − 0, 06173 Overføringsfunktionen H(z) har tre nulpunkter: z1 = z2 = z3 = 1 og tre poler: p1 = 0, 08802 og p2 = p ∗ 3 = 0, 6005 + j0, 5837. Systemet H(z) skrives som en kaskade af to overføringsfunktioner H1(z) og H2(z). 32Kaskaderealisation Eksempel (I) Betragt følgende 3. ordens højpasﬁlter H(z) = 0, 3947 − 1, 1841z−1 + 1, 1841z−2 − 0, 3947z−3 1 − 1, 289z−1 + 0, 8070z−2 − 0, 06173z−3 Filtret skal implementeres som en kaskade at to direkte type 2 strukturer. Overføringsfunktionen skrives på standard form som H(z) = 0, 3947 z3 − 3z2 + 3z − 1 z3 − 1, 289z2 + 0, 8070z − 0, 06173 Overføringsfunktionen H(z) har tre nulpunkter: z1 = z2 = z3 = 1 og tre poler: p1 = 0, 08802 og p2 = p ∗ 3 = 0, 6005 + j0, 5837. Systemet H(z) skrives som en kaskade af to overføringsfunktioner H1(z) og H2(z). 33Kaskaderealisation Eksempel (II) Overføringsfunktionen kan faktoriseres som H(z) = a0H1(z)H2(z) = a0 z − z1 z − p1 · (z − z2)(z − z3) (z − p2)(z − p3) Ovenstående faktorisering leder til H(z) = 0, 3947 · z − 1 z − 0, 08802 · z2 − 2z + 1 z2 − 1, 201z + 0, 7013 Realisationen af H(z) med en kaskade af to direkte type 2 strukturer er vist herunder. 33Kaskaderealisation Eksempel (II) Overføringsfunktionen kan faktoriseres som H(z) = a0H1(z)H2(z) = a0 z − z1 z − p1 · (z − z2)(z − z3) (z − p2)(z − p3) Ovenstående faktorisering leder til H(z) = 0, 3947 · z − 1 z − 0, 08802 · z2 − 2z + 1 z2 − 1, 201z + 0, 7013 Realisationen af H(z) med en kaskade af to direkte type 2 strukturer er vist herunder. 33Kaskaderealisation Eksempel (II) Overføringsfunktionen kan faktoriseres som H(z) = a0H1(z)H2(z) = a0 z − z1 z − p1 · (z − z2)(z − z3) (z − p2)(z − p3) Ovenstående faktorisering leder til H(z) = 0, 3947 · z − 1 z − 0, 08802 · z2 − 2z + 1 z2 − 1, 201z + 0, 7013 Realisationen af H(z) med en kaskade af to direkte type 2 strukturer er vist herunder. x(n) + + z-1 a01 a11-b11 + + + + y(n) a12 z-1 z-1 -b12 a02 a22-b22 a0 33Kaskaderealisation Eksempel (II) Overføringsfunktionen kan faktoriseres som H(z) = a0H1(z)H2(z) = a0 z − z1 z − p1 · (z − z2)(z − z3) (z − p2)(z − p3) Ovenstående faktorisering leder til H(z) = 0, 3947 · z − 1 z − 0, 08802 · z2 − 2z + 1 z2 − 1, 201z + 0, 7013 Realisationen af H(z) med en kaskade af to direkte type 2 strukturer er vist herunder. x(n) + + z-1 1 -10,088 + + + + y(n) -2 z-1 z-1 1,20 1 1-0,70 0,39 34Parallelrealisation Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 35Parallelrealisation Princip Hvordan kan overføringsfunktionerne H1(z), H2(z), . . . ﬁndes? x(n) y(n) H1(z) H2(z) + C + + H3(z) + HM (z) 36Parallelrealisation Eksempel (I) For at lave en parallelrealisation af ﬁltret H(z) = 0, 3947 − 1, 1841z−1 + 1, 1841z−2 − 0, 3947z−3 1 − 1, 289z−1 + 0, 8070z−2 − 0, 06173z−3 = 0, 3947(z − 1)(z2 − 2z + 1) (z − 0, 08802)(z2 − 1, 201z + 0, 7013) så partialbrøksopløses den til formen H(z) = C + H1(z) + H2(z) I dette eksempel er H1(z) = a01z z + b11 H2(z) = a02z2 + a12z z2 + b12z + b22 36Parallelrealisation Eksempel (I) For at lave en parallelrealisation af ﬁltret H(z) = 0, 3947 − 1, 1841z−1 + 1, 1841z−2 − 0, 3947z−3 1 − 1, 289z−1 + 0, 8070z−2 − 0, 06173z−3 = 0, 3947(z − 1)(z2 − 2z + 1) (z − 0, 08802)(z2 − 1, 201z + 0, 7013) så partialbrøksopløses den til formen H(z) = C + H1(z) + H2(z) I dette eksempel er H1(z) = a01z z + b11 H2(z) = a02z2 + a12z z2 + b12z + b22 37Parallelrealisation Eksempel (II) Partialbrøksopløsningen af H(z)/z har formen H(z) z = C z + a01 z − 0, 08802 + a02z + a12 z2 − 1, 201z + 0, 7013 hvor koefﬁcienterne C og a01 kan udregnes som vist i tidligere lektioner. Koefﬁcienterne bliver C = z H(z) z |z=0 = 6, 394 a01 = (z − 0, 08802) H(z) z |z=0,08802 = −5, 637 Nu haves H(z) z = 6, 394 z − 5, 637 z − 0, 08802 + a02z + a12 z2 − 1, 201z + 0, 7013 37Parallelrealisation Eksempel (II) Partialbrøksopløsningen af H(z)/z har formen H(z) z = C z + a01 z − 0, 08802 + a02z + a12 z2 − 1, 201z + 0, 7013 hvor koefﬁcienterne C og a01 kan udregnes som vist i tidligere lektioner. Koefﬁcienterne bliver C = z H(z) z |z=0 = 6, 394 a01 = (z − 0, 08802) H(z) z |z=0,08802 = −5, 637 Nu haves H(z) z = 6, 394 z − 5, 637 z − 0, 08802 + a02z + a12 z2 − 1, 201z + 0, 7013 37Parallelrealisation Eksempel (II) Partialbrøksopløsningen af H(z)/z har formen H(z) z = C z + a01 z − 0, 08802 + a02z + a12 z2 − 1, 201z + 0, 7013 hvor koefﬁcienterne C og a01 kan udregnes som vist i tidligere lektioner. Koefﬁcienterne bliver C = z H(z) z |z=0 = 6, 394 a01 = (z − 0, 08802) H(z) z |z=0,08802 = −5, 637 Nu haves H(z) z = 6, 394 z − 5, 637 z − 0, 08802 + a02z + a12 z2 − 1, 201z + 0, 7013 38Parallelrealisation Eksempel (III) For at ﬁnde koefﬁcienterne a02 og a12, indsættes to værdier for z i ligningen. Her benyttes z = 1 of z = −1. Dette medfører at a02 + a12 = −0, 1066 For z = −1 haves H(z) z |z=−1 = 6, 394 z |z=−1 − 5, 637 z − 0, 08802 |z=−1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=−1 −1 = −6, 394 − 5, 637 −1 − 0, 08802 + −a02 + a12 1 + 1, 201 + 0, 7013 Dette medfører at −a02 + a12 = 0, 6181 Dermed ﬁndes koefﬁcienterne fra [ 1 1 −1 1 ] [ a02 a12 ] = [ −0, 1066 0, 6181 ] ⇒ [ a02 a12 ] = [ −0, 3624 0, 2558 ] 38Parallelrealisation Eksempel (III) For at ﬁnde koefﬁcienterne a02 og a12, indsættes to værdier for z i ligningen. Her benyttes z = 1 of z = −1. For z = 1 haves H(z) z |z=1 = 6, 394 z |z=1 − 5, 637 z − 0, 08802 |z=1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=1 0 = 6, 394 − 5, 637 1 − 0, 08802 + a02 + a12 1 − 1, 201 + 0, 7013 Dette medfører at a02 + a12 = −0, 1066 For z = −1 haves H(z) z |z=−1 = 6, 394 z |z=−1 − 5, 637 z − 0, 08802 |z=−1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=−1 −1 = −6, 394 − 5, 637 −1 − 0, 08802 + −a02 + a12 1 + 1, 201 + 0, 7013 Dette medfører at −a02 + a12 = 0, 6181 Dermed ﬁndes koefﬁcienterne fra [ 1 1 −1 1 ] [ a02 a12 ] = [ −0, 1066 0, 6181 ] ⇒ [ a02 a12 ] = [ −0, 3624 0, 2558 ] 38Parallelrealisation Eksempel (III) For at ﬁnde koefﬁcienterne a02 og a12, indsættes to værdier for z i ligningen. Her benyttes z = 1 of z = −1. For z = 1 haves H(z) z |z=1 = 6, 394 z |z=1 − 5, 637 z − 0, 08802 |z=1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=1 0 = 6, 394 − 5, 637 1 − 0, 08802 + a02 + a12 1 − 1, 201 + 0, 7013 Dette medfører at a02 + a12 = −0, 1066 For z = −1 haves H(z) z |z=−1 = 6, 394 z |z=−1 − 5, 637 z − 0, 08802 |z=−1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=−1 −1 = −6, 394 − 5, 637 −1 − 0, 08802 + −a02 + a12 1 + 1, 201 + 0, 7013 Dette medfører at −a02 + a12 = 0, 6181 Dermed ﬁndes koefﬁcienterne fra [ 1 1 −1 1 ] [ a02 a12 ] = [ −0, 1066 0, 6181 ] ⇒ [ a02 a12 ] = [ −0, 3624 0, 2558 ] 38Parallelrealisation Eksempel (III) Dette medfører at a02 + a12 = −0, 1066 For z = −1 haves H(z) z |z=−1 = 6, 394 z |z=−1 − 5, 637 z − 0, 08802 |z=−1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=−1 −1 = −6, 394 − 5, 637 −1 − 0, 08802 + −a02 + a12 1 + 1, 201 + 0, 7013 Dette medfører at −a02 + a12 = 0, 6181 Dermed ﬁndes koefﬁcienterne fra [ 1 1 −1 1 ] [ a02 a12 ] = [ −0, 1066 0, 6181 ] ⇒ [ a02 a12 ] = [ −0, 3624 0, 2558 ] 38Parallelrealisation Eksempel (III) Dette medfører at a02 + a12 = −0, 1066 For z = −1 haves H(z) z |z=−1 = 6, 394 z |z=−1 − 5, 637 z − 0, 08802 |z=−1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=−1 −1 = −6, 394 − 5, 637 −1 − 0, 08802 + −a02 + a12 1 + 1, 201 + 0, 7013 Dette medfører at −a02 + a12 = 0, 6181 Dermed ﬁndes koefﬁcienterne fra [ 1 1 −1 1 ] [ a02 a12 ] = [ −0, 1066 0, 6181 ] ⇒ [ a02 a12 ] = [ −0, 3624 0, 2558 ] 38Parallelrealisation Eksempel (III) Dette medfører at a02 + a12 = −0, 1066 For z = −1 haves H(z) z |z=−1 = 6, 394 z |z=−1 − 5, 637 z − 0, 08802 |z=−1 + a02z + a12 z2 − 1, 201z + 0, 7013 |z=−1 −1 = −6, 394 − 5, 637 −1 − 0, 08802 + −a02 + a12 1 + 1, 201 + 0, 7013 Dette medfører at −a02 + a12 = 0, 6181 Dermed ﬁndes koefﬁcienterne fra [ 1 1 −1 1 ] [ a02 a12 ] = [ −0, 1066 0, 6181 ] ⇒ [ a02 a12 ] = [ −0, 3624 0, 2558 ] 39Parallelrealisation Eksempel (IV) Realisationsstrukturen for ﬁltret H(z) = 6, 394 − 5, 637z z − 0, 08802 + −0, 3624z2 + 0, 2558z z2 − 1, 201z + 0, 7013 bliver dermed følgende. x(n) + + z-1 a01 -b11 + + + + y(n) a12 z-1 z-1 -b12 a02 a22-b22 +C 40Opsummering Introduktion Tidsdiskret systemteori Tidsdiskret foldning Overblik over z-domæneanalyse Direkte realisationsstrukturer Direkte type 1 Direkte type 2 Kaskade- og parallelrealisation Kaskaderealisation Parallelrealisation Opsummering 41Opsummering Direkte type 1 Følgende viser en direkte type 1 realisationsstruktur for differensligningen y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) z-1 + + + + z-1 z-1 y(n) -b1 -b2 -b3 + z-1 -bN -1 -bN x(n) + + + + a1 z-1 z-1 z-1 a0 a2 a3 + z-1 aN -1 aN 42Opsummering Direkte type 2 Følgende viser en direkte type 2 realisationsstruktur for differensligningen y(n) = N∑ i=0 aix(n − i) − N∑ i=1 biy(n − i) x(n) + + + + + + + + + + y(n) a1 z-1 z-1 z-1 z-1 -b1 a0 a2 a3 aN -b2 -b3 w(n) -bN -bN -1 aN -1 43Opsummering Kaskaderealisation Et højereordens system kan implementeres som en kaskadekobling af M sektioner givet som følger H(z) = H1(z) · H2(z) · H3(z) · · · · · HM (z) hvor hver sektion er en 1. ordens eller 2. ordens overføringsfunktion. x(n) y(n)H1(z) H2(z) H3(z) HM (z) 44Opsummering Parallelrealisation Et højereordens system kan implementeres som en parallelrealisation af M overføringsfunktioner, der er en 1. ordens eller 2. ordens overføringsfunktion. Disse hverføringsfunktioner ﬁndes ved partialbrøksopløsning af H(z). x(n) y(n) H1(z) H2(z) + C + + H3(z) + HM (z)","libVersion":"0.2.4","langs":""}