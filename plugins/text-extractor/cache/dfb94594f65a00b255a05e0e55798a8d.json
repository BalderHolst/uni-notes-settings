{"path":"Lessons/Semester 3/signalbehandling/Slides/Lektion 6 - Systemanalyse i z-domæne.pdf","text":"Lektion 6: Systemanalyse i z-domæne Signalbehandling Christoffer Sloth chsl@mmmi.sdu.dk SDU Robotics The Maersk Mc-Kinney Moller Institute University of Southern Denmark 1Agenda Introduktion Impulsrespons Stabilitet Frekvensresponsanalyse Graﬁsk bestemmelse af frekvensrespons Opsummering 2Introduktion Pensum for Signalbehandling Datakonvertering og digital signalbehandling herunder: 1 ▶ ideel og praktisk sampling og rekonstruktion ▶ aliasing ▶ kvantisering og dynamikområde ▶ konverteringsprincipper (A/D og D/A) ▶ implementationsprincipper (Sample & Hold, A/D, D/A) ▶ multirate sampling ▶ diskret-tid signaler og systemer i tids- og frekvensdomænet ▶ Z-transformationen ▶ overføringsfunktion for lineære tidsinvariante systemer ▶ systemanalyse ▶ frekvensanalyse ▶ lineær fase systemer ▶ realisationsstrukturer for diskret-tid systemer ▶ hovedanvendelse af digital signalbehandling herunder digitale IIR-ﬁltre og transformation af analoge ﬁltre samt digitale FIR-ﬁltre og vindues-funktioner 1 Baseret på https://odin.sdu.dk/sitecore/index.php?a=fagbesk&id=65003&listid=9093&lang=da 3Introduktion Lektionsplan ▶ Lektion 1: Filterfunktioner ▶ Lektion 2: Sampling og rekonstruktion ▶ Lektion 3: Fast Fourier transformation (I) ▶ Lektion 4: Fast Fourier transformation (II) ▶ Lektion 5: Introduktion til z-transformation ▶ Lektion 6: Systemanalyse i z-domæne ▶ Lektion 7: Digitale realisationsstrukturer ▶ Lektion 8: Introduktion til IIR-ﬁltre ▶ Lektion 9: Design af IIR-ﬁltre ▶ Lektion 10: Introduktion til FIR-ﬁltre ▶ Lektion 11: Design af FIR-ﬁltre ▶ Lektion 12: Anvendelse af digital signalbehandling 4Impulsrespons Introduktion Impulsrespons Stabilitet Frekvensresponsanalyse Graﬁsk bestemmelse af frekvensrespons Opsummering 5Impulsrespons Deﬁnition Impulsresponset for et tidsdiskret system kaldes h(n), og er identisk med systemets udgangssekvens når inputsekvensen er en enhedssample δ(n) (Kronecker delta funktion). Princippet er illustreret i følgende ﬁgur. Tidsdiskret system H(z) Z Z -1x(n) X(z) Y (z) = H(z) · X(z) y(n) 5Impulsrespons Deﬁnition Impulsresponset for et tidsdiskret system kaldes h(n), og er identisk med systemets udgangssekvens når inputsekvensen er en enhedssample δ(n) (Kronecker delta funktion). Princippet er illustreret i følgende ﬁgur. Tidsdiskret system H(z) Z Z -1X(z) = 1 Y (z) = H(z) · 1x(n) = δ(n) y(n) = h(n) δ(n) n 6Impulsrespons Beregning Udgangsresponset i z-domæne er givet ved (da Z(δ(n)) = 1) Y (z) = H(z)X(z) = H(z) Impulsresponssekvensen kan udregnes ved invers z-transformation af H(z), dvs. h(n) = Z −1(H(z)) Konklusion: Et systems impulsresponssekvens h(n) ﬁndes ved invers z-transformation af systemets overføringsfunktion H(z). 6Impulsrespons Beregning Udgangsresponset i z-domæne er givet ved (da Z(δ(n)) = 1) Y (z) = H(z)X(z) = H(z) Impulsresponssekvensen kan udregnes ved invers z-transformation af H(z), dvs. h(n) = Z −1(H(z)) Konklusion: Et systems impulsresponssekvens h(n) ﬁndes ved invers z-transformation af systemets overføringsfunktion H(z). 6Impulsrespons Beregning Udgangsresponset i z-domæne er givet ved (da Z(δ(n)) = 1) Y (z) = H(z)X(z) = H(z) Impulsresponssekvensen kan udregnes ved invers z-transformation af H(z), dvs. h(n) = Z −1(H(z)) Konklusion: Et systems impulsresponssekvens h(n) ﬁndes ved invers z-transformation af systemets overføringsfunktion H(z). 7Impulsrespons Eksempel (I) Betragt overføringsfunktionen H(z) = 1 + 0, 4z−1 1 − 0, 7z−1 + 0, 1z−2 Bestem systems impulsresponssekvens h(n). Proceduren fra Lektion 5 anvendes, hvorfor H(z) skrives med positive potenser H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 og det ses at de to nulpunkter er z1 = 0 og z2 = −0, 4 og de to poler er p1 = 0, 5 og p2 = 0, 2. Dermed kan overføringsfunktionen faktoriseres som H(z) = z(z + 0, 4) (z − 0, 5)(z − 0, 2) 7Impulsrespons Eksempel (I) Betragt overføringsfunktionen H(z) = 1 + 0, 4z−1 1 − 0, 7z−1 + 0, 1z−2 Bestem systems impulsresponssekvens h(n). Proceduren fra Lektion 5 anvendes, hvorfor H(z) skrives med positive potenser H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 og det ses at de to nulpunkter er z1 = 0 og z2 = −0, 4 og de to poler er p1 = 0, 5 og p2 = 0, 2. Dermed kan overføringsfunktionen faktoriseres som H(z) = z(z + 0, 4) (z − 0, 5)(z − 0, 2) 7Impulsrespons Eksempel (I) Betragt overføringsfunktionen H(z) = 1 + 0, 4z−1 1 − 0, 7z−1 + 0, 1z−2 Bestem systems impulsresponssekvens h(n). Proceduren fra Lektion 5 anvendes, hvorfor H(z) skrives med positive potenser H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 og det ses at de to nulpunkter er z1 = 0 og z2 = −0, 4 og de to poler er p1 = 0, 5 og p2 = 0, 2. Dermed kan overføringsfunktionen faktoriseres som H(z) = z(z + 0, 4) (z − 0, 5)(z − 0, 2) 7Impulsrespons Eksempel (I) Betragt overføringsfunktionen H(z) = 1 + 0, 4z−1 1 − 0, 7z−1 + 0, 1z−2 Bestem systems impulsresponssekvens h(n). Proceduren fra Lektion 5 anvendes, hvorfor H(z) skrives med positive potenser H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 og det ses at de to nulpunkter er z1 = 0 og z2 = −0, 4 og de to poler er p1 = 0, 5 og p2 = 0, 2. Dermed kan overføringsfunktionen faktoriseres som H(z) = z(z + 0, 4) (z − 0, 5)(z − 0, 2) 8Impulsrespons Eksempel (II) Ved partialbrøkopløsning fås H(z) z = k1 z − p1 + k2 z − p2 hvor k1 = (z − p1) H(z) z |z=p1 = z + 0, 4 z − 0, 2 |z=0,5 = 3 k2 = (z − p2) H(z) z |z=p2 = z + 0, 4 z − 0, 5 |z=0,2 = −2 Dermed bliver overføringsfunktionen H(z) = 3 z z − 0, 5 − 2 z z − 0, 2 Ved tabelopslag fås h(n) = Z −1[H(z)] = 3 · 0, 5n − 2 · 0, 2 n = 3e−0,693n − 2e−1,61n 8Impulsrespons Eksempel (II) Ved partialbrøkopløsning fås H(z) z = k1 z − p1 + k2 z − p2 hvor k1 = (z − p1) H(z) z |z=p1 = z + 0, 4 z − 0, 2 |z=0,5 = 3 k2 = (z − p2) H(z) z |z=p2 = z + 0, 4 z − 0, 5 |z=0,2 = −2 Dermed bliver overføringsfunktionen H(z) = 3 z z − 0, 5 − 2 z z − 0, 2 Ved tabelopslag fås h(n) = Z −1[H(z)] = 3 · 0, 5n − 2 · 0, 2 n = 3e−0,693n − 2e−1,61n 8Impulsrespons Eksempel (II) Ved partialbrøkopløsning fås H(z) z = k1 z − p1 + k2 z − p2 hvor k1 = (z − p1) H(z) z |z=p1 = z + 0, 4 z − 0, 2 |z=0,5 = 3 k2 = (z − p2) H(z) z |z=p2 = z + 0, 4 z − 0, 5 |z=0,2 = −2 Dermed bliver overføringsfunktionen H(z) = 3 z z − 0, 5 − 2 z z − 0, 2 Ved tabelopslag fås h(n) = Z −1[H(z)] = 3 · 0, 5n − 2 · 0, 2 n = 3e−0,693n − 2e−1,61n 9Impulsrespons Eksempel (III) 0 5 10 15 0 0.5 1 10Impulsrespons System med simple poler (1) En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) hvor zi for i = 1, . . . , N er overføringsfunktionens nulpunkter og pi for i = 1, . . . , N er overføringsfunktionens poler. Ved brug af partialbrøkopsplitning kan overføringsfunktionen skrives H(z) z = k1 z − p1 + k2 z − p2 + · · · + kN z − pN hvor k1, k2, . . . , kN er koefﬁcienter. Dermed haves H(z) = k1 z z − p1 + k2 z z − p2 + · · · + kN z z − pN Dermed kan impulsresponssekvensen skrives som h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 [ z z − pi ] 10Impulsrespons System med simple poler (1) En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) Antag at alle poler er simple (alle poler har multiplicitet 1). Ved brug af partialbrøkopsplitning kan overføringsfunktionen skrives H(z) z = k1 z − p1 + k2 z − p2 + · · · + kN z − pN hvor k1, k2, . . . , kN er koefﬁcienter. Dermed haves H(z) = k1 z z − p1 + k2 z z − p2 + · · · + kN z z − pN Dermed kan impulsresponssekvensen skrives som h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 [ z z − pi ] 10Impulsrespons System med simple poler (1) En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) Ved brug af partialbrøkopsplitning kan overføringsfunktionen skrives H(z) z = k1 z − p1 + k2 z − p2 + · · · + kN z − pN hvor k1, k2, . . . , kN er koefﬁcienter. Dermed haves H(z) = k1 z z − p1 + k2 z z − p2 + · · · + kN z z − pN Dermed kan impulsresponssekvensen skrives som h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 [ z z − pi ] 10Impulsrespons System med simple poler (1) En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) Ved brug af partialbrøkopsplitning kan overføringsfunktionen skrives H(z) z = k1 z − p1 + k2 z − p2 + · · · + kN z − pN hvor k1, k2, . . . , kN er koefﬁcienter. Dermed haves H(z) = k1 z z − p1 + k2 z z − p2 + · · · + kN z z − pN Dermed kan impulsresponssekvensen skrives som h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 [ z z − pi ] 10Impulsrespons System med simple poler (1) En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) Ved brug af partialbrøkopsplitning kan overføringsfunktionen skrives H(z) z = k1 z − p1 + k2 z − p2 + · · · + kN z − pN hvor k1, k2, . . . , kN er koefﬁcienter. Dermed haves H(z) = k1 z z − p1 + k2 z z − p2 + · · · + kN z z − pN Dermed kan impulsresponssekvensen skrives som h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 [ z z − pi ] 11Impulsrespons System med simple poler (2) For at bestemme impulsresponssekvensen h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 { z z − pi } betragtes overføringsfunktionen Hi(z) = z/(z − pi) hvor polen er givet ved (vi antager at ki = 1) z = pi = esiT = eσiT e jωiT Impulsresponset ﬁndes via invers z-transformation hi(n) = Z −1[Hi(z)] = Z −1 { z z − pi } = esinT = eσinT ejωinT 11Impulsrespons System med simple poler (2) For at bestemme impulsresponssekvensen h(n) = h1(n) + h2(n) + · · · + hN (n) hvor hi(n) = kiZ −1 { z z − pi } betragtes overføringsfunktionen Hi(z) = z/(z − pi) hvor polen er givet ved (vi antager at ki = 1) z = pi = esiT = eσiT e jωiT Impulsresponset ﬁndes via invers z-transformation hi(n) = Z −1[Hi(z)] = Z −1 { z z − pi } = esinT = eσinT ejωinT 12Impulsrespons System med simple poler (3) Impulsresponssekvensen for et system med overføringsfunktion H(z) der har poler p1, p2, . . . , pN ∈ C kan skrives h(n) = h1(n) + h2(n) + · · · + hN (n) med hi(n) = eσinT ejωinT hvor polen er pi = eσiT ejωiT . Når σi < 0 så gælder det at lim n→∞ |hi(n)| = 0 På tilsvarende vis ses det at ændringen af fasen for hi(n) er ωiT per sample. 12Impulsrespons System med simple poler (3) Impulsresponssekvensen for et system med overføringsfunktion H(z) der har poler p1, p2, . . . , pN ∈ C kan skrives h(n) = h1(n) + h2(n) + · · · + hN (n) med hi(n) = eσinT ejωinT hvor polen er pi = eσiT ejωiT . Når σi < 0 så gælder det at lim n→∞ |hi(n)| = 0 På tilsvarende vis ses det at ændringen af fasen for hi(n) er ωiT per sample. 12Impulsrespons System med simple poler (3) Impulsresponssekvensen for et system med overføringsfunktion H(z) der har poler p1, p2, . . . , pN ∈ C kan skrives h(n) = h1(n) + h2(n) + · · · + hN (n) med hi(n) = eσinT ejωinT hvor polen er pi = eσiT ejωiT . Når σi < 0 så gælder det at lim n→∞ |hi(n)| = 0 På tilsvarende vis ses det at ændringen af fasen for hi(n) er ωiT per sample. 13Impulsrespons Relation imellem polplacering og impulsrespons Vi betragter følgende impulsrespons hi(n) = eσinT ejωinT = e σinT ∠ωinT givet af polen pi = eσiT ejωiT som på polær form er pi = eσiT ∠ωiT . Fra impulsresponssekvensen hi(n) ses det at ▶ Modulo af hi(n) ændres med en faktor eσiT mellem to på hinanden følgende samples. ▶ Argumentet af hi(n) ændres med ωiT mellem to på hinanden følgende samples. 13Impulsrespons Relation imellem polplacering og impulsrespons Vi betragter følgende impulsrespons hi(n) = eσinT ejωinT = e σinT ∠ωinT givet af polen pi = eσiT ejωiT som på polær form er pi = eσiT ∠ωiT . Re(z) Im(z) Enhedscirkel pi p∗ i Fra impulsresponssekvensen hi(n) ses det at ▶ Modulo af hi(n) ændres med en faktor eσiT mellem to på hinanden følgende samples. ▶ Argumentet af hi(n) ændres med ωiT mellem to på hinanden følgende samples. 13Impulsrespons Relation imellem polplacering og impulsrespons Vi betragter følgende impulsrespons hi(n) = eσinT ejωinT = e σinT ∠ωinT givet af polen pi = eσiT ejωiT som på polær form er pi = eσiT ∠ωiT . Re(z) Im(z) Enhedscirkel pi p∗ i Modulo: eσiT Fra impulsresponssekvensen hi(n) ses det at ▶ Modulo af hi(n) ændres med en faktor eσiT mellem to på hinanden følgende samples. ▶ Argumentet af hi(n) ændres med ωiT mellem to på hinanden følgende samples. 13Impulsrespons Relation imellem polplacering og impulsrespons Vi betragter følgende impulsrespons hi(n) = eσinT ejωinT = e σinT ∠ωinT givet af polen pi = eσiT ejωiT som på polær form er pi = eσiT ∠ωiT . Re(z) Im(z) Enhedscirkel pi p∗ i Argument: ωiT ωi 2π Modulo: eσiT Fra impulsresponssekvensen hi(n) ses det at ▶ Modulo af hi(n) ændres med en faktor eσiT mellem to på hinanden følgende samples. ▶ Argumentet af hi(n) ændres med ωiT mellem to på hinanden følgende samples. 13Impulsrespons Relation imellem polplacering og impulsrespons Vi betragter følgende impulsrespons hi(n) = eσinT ejωinT = e σinT ∠ωinT givet af polen pi = eσiT ejωiT som på polær form er pi = eσiT ∠ωiT . Re(z) Im(z) Enhedscirkel pi p∗ i Argument: ωiT ωi 2π Modulo: eσiT Fra impulsresponssekvensen hi(n) ses det at ▶ Modulo af hi(n) ændres med en faktor eσiT mellem to på hinanden følgende samples. ▶ Argumentet af hi(n) ændres med ωiT mellem to på hinanden følgende samples. 14Impulsrespons Relation til pol placering (Simple poler) På baggrund af impulsresponset hi(n) = eσinT ejωinT = e σinT ∠ωinT givet af polen pi = eσiT ejωiT kan følgende diagram opstilles. Im(z) j1 -j1 Re(z)-1 1 15Impulsrespons Impulsrespons for 2. ordens system (I) Vi betragter et 2. ordens system givet ved følgende overføringsfunktion H(z) = z z2 + 1, 697z + 1, 44 Overføringsfunktionen H(z) har et nulpunkt i z = 0 og to poler p1 = 1, 2 · ej3π/4 og p2 = 1, 2 · e−j3π/4. Impulsresponset for systemet udregnes via partialbrøkopsplitning H(z) z = k1 z − p1 + k2 z − p2 hvor (og k2 = k∗ 1) k1 = (z − p1) H(z) z |z=p1 = 1 p1 − p2 = 1 1, 2(ej3π/4 − e−j3π/4) = 1 1, 2 · 2 · sin(3π/4)j = 1 2, 4 · sin(3π/4) e−jπ/2 15Impulsrespons Impulsrespons for 2. ordens system (I) Vi betragter et 2. ordens system givet ved følgende overføringsfunktion H(z) = z z2 + 1, 697z + 1, 44 Overføringsfunktionen H(z) har et nulpunkt i z = 0 og to poler p1 = 1, 2 · ej3π/4 og p2 = 1, 2 · e−j3π/4. Impulsresponset for systemet udregnes via partialbrøkopsplitning H(z) z = k1 z − p1 + k2 z − p2 hvor (og k2 = k∗ 1) k1 = (z − p1) H(z) z |z=p1 = 1 p1 − p2 = 1 1, 2(ej3π/4 − e−j3π/4) = 1 1, 2 · 2 · sin(3π/4)j = 1 2, 4 · sin(3π/4) e−jπ/2 15Impulsrespons Impulsrespons for 2. ordens system (I) Vi betragter et 2. ordens system givet ved følgende overføringsfunktion H(z) = z z2 + 1, 697z + 1, 44 Overføringsfunktionen H(z) har et nulpunkt i z = 0 og to poler p1 = 1, 2 · ej3π/4 og p2 = 1, 2 · e−j3π/4. Impulsresponset for systemet udregnes via partialbrøkopsplitning H(z) z = k1 z − p1 + k2 z − p2 hvor (og k2 = k∗ 1) k1 = (z − p1) H(z) z |z=p1 = 1 p1 − p2 = 1 1, 2(ej3π/4 − e−j3π/4) = 1 1, 2 · 2 · sin(3π/4)j = 1 2, 4 · sin(3π/4) e−jπ/2 16Impulsrespons Impulsrespons for 2. ordens system (II) Impulsresponset kan nu udregnes via invers z-transformation af H(z) = 1 2, 4 · sin(3π/4) (e −jπ/2 z z − 1, 2 · ej3π/4 + ejπ/2 z z − 1, 2 · e−j3π/4 ) Ved brug af regel ZT4 fås h(n) = 1 2, 4 · sin(3π/4) (e−jπ/21, 2 n · e jn3π/4 + ejπ/21, 2 n · e −jn3π/4) = 1 2, 4 · sin(3π/4) · 1, 2n (ej(n3π/4−π/2) + e−j(n3π/4−π/2)) = 1 1, 2 · sin(3π/4) · 1, 2n cos( 3π 4 n − π 2 ) = 1 1, 2 · sin(3π/4) · e0,1823n sin( 3π 4 n) 16Impulsrespons Impulsrespons for 2. ordens system (II) Impulsresponset kan nu udregnes via invers z-transformation af H(z) = 1 2, 4 · sin(3π/4) (e −jπ/2 z z − 1, 2 · ej3π/4 + ejπ/2 z z − 1, 2 · e−j3π/4 ) Ved brug af regel ZT4 fås h(n) = 1 2, 4 · sin(3π/4) (e−jπ/21, 2 n · e jn3π/4 + ejπ/21, 2 n · e −jn3π/4) = 1 2, 4 · sin(3π/4) · 1, 2n (ej(n3π/4−π/2) + e−j(n3π/4−π/2)) = 1 1, 2 · sin(3π/4) · 1, 2n cos( 3π 4 n − π 2 ) = 1 1, 2 · sin(3π/4) · e0,1823n sin( 3π 4 n) 17Impulsrespons Impulsrespons for 2. ordens system (III) 0 5 10 15 -20 -10 0 10 20 18Stabilitet Introduktion Impulsrespons Stabilitet Frekvensresponsanalyse Graﬁsk bestemmelse af frekvensrespons Opsummering 19Stabilitet Deﬁnition Et systems stabilitetstilstand kan være en af følgende ▶ Stabilt system: Et system er stabilt hvis dets impulsrespons h(n) går mod nul når n går med uendelig |h(n)| → 0 for n → ∞ ▶ Marginalt stabilt system: Et system er marginalt stabilt hvis dets impulsrespons h(n) går mod konstant værdi forskellig fra nul eller oscillerer med konstant amplitude og frekvens når n går mod uendelig. ▶ Ustabilt system: Et system er ustabilt hvis dets impulsrespons h(n) vokser ubegrænset når n går med uendelig |h(n)| → ∞ for n → ∞ 20Stabilitet Bestemmelse af stabilitet Hvordan kan vi let bestemme om et tidsdiskret system er stabilt? Lad H(z) være overføringsfunktionen for et tidsdiskret system med poler p1, p2, . . . , pN ∈ C. Så gælder det at ▶ Systemet er stabilt hvis alle poler ligger indenfor enhedscirklen, dvs. |pi| < 1 for i = 1, 2, . . . , N ▶ Systemet er marginalt stabilt hvis mindst en pol (fx pj) ligger på enhedscirklen, mens de øvrige poler ligger indenfor enhedscirklen, dvs. |pi| ≤ 1 for i = 1, 2, . . . , N og |pj| = 1 for j ∈ {1, 2, . . . , N } ▶ Systemet er ustabilt hvis en pol (fx pj) ligger udenfor enhedscirklen, dvs. |pj| > 1 for j ∈ {1, 2, . . . , N } 20Stabilitet Bestemmelse af stabilitet Lad H(z) være overføringsfunktionen for et tidsdiskret system med poler p1, p2, . . . , pN ∈ C. Så gælder det at ▶ Systemet er stabilt hvis alle poler ligger indenfor enhedscirklen, dvs. |pi| < 1 for i = 1, 2, . . . , N ▶ Systemet er marginalt stabilt hvis mindst en pol (fx pj) ligger på enhedscirklen, mens de øvrige poler ligger indenfor enhedscirklen, dvs. |pi| ≤ 1 for i = 1, 2, . . . , N og |pj| = 1 for j ∈ {1, 2, . . . , N } ▶ Systemet er ustabilt hvis en pol (fx pj) ligger udenfor enhedscirklen, dvs. |pj| > 1 for j ∈ {1, 2, . . . , N } 21Stabilitet Relation til z-plan Im(z) j1 -j1 Re(z)-1 1 22Frekvensresponsanalyse Introduktion Impulsrespons Stabilitet Frekvensresponsanalyse Graﬁsk bestemmelse af frekvensrespons Opsummering 23Frekvensresponsanalyse Introduktion x(n) y(n) x(n) n y(n) n H(z) En frekvensresponsanalyse giver et systems respons ved en sinusformet indgangssekvens. Her antages det at den sinusformede sekvens har været påtrykt fra tid −∞ (analysen ser bort fra transient respons). 23Frekvensresponsanalyse Introduktion x(n) y(n) x(n) n y(n) n H(ejω) En frekvensresponsanalyse giver et systems respons ved en sinusformet indgangssekvens. Her antages det at den sinusformede sekvens har været påtrykt fra tid −∞ (analysen ser bort fra transient respons). 24Frekvensresponsanalyse Spørgsmål Når et tidsdiskret system påtrykkes en sinusformet indgangssekvens, hvad kan så siges om udgangssekvensen? 25Frekvensresponsanalyse Deﬁnition (tidskontinuert) Et systems frekvensrespons er responset (udgangssignalet) når et sinudialt input påtrykkes et system. 25Frekvensresponsanalyse Deﬁnition (tidskontinuert) Et systems frekvensrespons er responset (udgangssignalet) når et sinudialt input påtrykkes et system. Udgangssignalet for et system med indgangssignal est kan bestemmes ved brug af overføringsfunktionen H(s) som y(t) = H(s)est 25Frekvensresponsanalyse Deﬁnition (tidskontinuert) Et systems frekvensrespons er responset (udgangssignalet) når et sinudialt input påtrykkes et system. Udgangssignalet for et system med indgangssignal est kan bestemmes ved brug af overføringsfunktionen H(s) som y(t) = H(s)est Da A cos(ωt) = A 2 (ejωt + e−jωt) kan responset skrives (grundet superposition) y(t) = A 2 (H(jω)ejωt + H(−jω)e−jωt) 25Frekvensresponsanalyse Deﬁnition (tidskontinuert) Da A cos(ωt) = A 2 (ejωt + e−jωt) kan responset skrives (grundet superposition) y(t) = A 2 (H(jω)ejωt + H(−jω)e−jωt) På polær form er H(jω) = M (ω)ejϕ(ω), så y(t) = A 2 M (ω) (ej(ωt+ϕ(ω)) + e −(jωt+ϕ(ω))) = AM (ω) cos(ωt + ϕ(ω)) hvor M (ω) = |H(jω)| og ϕ(ω) = ∠H(jω) 26Frekvensresponsanalyse Bode plot (tidskontinuert) Et Bode plot benyttes til at visualisere frekvensresponset, og tegnes normalt i logaritmisk skala. 10 -2 10 -1 10 0 10 1 10 210 -2 10 -1 10 0 10 -2 10 -1 10 0 10 1 10 2-90 -45 0 27Frekvensresponsanalyse Udregning af frekvensrespons For at studere et systems respons til sinusformede signaler kan der kigges udelukkende på værdier for z, der ligger på enhedscirklen, dvs. z = ejωT Frekvensresponset for et tidsdiskret system H(z) er dermed givet som H(e jωT ) = Y (ejωT ) X(ejωT ) = H(z)|z=ejωT For at forkorte notationen skrives H(jω) = H(z)|z=ejωT På polær form er frekvensresponset H(jω) = |H(ω)|∠ϕ(ω) Amplituden er oftest givet i dB, dvs. |H(ω)| = 20 log |Y (jω)| |X(jω)| [dB] 27Frekvensresponsanalyse Udregning af frekvensrespons For at studere et systems respons til sinusformede signaler kan der kigges udelukkende på værdier for z, der ligger på enhedscirklen, dvs. z = ejωT Frekvensresponset for et tidsdiskret system H(z) er dermed givet som H(e jωT ) = Y (ejωT ) X(ejωT ) = H(z)|z=ejωT For at forkorte notationen skrives H(jω) = H(z)|z=ejωT På polær form er frekvensresponset H(jω) = |H(ω)|∠ϕ(ω) Amplituden er oftest givet i dB, dvs. |H(ω)| = 20 log |Y (jω)| |X(jω)| [dB] 27Frekvensresponsanalyse Udregning af frekvensrespons For at studere et systems respons til sinusformede signaler kan der kigges udelukkende på værdier for z, der ligger på enhedscirklen, dvs. z = ejωT Frekvensresponset for et tidsdiskret system H(z) er dermed givet som H(e jωT ) = Y (ejωT ) X(ejωT ) = H(z)|z=ejωT For at forkorte notationen skrives H(jω) = H(z)|z=ejωT På polær form er frekvensresponset H(jω) = |H(ω)|∠ϕ(ω) Amplituden er oftest givet i dB, dvs. |H(ω)| = 20 log |Y (jω)| |X(jω)| [dB] 27Frekvensresponsanalyse Udregning af frekvensrespons For at studere et systems respons til sinusformede signaler kan der kigges udelukkende på værdier for z, der ligger på enhedscirklen, dvs. z = ejωT Frekvensresponset for et tidsdiskret system H(z) er dermed givet som H(e jωT ) = Y (ejωT ) X(ejωT ) = H(z)|z=ejωT For at forkorte notationen skrives H(jω) = H(z)|z=ejωT På polær form er frekvensresponset H(jω) = |H(ω)|∠ϕ(ω) Amplituden er oftest givet i dB, dvs. |H(ω)| = 20 log |Y (jω)| |X(jω)| [dB] 27Frekvensresponsanalyse Udregning af frekvensrespons For at studere et systems respons til sinusformede signaler kan der kigges udelukkende på værdier for z, der ligger på enhedscirklen, dvs. z = ejωT Frekvensresponset for et tidsdiskret system H(z) er dermed givet som H(e jωT ) = Y (ejωT ) X(ejωT ) = H(z)|z=ejωT For at forkorte notationen skrives H(jω) = H(z)|z=ejωT På polær form er frekvensresponset H(jω) = |H(ω)|∠ϕ(ω) Amplituden er oftest givet i dB, dvs. |H(ω)| = 20 log |Y (jω)| |X(jω)| [dB] 28Frekvensresponsanalyse Eksempel (I) Betragt overføringsfunktionen H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 Vi ønsker at analysere frekvensresponset ved indgangssignal x(n) = sin(ωnT ) For at bestemme frekvensresponset udregnes H(jω), dvs. H(jω) = ej2ωT + 0, 4ejωT ej2ωT − 0, 7ejωT + 0, 1 For ωT = 1 H(jω) = 0, 92 − j1, 37 = 1.65∠ − 56◦ 28Frekvensresponsanalyse Eksempel (I) Betragt overføringsfunktionen H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 Vi ønsker at analysere frekvensresponset ved indgangssignal x(n) = sin(ωnT ) For at bestemme frekvensresponset udregnes H(jω), dvs. H(jω) = ej2ωT + 0, 4ejωT ej2ωT − 0, 7ejωT + 0, 1 For ωT = 1 H(jω) = 0, 92 − j1, 37 = 1.65∠ − 56◦ 28Frekvensresponsanalyse Eksempel (I) Betragt overføringsfunktionen H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 Vi ønsker at analysere frekvensresponset ved indgangssignal x(n) = sin(ωnT ) For at bestemme frekvensresponset udregnes H(jω), dvs. H(jω) = ej2ωT + 0, 4ejωT ej2ωT − 0, 7ejωT + 0, 1 For ωT = 1 H(jω) = 0, 92 − j1, 37 = 1.65∠ − 56◦ 28Frekvensresponsanalyse Eksempel (I) Betragt overføringsfunktionen H(z) = z2 + 0, 4z z2 − 0, 7z + 0, 1 Vi ønsker at analysere frekvensresponset ved indgangssignal x(n) = sin(ωnT ) For at bestemme frekvensresponset udregnes H(jω), dvs. H(jω) = ej2ωT + 0, 4ejωT ej2ωT − 0, 7ejωT + 0, 1 For ωT = 1 H(jω) = 0, 92 − j1, 37 = 1.65∠ − 56◦ 29Frekvensresponsanalyse Eksempel (II) Følgende respons fås ved at påtrykke indgangssignalet x(n) = sin(ωnT ) 0 20 40 60 -2 -1 0 1 2 0 20 40 60 -2 -1 0 1 2 Bemærk det transiente forløb i starten af simuleringen, som frekvensresponsanalysen ikke betragter. 29Frekvensresponsanalyse Eksempel (II) Følgende respons fås ved at påtrykke indgangssignalet x(n) = sin(ωnT ) 0 20 40 60 -2 -1 0 1 2 0 20 40 60 -2 -1 0 1 2 Bemærk det transiente forløb i starten af simuleringen, som frekvensresponsanalysen ikke betragter. 30Graﬁsk bestemmelse af frekvensrespons Introduktion Impulsrespons Stabilitet Frekvensresponsanalyse Graﬁsk bestemmelse af frekvensrespons Opsummering 31Graﬁsk bestemmelse af frekvensrespons Amplitude En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) hvor zi for i = 1, . . . , N er overføringsfunktionens nulpunkter og pi for i = 1, . . . , N er overføringsfunktionens poler. For at bestemme frekvensresponset skal amplituden og fasen for H(z) ﬁndes til ﬂere z-værdier. Amplituden bliver |H(z)| = a0 |z − z1||z − z2| · · · |z − zN | |z − p1||z − p2| · · · |z − pN | 31Graﬁsk bestemmelse af frekvensrespons Amplitude En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) hvor zi for i = 1, . . . , N er overføringsfunktionens nulpunkter og pi for i = 1, . . . , N er overføringsfunktionens poler. For at bestemme frekvensresponset skal amplituden og fasen for H(z) ﬁndes til ﬂere z-værdier. Amplituden bliver |H(z)| = a0 |z − z1||z − z2| · · · |z − zN | |z − p1||z − p2| · · · |z − pN | 32Graﬁsk bestemmelse af frekvensrespons Eksempel (Amplitude) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude |H(z)| = a0 |z − z1| |z − p1||z − p∗ 1| Re(z) Im(z) p∗ 1 zi p1 32Graﬁsk bestemmelse af frekvensrespons Eksempel (Amplitude) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude |H(z)| = a0 |z − z1| |z − p1||z − p∗ 1| Re(z) Im(z) p∗ 1 zi p1 z 32Graﬁsk bestemmelse af frekvensrespons Eksempel (Amplitude) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude |H(z)| = a0 |z − z1| |z − p1||z − p∗ 1| Re(z) Im(z) p∗ 1 zi p1 z z − p1 32Graﬁsk bestemmelse af frekvensrespons Eksempel (Amplitude) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude |H(z)| = a0 |z − z1| |z − p1||z − p∗ 1| |z − p1| |z − z1| Re(z) Im(z) p∗ 1 zi p1 z 33Graﬁsk bestemmelse af frekvensrespons Fase En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) hvor zi for i = 1, . . . , N er overføringsfunktionens nulpunkter og pi for i = 1, . . . , N er overføringsfunktionens poler. For at bestemme frekvensresponset skal amplituden og fasen for H(z) ﬁndes til ﬂere z-værdier. Fasen bliver ∠H(z) = ψ1 + ψ2 + · · · + ψN − (θ1 + θ2 + · · · + θN ) hvor ψi = ∠(z − zi) og θi = ∠(z − pi). 33Graﬁsk bestemmelse af frekvensrespons Fase En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) hvor zi for i = 1, . . . , N er overføringsfunktionens nulpunkter og pi for i = 1, . . . , N er overføringsfunktionens poler. For at bestemme frekvensresponset skal amplituden og fasen for H(z) ﬁndes til ﬂere z-værdier. Fasen bliver ∠H(z) = ψ1 + ψ2 + · · · + ψN − (θ1 + θ2 + · · · + θN ) hvor ψi = ∠(z − zi) og θi = ∠(z − pi). 34Graﬁsk bestemmelse af frekvensrespons Eksempel (Fase) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude ∠H(z) = ψ1 − θ1 − θ2 Re(z) Im(z) p∗ 1 zi p1 34Graﬁsk bestemmelse af frekvensrespons Eksempel (Fase) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude ∠H(z) = ψ1 − θ1 − θ2 Re(z) Im(z) p∗ 1 zi p1 z 34Graﬁsk bestemmelse af frekvensrespons Eksempel (Fase) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude ∠H(z) = ψ1 − θ1 − θ2 Re(z) Im(z) p∗ 1 zi p1 z z − p1 34Graﬁsk bestemmelse af frekvensrespons Eksempel (Fase) Vi betragter overføringsfunktionen H(z) = a0 (z − z1) (z − p1)(z − p∗ 1) der har amplitude ∠H(z) = ψ1 − θ1 − θ2 θ1 ψ1 Re(z) Im(z) p∗ 1 zi p1 z 35Graﬁsk bestemmelse af frekvensrespons Tilgang Frekvensresponset ﬁndes ved at ﬁnde amplitude og fase for H(z) når z ∈ C ligger på enhedscirklen, dvs. z = ejωt. Re(z) Im(z) p∗ 1 z1 p1 35Graﬁsk bestemmelse af frekvensrespons Tilgang Frekvensresponset ﬁndes ved at ﬁnde amplitude og fase for H(z) når z ∈ C ligger på enhedscirklen, dvs. z = ejωt. Re(z) Im(z) p∗ 1 z1 p1 z = ejω1T = ej2πf1T 35Graﬁsk bestemmelse af frekvensrespons Tilgang Frekvensresponset ﬁndes ved at ﬁnde amplitude og fase for H(z) når z ∈ C ligger på enhedscirklen, dvs. z = ejωt. f = fo f = -fo f = 0 Hz f = fs Re(z) Im(z) p∗ 1 z1 p1 z = ejω1T = ej2πf1T 35Graﬁsk bestemmelse af frekvensrespons Tilgang Frekvensresponset ﬁndes ved at ﬁnde amplitude og fase for H(z) når z ∈ C ligger på enhedscirklen, dvs. z = ejωt. f = fo f = -fo f = 0 Hz f = fs Re(z) Im(z) p∗ 1 z1 p1 z = ejω1T = ej2πf1T 35Graﬁsk bestemmelse af frekvensrespons Tilgang Frekvensresponset ﬁndes ved at ﬁnde amplitude og fase for H(z) når z ∈ C ligger på enhedscirklen, dvs. z = ejωt. f = fo f = -fo f = 0 Hz f = fs Re(z) Im(z) p∗ 1 z1 p1 z = ejω1T = ej2πf1T f [Hz] |H(ω)| 0 fs-fs f [Hz] ∠H(ω) 0 fs-fs 36Graﬁsk bestemmelse af frekvensrespons Eksempel 1 Hvordan ser frekvensresponset ud for en overføringsfunktion med følgende pol-nulpunktsdiagram? p1 Re(z) Im(z) 37Graﬁsk bestemmelse af frekvensrespons Eksempel 2 1k 2k 3k4k z1 z2 p1 p2 Re(z) Im(z) -50 -40 -30 -20 -10 0 10 20Magnitude (dB) 10 -1 10 0 10 1 -180 -135 -90 -45 0 45Phase (deg) Frequency (kHz) 37Graﬁsk bestemmelse af frekvensrespons Eksempel 2 1k 2k 3k4k z1 z2 p1 p2 Re(z) Im(z) -50 -40 -30 -20 -10 0 10 20Magnitude (dB) 10 -1 10 0 10 1 -180 -135 -90 -45 0 45Phase (deg) Frequency (kHz) 38Graﬁsk bestemmelse af frekvensrespons Eksempel 3 1k 2k 3k4k p1 p2 z1 z2 Re(z) Im(z) -20 0 20 40Magnitude (dB) 10 -1 10 0 10 1 -45 0 45 90 135 180Fase (deg) Frekvens (kHz) 38Graﬁsk bestemmelse af frekvensrespons Eksempel 3 1k 2k 3k4k p1 p2 z1 z2 Re(z) Im(z) -20 0 20 40Magnitude (dB) 10 -1 10 0 10 1 -45 0 45 90 135 180Fase (deg) Frekvens (kHz) 39Graﬁsk bestemmelse af frekvensrespons Samplefrekvens Samplefrekvensens betydning for frekvensresponset er kun at ﬂytte grafen langs frekvensaksen. f [Hz] |H(f )| [dB] -32 0 100 1k 3k 10k f [Hz] |H(f )| [dB] -32 0 100 1k 3k 10k Im(z) Re(z) fs = 8 kHz1k 2k Im(z) Re(z) fs = 40 kHz5k 10k 40Opsummering Introduktion Impulsrespons Stabilitet Frekvensresponsanalyse Graﬁsk bestemmelse af frekvensrespons Opsummering 41Opsummering Impulsrespons En overføringsfunktion kan faktoriseres som H(z) = a0 (z − z1)(z − z2) · · · (z − zN ) (z − p1)(z − p2) · · · (z − pN ) hvor zi for i = 1, . . . , N er overføringsfunktionens nulpunkter og pi = esiT = eσiT ejωiT for i = 1, . . . , N er overføringsfunktionens poler. Antag at alle poler er simple (alle poler har multiplicitet 1). Så kan impulsresponssekvensen skrives som h(n) = h1(n) + h2(n) + · · · + hN (n) hvor (ki ∈ C) hi(n) = kiZ −1 { z z − pi } = kieσinT ejωinT 42Opsummering Stabilitet Et systems stabilitetstilstand kan være en af følgende ▶ Stabilt system: Et system er stabilt hvis dets impulsrespons h(n) går mod nul når n går med uendelig |h(n)| → 0 for n → ∞ ▶ Marginalt stabilt system: Et system er marginalt stabilt hvis dets impulsrespons h(n) går mod konstant værdi forskellig fra nul eller oscillerer med konstant amplitude og frekvens når n går mod uendelig. ▶ Ustabilt system: Et system er ustabilt hvis dets impulsrespons h(n) vokser ubegrænset når n går med uendelig |h(n)| → ∞ for n → ∞ 43Opsummering Frekvensrespons Frekvensresponset ﬁndes ved at ﬁnde amplitude og fase for H(z) når z ∈ C ligger på enhedscirklen, dvs. z = ejωt. f = fo f = -fo f = 0 Hz f = fs Re(z) Im(z) p∗ 1 z1 p1 z = ejω1T = ej2πf1T f [Hz] |H(ω)| 0 fs-fs f [Hz] ∠H(ω) 0 fs-fs","libVersion":"0.2.4","langs":""}