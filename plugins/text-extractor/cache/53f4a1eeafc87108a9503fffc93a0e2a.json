{"path":"Lessons/Semester 3/signalbehandling/Slides/lektion 8 - Introduktion til IIR filtre.pdf","text":"Lektion 6: Introduktion til IIR ﬁltre Signalbehandling Christoffer Sloth chsl@mmmi.sdu.dk SDU Robotics The Maersk Mc-Kinney Moller Institute University of Southern Denmark 1Agenda Introduktion Design af digitale IIR ﬁltre Matched z-transformation Impuls invariant z-transformation Opsummering 2Introduktion Pensum for Signalbehandling Datakonvertering og digital signalbehandling herunder: 1 ▶ ideel og praktisk sampling og rekonstruktion ▶ aliasing ▶ kvantisering og dynamikområde ▶ konverteringsprincipper (A/D og D/A) ▶ implementationsprincipper (Sample & Hold, A/D, D/A) ▶ multirate sampling ▶ diskret-tid signaler og systemer i tids- og frekvensdomænet ▶ Z-transformationen ▶ overføringsfunktion for lineære tidsinvariante systemer ▶ systemanalyse ▶ frekvensanalyse ▶ lineær fase systemer ▶ realisationsstrukturer for diskret-tid systemer ▶ hovedanvendelse af digital signalbehandling herunder digitale IIR-ﬁltre og transformation af analoge ﬁltre samt digitale FIR-ﬁltre og vindues-funktioner 1 Baseret på https://odin.sdu.dk/sitecore/index.php?a=fagbesk&id=65003&listid=9093&lang=da 3Introduktion Course Overview ▶ Lektion 1: Filterfunktioner ▶ Lektion 2: Sampling og rekonstruktion ▶ Lektion 3: Introduktion til z-transformation ▶ Lektion 4: Systemanalyse i z-domæne ▶ Lektion 5: Digitale realisationsstrukturer ▶ Lektion 6: Introduktion til IIR-ﬁltre ▶ Lektion 7: Design af IIR-ﬁltre ▶ Lektion 8: Introduktion til FIR-ﬁltre ▶ Lektion 9: Design af FIR-ﬁltre ▶ Lektion 10: Fast Fourier transformation (I) ▶ Lektion 11: Fast Fourier transformation (II) ▶ Lektion 12: Anvendelse af digital signalbehandling 4Intoduktion Motivation Digitale ﬁltre opdeles i to kategorier, i henhold til deres impulsrespons ▶ Inﬁnite Impulse Response ﬁlters (IIR-ﬁltre) ▶ Har altid poler ▶ Finite Impulse Response ﬁlters (FIR-ﬁltre) ▶ Har kun nulpunkter ▶ Kan implementeres med lineær fasekarakteristik Foreskelle imellem FIR ﬁltre og IIR ﬁltre ▶ Et FIR ﬁlter har 5 til 10 gange større realisationsstruktur end et tilsvarende IIR ﬁlter. ▶ Et FIR ﬁlter er altid stabilt, da det kun har nulpunkter. ▶ Et FIR ﬁlter kaldes en ikke-rekursiv struktur, mens et IIR ﬁlter kaldes en rekursiv struktur. ▶ Et FIR ﬁlter er mindre sensitivt overfor koefﬁcientændringer og afrundingsfejl end et IIR ﬁlter. 4Intoduktion Motivation Digitale ﬁltre opdeles i to kategorier, i henhold til deres impulsrespons ▶ Inﬁnite Impulse Response ﬁlters (IIR-ﬁltre) ▶ Har altid poler ▶ Finite Impulse Response ﬁlters (FIR-ﬁltre) ▶ Har kun nulpunkter ▶ Kan implementeres med lineær fasekarakteristik Foreskelle imellem FIR ﬁltre og IIR ﬁltre ▶ Et FIR ﬁlter har 5 til 10 gange større realisationsstruktur end et tilsvarende IIR ﬁlter. ▶ Et FIR ﬁlter er altid stabilt, da det kun har nulpunkter. ▶ Et FIR ﬁlter kaldes en ikke-rekursiv struktur, mens et IIR ﬁlter kaldes en rekursiv struktur. ▶ Et FIR ﬁlter er mindre sensitivt overfor koefﬁcientændringer og afrundingsfejl end et IIR ﬁlter. 5Design af digitale IIR ﬁltre Introduktion Design af digitale IIR ﬁltre Matched z-transformation Impuls invariant z-transformation Opsummering 6Design af digitale IIR ﬁltre Introduktion Digitale IIR-ﬁltre kan designes ved transformation af prototype-ﬁltre i s-domæne ved brug af følgende metoder ▶ Matched z-transformation ▶ Impuls invariant z-transformation ▶ Bilineær z-transformation 7Design af digitale IIR ﬁltre Overblik Et IIR-ﬁlter designes ved at følge proceduren 1. Filtrets speciﬁkationer opstilles 2. Filtrets z-domæne overføringsfunktion opstilles 3. Der vælges optimal realisationsstruktur 4. Der fremstilles program til signalprocessor eller tegnes diagram for hardwareløsning 8Design af digitale IIR ﬁltre Transformation af analogt prototype ﬁlter (I) Fremgangsmetoden for design af IIR-ﬁltre er z-transformation af et analogt prototype ﬁlter, dvs. vi transformerer H(s) = ∑M i=0 Ais i ∑N i=0 Bisi til H(z) = ∑M i=0 aiz−i ∑N i=0 bis−i x(t) y(t) H(s) Z Analogt prototypeﬁlter x(n) y(n) H(z) Digitalt ﬁlter 9Design af digitale IIR ﬁltre Transformation af analogt prototype ﬁlter (II) Transformationen fra s-domæne til z-domæne ﬂytter polerne i s-planen til poler i z-planen, der giver et lignende Bode plot og ﬁlterrespons. log(f ) |H(f )| fc fo Z s-plan jω σ z-plan Im(z) Re(z) 1-1 log(f ) |H(f )| fc fo 10Matched z-transformation Introduktion Design af digitale IIR ﬁltre Matched z-transformation Impuls invariant z-transformation Opsummering 11Matched z-transformation Introduktion Ved matched z-transformation overføres prototypeﬁltrets poler og nulpunkter direkte til z-domæne ved brug af formlen z = esT Husk at vi tidligere har anvendt denne relation til at relatere z-planen med s-planen. 11Matched z-transformation Introduktion Ved matched z-transformation overføres prototypeﬁltrets poler og nulpunkter direkte til z-domæne ved brug af formlen z = esT Husk at vi tidligere har anvendt denne relation til at relatere z-planen med s-planen. 12Matched z-transformation Første ordens system (I) En første ordens overføringsfunktion med et nulpunkt er givet ved H(s) = s + A0 s + B0 = s − σ1 s − σ2 hvor σ1 = −A0 er et reelt nulpunkt og σ2 = −B0 er en reelt pol. Ved brug af matched z-transformation kan nulpunktet og polen udregnes som z1 = es1T = eσ1T og z2 = e s2T = eσ2T σ jω σ1σ2 z1z2 Re(z) Im(z) Z 12Matched z-transformation Første ordens system (I) En første ordens overføringsfunktion med et nulpunkt er givet ved H(s) = s + A0 s + B0 = s − σ1 s − σ2 hvor σ1 = −A0 er et reelt nulpunkt og σ2 = −B0 er en reelt pol. Ved brug af matched z-transformation kan nulpunktet og polen udregnes som z1 = es1T = eσ1T og z2 = e s2T = eσ2T σ jω σ1σ2 z1z2 Re(z) Im(z) Z 12Matched z-transformation Første ordens system (I) En første ordens overføringsfunktion med et nulpunkt er givet ved H(s) = s + A0 s + B0 = s − σ1 s − σ2 hvor σ1 = −A0 er et reelt nulpunkt og σ2 = −B0 er en reelt pol. Ved brug af matched z-transformation kan nulpunktet og polen udregnes som z1 = es1T = eσ1T og z2 = e s2T = eσ2T σ jω σ1σ2 z1z2 Re(z) Im(z) Z 13Matched z-transformation Første ordens system (II) Et digitalt første ordens ﬁlter givet fra matched z-transformation har formen H(z) = z − eσ1T z − eσ2T eller H(z) = 1 − eσ1T z−1 1 − eσ2T z−1 14Matched z-transformation Første ordens system (III) Betragt et første ordens system uden nulpunkt H(s) = ωa s + ωa Hvis førnævnte procedure benyttes, så fåes overføringsfunktionen H(z) = 1 1 − eσ1T z−1 hvor σ1 er polen for H(s) og T er sampleintervallet [s]. Overføringsfunktionen H(z) har ikke DC-forstærkning på 1 ligesom H(s). Derfor indføres forstærkningen a0, dvs. H(z) = a0 1 + b1z−1 hvor b1 = −e σ1T og a0 = 1 + b1 14Matched z-transformation Første ordens system (III) Betragt et første ordens system uden nulpunkt H(s) = ωa s + ωa Hvis førnævnte procedure benyttes, så fåes overføringsfunktionen H(z) = 1 1 − eσ1T z−1 hvor σ1 er polen for H(s) og T er sampleintervallet [s]. Overføringsfunktionen H(z) har ikke DC-forstærkning på 1 ligesom H(s). Derfor indføres forstærkningen a0, dvs. H(z) = a0 1 + b1z−1 hvor b1 = −e σ1T og a0 = 1 + b1 14Matched z-transformation Første ordens system (III) Betragt et første ordens system uden nulpunkt H(s) = ωa s + ωa Hvis førnævnte procedure benyttes, så fåes overføringsfunktionen H(z) = 1 1 − eσ1T z−1 hvor σ1 er polen for H(s) og T er sampleintervallet [s]. Overføringsfunktionen H(z) har ikke DC-forstærkning på 1 ligesom H(s). Derfor indføres forstærkningen a0, dvs. H(z) = a0 1 + b1z−1 hvor b1 = −e σ1T og a0 = 1 + b1 15Matched z-transformation Første ordens system (IV) En digital realisationsstruktur for første ordens systemet er vist her. x(n) + z-1 a0 -b1 y(n) 16Matched z-transformation Eksempel (I) Betragt følgende analoge 1. ordens lavpasﬁlter med afskæringsfrekvens ωa = 2πfa hvor fa = 300 Hz H(s) = ωa s + ωa = 1885 s + 1885 som har pol i s1 = σ1 = −1885. Vi ønsker at bestemme et digitalt ﬁlter ved matched z-transformation med samplingsfrekvens på 16 kHz. Koefﬁcienterne for det digitale ﬁlter bliver b1 = −eσ1T = −0, 8889 a0 = 1 + b1 = 0, 1111 Det digitale lavpasﬁlters overføringsfunktion er H(z) = 0, 1111 1 − 0, 8889z−1 16Matched z-transformation Eksempel (I) Betragt følgende analoge 1. ordens lavpasﬁlter med afskæringsfrekvens ωa = 2πfa hvor fa = 300 Hz H(s) = ωa s + ωa = 1885 s + 1885 som har pol i s1 = σ1 = −1885. Vi ønsker at bestemme et digitalt ﬁlter ved matched z-transformation med samplingsfrekvens på 16 kHz. Koefﬁcienterne for det digitale ﬁlter bliver b1 = −eσ1T = −0, 8889 a0 = 1 + b1 = 0, 1111 Det digitale lavpasﬁlters overføringsfunktion er H(z) = 0, 1111 1 − 0, 8889z−1 16Matched z-transformation Eksempel (I) Betragt følgende analoge 1. ordens lavpasﬁlter med afskæringsfrekvens ωa = 2πfa hvor fa = 300 Hz H(s) = ωa s + ωa = 1885 s + 1885 som har pol i s1 = σ1 = −1885. Vi ønsker at bestemme et digitalt ﬁlter ved matched z-transformation med samplingsfrekvens på 16 kHz. Koefﬁcienterne for det digitale ﬁlter bliver b1 = −eσ1T = −0, 8889 a0 = 1 + b1 = 0, 1111 Det digitale lavpasﬁlters overføringsfunktion er H(z) = 0, 1111 1 − 0, 8889z−1 16Matched z-transformation Eksempel (I) Betragt følgende analoge 1. ordens lavpasﬁlter med afskæringsfrekvens ωa = 2πfa hvor fa = 300 Hz H(s) = ωa s + ωa = 1885 s + 1885 som har pol i s1 = σ1 = −1885. Vi ønsker at bestemme et digitalt ﬁlter ved matched z-transformation med samplingsfrekvens på 16 kHz. Koefﬁcienterne for det digitale ﬁlter bliver b1 = −eσ1T = −0, 8889 a0 = 1 + b1 = 0, 1111 Det digitale lavpasﬁlters overføringsfunktion er H(z) = 0, 1111 1 − 0, 8889z−1 17Matched z-transformation Eksempel (II) Det digitale ﬁlter H(z) har nulpunkt i z = 0 og pol i z = 0, 8889 og direkte type 2 realisationsstruktur som vist herunder. x(n) + z-1 0,111 0,889 y(n) z1 z2 Re(z) Im(z) 18Matched z-transformation Eksempel (III) Ved sammenligning af amplitudekarakteristikkerne for de to ﬁltre ses det at de afviger ved høje frekvenser (tæt på foldningsfrekvensen fo). 101 102 103 104 -35 -30 -25 -20 -15 -10 -5 0Magnitude (dB) H(s) H(z) Frequency (Hz) Grundet forskellen mellem ﬁltrene kan denne transformation kun benyttes når fa << fo. 18Matched z-transformation Eksempel (III) Ved sammenligning af amplitudekarakteristikkerne for de to ﬁltre ses det at de afviger ved høje frekvenser (tæt på foldningsfrekvensen fo). 101 102 103 104 -35 -30 -25 -20 -15 -10 -5 0Magnitude (dB) H(s) H(z) Frequency (Hz) Grundet forskellen mellem ﬁltrene kan denne transformation kun benyttes når fa << fo. 19Matched z-transformation Anden ordens system (I) For et andet ordens system med komplekst konjugeret pol- og nulpunktspar kan overføringsfunktionen skrives H(s) = s 2 + A1s + A0 s2 + B1s + B0 som har nulpunkter i s1 = σ1 + jω1, s ∗ 1 = σ1 − jω1 og poler i s2 = σ2 + jω2, s ∗ 2 = σ2 − jω2. Ved matched z-transformation fås H(z) = (z − eσ1T ejω1T )(z − e σ1T e−jω1T ) (z − eσ2T ejω2T )(z − eσ2T e−jω2T ) Ved brug af Eulers identitet fås (cos(x) = (ejx + e−jx)/2) H(z) = z2 − (2eσ1T cos(ω1T ))z + e2σ1T z2 − (2eσ2T cos(ω2T ))z + e2σ2T = 1 − (2e σ1T cos(ω1T ))z−1 + e2σ1T z−2 1 − (2eσ2T cos(ω2T ))z−1 + e2σ2T z−2 19Matched z-transformation Anden ordens system (I) For et andet ordens system med komplekst konjugeret pol- og nulpunktspar kan overføringsfunktionen skrives H(s) = s 2 + A1s + A0 s2 + B1s + B0 som har nulpunkter i s1 = σ1 + jω1, s ∗ 1 = σ1 − jω1 og poler i s2 = σ2 + jω2, s ∗ 2 = σ2 − jω2. Ved matched z-transformation fås H(z) = (z − eσ1T ejω1T )(z − e σ1T e−jω1T ) (z − eσ2T ejω2T )(z − eσ2T e−jω2T ) Ved brug af Eulers identitet fås (cos(x) = (ejx + e−jx)/2) H(z) = z2 − (2eσ1T cos(ω1T ))z + e2σ1T z2 − (2eσ2T cos(ω2T ))z + e2σ2T = 1 − (2e σ1T cos(ω1T ))z−1 + e2σ1T z−2 1 − (2eσ2T cos(ω2T ))z−1 + e2σ2T z−2 19Matched z-transformation Anden ordens system (I) For et andet ordens system med komplekst konjugeret pol- og nulpunktspar kan overføringsfunktionen skrives H(s) = s 2 + A1s + A0 s2 + B1s + B0 som har nulpunkter i s1 = σ1 + jω1, s ∗ 1 = σ1 − jω1 og poler i s2 = σ2 + jω2, s ∗ 2 = σ2 − jω2. Ved matched z-transformation fås H(z) = (z − eσ1T ejω1T )(z − e σ1T e−jω1T ) (z − eσ2T ejω2T )(z − eσ2T e−jω2T ) Ved brug af Eulers identitet fås (cos(x) = (ejx + e−jx)/2) H(z) = z2 − (2eσ1T cos(ω1T ))z + e2σ1T z2 − (2eσ2T cos(ω2T ))z + e2σ2T = 1 − (2e σ1T cos(ω1T ))z−1 + e2σ1T z−2 1 − (2eσ2T cos(ω2T ))z−1 + e2σ2T z−2 20Matched z-transformation Anden ordens system (II) Et andet ordens lavpasﬁlter er givet som H(z) = a0 1 + b1z−1 + b2z−2 Fra tidligere omskrivning haves b1 = −2eσ1T cos(ω1T ) og b2 = e2σiT Hvis DC forstærkningen for lavpasﬁltret skal være 0 dB så gælder det at a0 = 1 + b1 + b2 20Matched z-transformation Anden ordens system (II) Et andet ordens lavpasﬁlter er givet som H(z) = a0 1 + b1z−1 + b2z−2 Fra tidligere omskrivning haves b1 = −2eσ1T cos(ω1T ) og b2 = e2σiT Hvis DC forstærkningen for lavpasﬁltret skal være 0 dB så gælder det at a0 = 1 + b1 + b2 20Matched z-transformation Anden ordens system (II) Et andet ordens lavpasﬁlter er givet som H(z) = a0 1 + b1z−1 + b2z−2 Fra tidligere omskrivning haves b1 = −2eσ1T cos(ω1T ) og b2 = e2σiT Hvis DC forstærkningen for lavpasﬁltret skal være 0 dB så gælder det at a0 = 1 + b1 + b2 21Matched z-transformation Anden ordens system (III) Realisationsstrukturen for lavpasﬁltret er givet som vist herunder. x(n) + z-1 a0 -b1 y(n) + z-1 -b2 22Matched z-transformation Design procedure Følgende procedure benyttes til design af digitale ﬁltre ved brug af matched z-transformation 1. Bestem det analoge prototypeﬁlters frekvensnormerede og faktoriserede overføringsfunktion H(s). 2. Bestem de analoge frekvensnormerede poler og nulpunkter. 3. Bestem de denormerede poler og nulpunkter. 4. Bestem den digitale overføringsfunktions koefﬁcienter. 5. Implementer overføringsfunktionen som en kaskadestruktur. 23Matched z-transformation Eksempel (I) Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz ved brug af Matched z-transformation med samplefrekvens på 8 kHz. En frekvensnormeret overføringsfunktionen for et 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz er givet som H(s) = 1 s2 + 1, 414s + 1 og har poler i s = −0, 7071 ± j0, 7071. De denormerede poler fås ved multiplikation med afskæringsfrekvensen ωa, dvs. s1 = σ1 + jω1 = −3554 + j3554 Filterkoefﬁcienterne kan nu udregnes ved brug af formlerne b1 = 2eσ1T cos(ω1T ) b2 = e2σ1T a0 = 1 + b1 + b2 23Matched z-transformation Eksempel (I) Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz ved brug af Matched z-transformation med samplefrekvens på 8 kHz. En frekvensnormeret overføringsfunktionen for et 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz er givet som H(s) = 1 s2 + 1, 414s + 1 og har poler i s = −0, 7071 ± j0, 7071. De denormerede poler fås ved multiplikation med afskæringsfrekvensen ωa, dvs. s1 = σ1 + jω1 = −3554 + j3554 Filterkoefﬁcienterne kan nu udregnes ved brug af formlerne b1 = 2eσ1T cos(ω1T ) b2 = e2σ1T a0 = 1 + b1 + b2 23Matched z-transformation Eksempel (I) Design et digitalt 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz ved brug af Matched z-transformation med samplefrekvens på 8 kHz. En frekvensnormeret overføringsfunktionen for et 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz er givet som H(s) = 1 s2 + 1, 414s + 1 og har poler i s = −0, 7071 ± j0, 7071. De denormerede poler fås ved multiplikation med afskæringsfrekvensen ωa, dvs. s1 = σ1 + jω1 = −3554 + j3554 Filterkoefﬁcienterne kan nu udregnes ved brug af formlerne b1 = 2eσ1T cos(ω1T ) b2 = e2σ1T a0 = 1 + b1 + b2 24Matched z-transformation Eksempel (II) Det ses at det digitale ﬁlter er en kraftigt aliaseret version af det oprindelige analoge ﬁlter. -80 -60 -40 -20 0Magnitude (dB) 101 102 103 104 105 -180 -135 -90 -45 0Phase (deg) Frequency (Hz) 25Matched z-transformation Digital 2. ordens resonator (I) Vi betragter 2. ordens overføringsfunktioner med komplekse poler, der er stærkt underdæmpet (ζ < 0.1 eller Q > 5). Sådanne systemer har en forstærkningspeak |H(ωp)| ≈ 20 log Q ved peak frekvensen ωp, hvor det gælder at ωp ≈ ωn. |Hmax| |H(ω)| |H(0)| ωp ≈ ωn ω 3 dB ∆ω Dette ﬁlter kaldes en 2. ordens resonator, og er en simpel måde at realisere et båndpasﬁlter på. 25Matched z-transformation Digital 2. ordens resonator (I) Vi betragter 2. ordens overføringsfunktioner med komplekse poler, der er stærkt underdæmpet (ζ < 0.1 eller Q > 5). Sådanne systemer har en forstærkningspeak |H(ωp)| ≈ 20 log Q ved peak frekvensen ωp, hvor det gælder at ωp ≈ ωn. |Hmax| |H(ω)| |H(0)| ωp ≈ ωn ω 3 dB ∆ω Dette ﬁlter kaldes en 2. ordens resonator, og er en simpel måde at realisere et båndpasﬁlter på. 25Matched z-transformation Digital 2. ordens resonator (I) Vi betragter 2. ordens overføringsfunktioner med komplekse poler, der er stærkt underdæmpet (ζ < 0.1 eller Q > 5). Sådanne systemer har en forstærkningspeak |H(ωp)| ≈ 20 log Q ved peak frekvensen ωp, hvor det gælder at ωp ≈ ωn. |Hmax| |H(ω)| |H(0)| ωp ≈ ωn ω 3 dB ∆ω Dette ﬁlter kaldes en 2. ordens resonator, og er en simpel måde at realisere et båndpasﬁlter på. 26Matched z-transformation Digital 2. ordens resonator (II) Filtrets -3 dB båndbredde ∆ω kan for ζ < 0.1 udregnes som følger. Filtrets Q-værdi er Q ≈ ωn ∆ω Dette giver en overføringsfunktion H(s) = 1 s2 + 1 Q ωns + ω2 n Et tilsvarende digitalt ﬁlter er givet som H(z) = a0 1 + b1z−1 + b2z−2 26Matched z-transformation Digital 2. ordens resonator (II) Filtrets -3 dB båndbredde ∆ω kan for ζ < 0.1 udregnes som følger. Filtrets Q-værdi er Q ≈ ωn ∆ω Dette giver en overføringsfunktion H(s) = 1 s2 + 1 Q ωns + ω2 n Et tilsvarende digitalt ﬁlter er givet som H(z) = a0 1 + b1z−1 + b2z−2 26Matched z-transformation Digital 2. ordens resonator (II) Filtrets -3 dB båndbredde ∆ω kan for ζ < 0.1 udregnes som følger. Filtrets Q-værdi er Q ≈ ωn ∆ω Dette giver en overføringsfunktion H(s) = 1 s2 + 1 Q ωns + ω2 n Et tilsvarende digitalt ﬁlter er givet som H(z) = a0 1 + b1z−1 + b2z−2 27Matched z-transformation Digital 2. ordens resonator (III) Når følgende digitale ﬁlters koefﬁcienter skal ﬁndes kan udtryk for resonansforstærkning og minimale forstærkning benyttes. H(z) = a0 1 + b1z−1 + b2z−2 Resonansforstærkningen ved ωp er i dB |Hmax| = 20 log a0 (1 − b2) √1 − (b2 1/4b2) Resonatorens minimale stopbåndsdæmpning |H(0)| = 20 log a0 1 + b1 + b2 28Matched z-transformation Eksempel (I) Design et digitalt båndpasﬁlter med resonansfrekvens fc = 500 Hz og -3 dB båndbredde ∆f = 20 Hz. Filtrets samplefrekvens skal være 8 kHz. For at ﬁnde et analogt ﬁlter skal Q-værdien ﬁndes Q = fc ∆f = 25 Nu kan et frekvensnormeret ﬁlter ﬁndes som H(s) = 1 s2 + 1 Q s + 1 = 1 s2 + 0, 04s + 1 med poler s1 = −0, 02 + j0, 9998 og s ∗ 1 = −0, 02 − j0, 9998. De denormerede poler ﬁndes ved multiplikation med centerfrekvensen, dvs. σ1 ± jω1 = −62, 83 ± j3141 28Matched z-transformation Eksempel (I) Design et digitalt båndpasﬁlter med resonansfrekvens fc = 500 Hz og -3 dB båndbredde ∆f = 20 Hz. Filtrets samplefrekvens skal være 8 kHz. For at ﬁnde et analogt ﬁlter skal Q-værdien ﬁndes Q = fc ∆f = 25 Nu kan et frekvensnormeret ﬁlter ﬁndes som H(s) = 1 s2 + 1 Q s + 1 = 1 s2 + 0, 04s + 1 med poler s1 = −0, 02 + j0, 9998 og s ∗ 1 = −0, 02 − j0, 9998. De denormerede poler ﬁndes ved multiplikation med centerfrekvensen, dvs. σ1 ± jω1 = −62, 83 ± j3141 28Matched z-transformation Eksempel (I) Design et digitalt båndpasﬁlter med resonansfrekvens fc = 500 Hz og -3 dB båndbredde ∆f = 20 Hz. Filtrets samplefrekvens skal være 8 kHz. For at ﬁnde et analogt ﬁlter skal Q-værdien ﬁndes Q = fc ∆f = 25 Nu kan et frekvensnormeret ﬁlter ﬁndes som H(s) = 1 s2 + 1 Q s + 1 = 1 s2 + 0, 04s + 1 med poler s1 = −0, 02 + j0, 9998 og s ∗ 1 = −0, 02 − j0, 9998. De denormerede poler ﬁndes ved multiplikation med centerfrekvensen, dvs. σ1 ± jω1 = −62, 83 ± j3141 28Matched z-transformation Eksempel (I) Design et digitalt båndpasﬁlter med resonansfrekvens fc = 500 Hz og -3 dB båndbredde ∆f = 20 Hz. Filtrets samplefrekvens skal være 8 kHz. For at ﬁnde et analogt ﬁlter skal Q-værdien ﬁndes Q = fc ∆f = 25 Nu kan et frekvensnormeret ﬁlter ﬁndes som H(s) = 1 s2 + 1 Q s + 1 = 1 s2 + 0, 04s + 1 med poler s1 = −0, 02 + j0, 9998 og s ∗ 1 = −0, 02 − j0, 9998. De denormerede poler ﬁndes ved multiplikation med centerfrekvensen, dvs. σ1 ± jω1 = −62, 83 ± j3141 29Matched z-transformation Eksempel (II) Filterkoefﬁcienterne udregnes ved brug af ligningerne b1 = 2eσ1T cos(ω1T ) og b2 = e2σiT og ved at vælge |Hmax| = 0 dB fås en forstærkning i pasbåndet på 0 dB. Dette opnås ved at a0-koefﬁcienten er a0 = (1 − b2) √1 − (b2 1/4b2) Dette giver overføringsfunktionen H(z) = 5, 975 · 10 −3 1 − 1, 833z−1 + 0, 9944z−2 29Matched z-transformation Eksempel (II) Filterkoefﬁcienterne udregnes ved brug af ligningerne b1 = 2eσ1T cos(ω1T ) og b2 = e2σiT og ved at vælge |Hmax| = 0 dB fås en forstærkning i pasbåndet på 0 dB. Dette opnås ved at a0-koefﬁcienten er a0 = (1 − b2) √1 − (b2 1/4b2) Dette giver overføringsfunktionen H(z) = 5, 975 · 10 −3 1 − 1, 833z−1 + 0, 9944z−2 30Impuls invariant z-transformation Introduktion Design af digitale IIR ﬁltre Matched z-transformation Impuls invariant z-transformation Opsummering 31Impuls invariant z-transformation Introduktion Kategorien af z-transformationer kaldet input invariant z-transformation karakteriseres ved at lade responset til en bestemt type indgangssignal (step, impuls, rampe) være invariant under z-transformation. Vi kigger på impuls invariant z-transformation, dvs. h(n) = h(nT ) = h(t)|t=nT t h(t) 0 n h(n) 0 31Impuls invariant z-transformation Introduktion Kategorien af z-transformationer kaldet input invariant z-transformation karakteriseres ved at lade responset til en bestemt type indgangssignal (step, impuls, rampe) være invariant under z-transformation. Vi kigger på impuls invariant z-transformation, dvs. h(n) = h(nT ) = h(t)|t=nT t h(t) 0 n h(n) 0 32Impuls invariant z-transformation Fremgangsmetode (I) For at ﬁnde en impulsinvariant z-transformation, så z-transformeres impulsresponset H(z) = T · Z[h(n)] Givet et N te ordens ﬁlter H(s) = ∑M i=0 Ais i ∑N i=0 Bisi M ≤ N der ved partialbrøksopløsning er H(s) = N∑ i=1 ki s − si hvor si er det analoge ﬁlters pol nummer i. 32Impuls invariant z-transformation Fremgangsmetode (I) For at ﬁnde en impulsinvariant z-transformation, så z-transformeres impulsresponset H(z) = T · Z[h(n)] Givet et N te ordens ﬁlter H(s) = ∑M i=0 Ais i ∑N i=0 Bisi M ≤ N der ved partialbrøksopløsning er H(s) = N∑ i=1 ki s − si hvor si er det analoge ﬁlters pol nummer i. 33Impuls invariant z-transformation Fremgangsmetode (II) Overføringsfunktionen H(s) = N∑ i=1 ki s − si kan nu invers Laplace transformeres h(t) = L−1[H(s)] = N∑ i=1 kiesit Det digitaleﬁlters impulsrespons er dermed givet som h(n) = h(nT ) = N∑ i=1 kiesinT Ved z-transformation af h(n) fås H(z) = T N∑ i=1 ki z z − esiT = T N∑ i=1 ki 1 − esiT z−1 33Impuls invariant z-transformation Fremgangsmetode (II) Overføringsfunktionen H(s) = N∑ i=1 ki s − si kan nu invers Laplace transformeres h(t) = L−1[H(s)] = N∑ i=1 kiesit Det digitaleﬁlters impulsrespons er dermed givet som h(n) = h(nT ) = N∑ i=1 kiesinT Ved z-transformation af h(n) fås H(z) = T N∑ i=1 ki z z − esiT = T N∑ i=1 ki 1 − esiT z−1 33Impuls invariant z-transformation Fremgangsmetode (II) Overføringsfunktionen H(s) = N∑ i=1 ki s − si kan nu invers Laplace transformeres h(t) = L−1[H(s)] = N∑ i=1 kiesit Det digitaleﬁlters impulsrespons er dermed givet som h(n) = h(nT ) = N∑ i=1 kiesinT Ved z-transformation af h(n) fås H(z) = T N∑ i=1 ki z z − esiT = T N∑ i=1 ki 1 − esiT z−1 34Impuls invariant z-transformation 1. ordens systemer Når koefﬁcienterne skal udregnes for et 1. ordens lavpasﬁlter H(s) = A0 s + B0 = −σ0 s − σ0 kan førnævnte z-transformation anvendes H(z) = T N∑ i=1 ki z z − esiT = T N∑ i=1 ki 1 − esiT z−1 Dermed fås H(z) = a0 1 + b1z−1 hvor a0 = −σiT og b1 = −eσiT 34Impuls invariant z-transformation 1. ordens systemer Når koefﬁcienterne skal udregnes for et 1. ordens lavpasﬁlter H(s) = A0 s + B0 = −σ0 s − σ0 kan førnævnte z-transformation anvendes H(z) = T N∑ i=1 ki z z − esiT = T N∑ i=1 ki 1 − esiT z−1 Dermed fås H(z) = a0 1 + b1z−1 hvor a0 = −σiT og b1 = −eσiT 35Impuls invariant z-transformation 2. ordens systemer (I) Når koefﬁcienterne skal udregnes for et 2. ordens lavpasﬁlter H(s) = A0 s2 + B1s + B0 så skal H(s) partialbrøkopløses som H(s) = ki s − si + k∗ i s − s∗ i hvor si = σi + jωi og s ∗ i er systemets poler og koefﬁcienten er ki = αi + jβi. Ved z-transformation fås H(z) = T ( ki 1 − esiT z−1 + k∗ i 1 − es∗ i T z−1 ) Ovenstående kan omskrives til H(z) = T 2αi − 2eσiT (αi cos(ωiT ) − βi sin(ωiT ))z−1 1 − (2eσiT cos(ωiT ))z−1 + e2σiT z−2 35Impuls invariant z-transformation 2. ordens systemer (I) Når koefﬁcienterne skal udregnes for et 2. ordens lavpasﬁlter H(s) = A0 s2 + B1s + B0 så skal H(s) partialbrøkopløses som H(s) = ki s − si + k∗ i s − s∗ i hvor si = σi + jωi og s ∗ i er systemets poler og koefﬁcienten er ki = αi + jβi. Ved z-transformation fås H(z) = T ( ki 1 − esiT z−1 + k∗ i 1 − es∗ i T z−1 ) Ovenstående kan omskrives til H(z) = T 2αi − 2eσiT (αi cos(ωiT ) − βi sin(ωiT ))z−1 1 − (2eσiT cos(ωiT ))z−1 + e2σiT z−2 35Impuls invariant z-transformation 2. ordens systemer (I) Når koefﬁcienterne skal udregnes for et 2. ordens lavpasﬁlter H(s) = A0 s2 + B1s + B0 så skal H(s) partialbrøkopløses som H(s) = ki s − si + k∗ i s − s∗ i hvor si = σi + jωi og s ∗ i er systemets poler og koefﬁcienten er ki = αi + jβi. Ved z-transformation fås H(z) = T ( ki 1 − esiT z−1 + k∗ i 1 − es∗ i T z−1 ) Ovenstående kan omskrives til H(z) = T 2αi − 2eσiT (αi cos(ωiT ) − βi sin(ωiT ))z−1 1 − (2eσiT cos(ωiT ))z−1 + e2σiT z−2 36Impuls invariant z-transformation 2. ordens systemer (II) Slutteligt kan H(z) = T 2αi − 2eσiT (αi cos(ωiT ) − βi sin(ωiT ))z−1 1 − (2eσiT cos(ωiT ))z−1 + e2σiT z−2 skrives som H(z) = a0 + a1z−1 1 + b1z−1 + b2z−2 hvor a0 = 2αi a1 = −2eσiT (αi cos(ωiT ) − βi sin(ωiT )) b1 = −(2eσiT cos(ωiT )) b2 = e2σiT 37Impuls invariant z-transformation Design procedure Følgende procedure benyttes til design af digitale ﬁltre ved brug af impuls invariant z-transformation 1. Bestem det analoge prototypeﬁlters frekvensnormerede overføringsfunktion H(s). 2. Partialbrøksopløs H(s) til 1. og 2. ordens overføringsfunktioner (maksimalt antal 2. ordens overføringsfunktioner). 3. Denormer koefﬁcienterne ki og polerne σi + jωi ved multiplikation med afskæringsfrekvensen eller centerfrekvensen. 4. Bestem den digitale overføringsfunktions koefﬁcienter. 5. Implementer overføringsfunktionen som en parallelstruktur. 38Impuls invariant z-transformation Eksempel (I) En frekvensnormeret overføringsfunktionen for et 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz er givet som H(s) = 1 s2 + 1, 414s + 1 og har poler i s = −0, 7071 ± j0, 7071. Ved partialbrøkopløsning kan H(s) skrives H(s) = k1 s + 0, 7071 − j0, 7071 + k∗ 1 s + 0, 7071 + j0, 7071 De normerede koefﬁcienter ﬁndes til k1 = α1 + jβ1 = −j0, 7071 og k∗ 1 = α1 − jβ1 = j0, 7071 38Impuls invariant z-transformation Eksempel (I) En frekvensnormeret overføringsfunktionen for et 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz er givet som H(s) = 1 s2 + 1, 414s + 1 og har poler i s = −0, 7071 ± j0, 7071. Ved partialbrøkopløsning kan H(s) skrives H(s) = k1 s + 0, 7071 − j0, 7071 + k∗ 1 s + 0, 7071 + j0, 7071 De normerede koefﬁcienter ﬁndes til k1 = α1 + jβ1 = −j0, 7071 og k∗ 1 = α1 − jβ1 = j0, 7071 38Impuls invariant z-transformation Eksempel (I) En frekvensnormeret overføringsfunktionen for et 2. ordens Butterworth lavpasﬁlter med afskæringsfrekvens fa = 800 Hz er givet som H(s) = 1 s2 + 1, 414s + 1 og har poler i s = −0, 7071 ± j0, 7071. Ved partialbrøkopløsning kan H(s) skrives H(s) = k1 s + 0, 7071 − j0, 7071 + k∗ 1 s + 0, 7071 + j0, 7071 De normerede koefﬁcienter ﬁndes til k1 = α1 + jβ1 = −j0, 7071 og k∗ 1 = α1 − jβ1 = j0, 7071 39Impuls invariant z-transformation Eksempel (II) De denormerede koefﬁcienter og poler ﬁndes ved multiplikation med afskæringsfrekvensen σ1 = −0, 7071 · 2π · 800 = −3554 ω1 = −0, 7071 · 2π · 800 = 3554 α1 = 0 β1 = −0, 7071 · 2π · 800 = −3554 Ovenstående koefﬁcienter leder til følgende realisationsstruktur og polnulpunktsdiagram når samplefrekvensen er 8 kHz. x(n) + z-1 1,158 Re(z) Im(z) + z-1 -0,411 y(n)0,245 39Impuls invariant z-transformation Eksempel (II) De denormerede koefﬁcienter og poler ﬁndes ved multiplikation med afskæringsfrekvensen σ1 = −0, 7071 · 2π · 800 = −3554 ω1 = −0, 7071 · 2π · 800 = 3554 α1 = 0 β1 = −0, 7071 · 2π · 800 = −3554 Ovenstående koefﬁcienter leder til følgende realisationsstruktur og polnulpunktsdiagram når samplefrekvensen er 8 kHz. x(n) + z-1 1,158 Re(z) Im(z) + z-1 -0,411 y(n)0,245 40Impuls invariant z-transformation Eksempel (III) -60 -40 -20 0Magnitude (dB) 102 103 104 105 -180 -135 -90 -45 0Fase (deg) H(s) H_1(z) H_2(z) Frekvens (rad/s) 41Opsummering Introduktion Design af digitale IIR ﬁltre Matched z-transformation Impuls invariant z-transformation Opsummering 42Opsummering Filter design Et IIR-ﬁlter designes ved at følge proceduren 1. Filtrets speciﬁkationer opstilles 2. Filtrets z-domæne overføringsfunktion opstilles ved brug af ▶ Matched z-transformation ▶ Impuls invariant z-transformation ▶ Bilineær z-transformation 3. Der vælges optimal realisationsstruktur 4. Der fremstilles program til signalprocessor eller tegnes diagram for hardwareløsning 43Opsummering Design procedure ved matched z-transformation Følgende procedure benyttes til design af digitale IIR ﬁltre ved brug af matched z-transformation 1. Bestem det analoge prototypeﬁlters frekvensnormerede og faktoriserede overføringsfunktion H(s). 2. Bestem de analoge frekvensnormerede poler og nulpunkter. 3. Bestem de denormerede poler og nulpunkter. 4. Bestem den digitale overføringsfunktions koefﬁcienter. 5. Implementer overføringsfunktionen som en kaskadestruktur. 44Opsummering Design procedure ved impuls invariant z-transformation Følgende procedure benyttes til design af digitale IIR ﬁltre ved brug af impuls invariant z-transformation 1. Bestem det analoge prototypeﬁlters frekvensnormerede overføringsfunktion H(s). 2. Partialbrøksopløs H(s) til 1. og 2. ordens overføringsfunktioner (maksimalt antal 2. ordens overføringsfunktioner). 3. Denormer koefﬁcienterne ki og polerne σi + jωi ved multiplikation med afskæringsfrekvensen eller centerfrekvensen. 4. Bestem den digitale overføringsfunktions koefﬁcienter. 5. Implementer overføringsfunktionen som en parallelstruktur.","libVersion":"0.2.4","langs":""}