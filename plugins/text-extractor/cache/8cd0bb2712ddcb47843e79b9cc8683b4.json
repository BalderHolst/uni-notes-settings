{"path":"Lessons/Semester 3/signalbehandling/Slides/lektion 10 - Introduktion til FIR filtre.pdf","text":"Lektion 10: Introduktion til FIR-ﬁltre Signalbehandling Christoffer Sloth chsl@mmmi.sdu.dk SDU Robotics The Maersk Mc-Kinney Moller Institute University of Southern Denmark 1Agenda Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 2Introduktion Pensum for Signalbehandling Datakonvertering og digital signalbehandling herunder: 1 ▶ ideel og praktisk sampling og rekonstruktion ▶ aliasing ▶ kvantisering og dynamikområde ▶ konverteringsprincipper (A/D og D/A) ▶ implementationsprincipper (Sample & Hold, A/D, D/A) ▶ multirate sampling ▶ diskret-tid signaler og systemer i tids- og frekvensdomænet ▶ Z-transformationen ▶ overføringsfunktion for lineære tidsinvariante systemer ▶ systemanalyse ▶ frekvensanalyse ▶ lineær fase systemer ▶ realisationsstrukturer for diskret-tid systemer ▶ hovedanvendelse af digital signalbehandling herunder digitale IIR-ﬁltre og transformation af analoge ﬁltre samt digitale FIR-ﬁltre og vindues-funktioner 1 Baseret på https://odin.sdu.dk/sitecore/index.php?a=fagbesk&id=65003&listid=9093&lang=da 3Introduktion Course Overview ▶ Lektion 1: Filterfunktioner ▶ Lektion 2: Sampling og rekonstruktion ▶ Lektion 3: Fast Fourier transformation (I) ▶ Lektion 4: Fast Fourier transformation (II) ▶ Lektion 5: Introduktion til z-transformation ▶ Lektion 6: Systemanalyse i z-domæne ▶ Lektion 7: Digitale realisationsstrukturer ▶ Lektion 8: Introduktion til IIR-ﬁltre ▶ Lektion 9: Design af IIR-ﬁltre ▶ Lektion 10: Introduktion til FIR-ﬁltre ▶ Lektion 11: Design af FIR-ﬁltre ▶ Lektion 12: Anvendelse af digital signalbehandling 4FIR-ﬁlter Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 5Introduktion Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 6FIR-ﬁlter Deﬁnition Et ﬁnite impulse response ﬁlter (FIR-ﬁlter) har et endeligt impulsrespons, som deﬁnerer ﬁltrets størrelse. Et FIR-ﬁlter med N samples har impulsresponssekvens h(n) = {an for 0 ≤ n ≤ N − 1 0 ellers Filtret har dermed N koefﬁcienter an for n = 0, 1, . . . , N − 1. n h(n) 86420 1 a0 a1 a2 a3 a4 a5 a6 6FIR-ﬁlter Deﬁnition Et ﬁnite impulse response ﬁlter (FIR-ﬁlter) har et endeligt impulsrespons, som deﬁnerer ﬁltrets størrelse. Et FIR-ﬁlter med N samples har impulsresponssekvens h(n) = {an for 0 ≤ n ≤ N − 1 0 ellers Filtret har dermed N koefﬁcienter an for n = 0, 1, . . . , N − 1. n h(n) 86420 1 a0 a1 a2 a3 a4 a5 a6 6FIR-ﬁlter Deﬁnition Et ﬁnite impulse response ﬁlter (FIR-ﬁlter) har et endeligt impulsrespons, som deﬁnerer ﬁltrets størrelse. Et FIR-ﬁlter med N samples har impulsresponssekvens h(n) = {an for 0 ≤ n ≤ N − 1 0 ellers Filtret har dermed N koefﬁcienter an for n = 0, 1, . . . , N − 1. n h(n) 86420 1 a0 a1 a2 a3 a4 a5 a6 7FIR-ﬁlter Overføringsfunktion FIR-ﬁltrets impulsrespons kan skrives h(n) = N −1∑ i=0 aiδ(n − i) Ved z-transformation af h(n) fås H(z) = Y (z) X(z) = Z{h(n)} = N −1∑ i=0 aiz−i Overføringsfunktionen kan skrives med positive potenser som H(z) = Y (z) X(z) = ∑N −1 i=0 aizN −1−i zN −1 hvoraf det ses at H(z) har N − 1 poler i origo for z-planen og N − 1 nulpunkter. 7FIR-ﬁlter Overføringsfunktion FIR-ﬁltrets impulsrespons kan skrives h(n) = N −1∑ i=0 aiδ(n − i) Ved z-transformation af h(n) fås H(z) = Y (z) X(z) = Z{h(n)} = N −1∑ i=0 aiz−i Overføringsfunktionen kan skrives med positive potenser som H(z) = Y (z) X(z) = ∑N −1 i=0 aizN −1−i zN −1 hvoraf det ses at H(z) har N − 1 poler i origo for z-planen og N − 1 nulpunkter. 7FIR-ﬁlter Overføringsfunktion FIR-ﬁltrets impulsrespons kan skrives h(n) = N −1∑ i=0 aiδ(n − i) Ved z-transformation af h(n) fås H(z) = Y (z) X(z) = Z{h(n)} = N −1∑ i=0 aiz−i Overføringsfunktionen kan skrives med positive potenser som H(z) = Y (z) X(z) = ∑N −1 i=0 aizN −1−i zN −1 hvoraf det ses at H(z) har N − 1 poler i origo for z-planen og N − 1 nulpunkter. 8FIR-ﬁlter Realisationsstruktur Fra overføringsfunktionen H(z) = Y (z) X(z) = N −1∑ i=0 aiz−i ses det at Y (z) = X(z) N −1∑ i=0 aiz−i Ved invers z-transformation fås y(n) = N −1∑ i=0 aix(n − i) z-1 a0 x(n) y(n) z-1 + z-1 + z-1 + + a1 a2 a3 a4 8FIR-ﬁlter Realisationsstruktur Fra overføringsfunktionen H(z) = Y (z) X(z) = N −1∑ i=0 aiz−i ses det at Y (z) = X(z) N −1∑ i=0 aiz−i Ved invers z-transformation fås y(n) = N −1∑ i=0 aix(n − i) z-1 a0 x(n) y(n) z-1 + z-1 + z-1 + + a1 a2 a3 a4 8FIR-ﬁlter Realisationsstruktur Fra overføringsfunktionen H(z) = Y (z) X(z) = N −1∑ i=0 aiz−i ses det at Y (z) = X(z) N −1∑ i=0 aiz−i Ved invers z-transformation fås y(n) = N −1∑ i=0 aix(n − i) z-1 a0 x(n) y(n) z-1 + z-1 + z-1 + + a1 a2 a3 a4 9FIR-ﬁlter Eksempel Følgende er pol-nulpunktsdiagram for et 8. ordens FIR-ﬁlter. Re(z) Im(z) 8. orden Filtret har lineær fase da nulpunkterne er i par, så hvis der er et nulpunkt i z = r∠ϕ så er der også et nulpunkt i z = 1/r∠ϕ. 9FIR-ﬁlter Eksempel Følgende er pol-nulpunktsdiagram for et 8. ordens FIR-ﬁlter. Re(z) Im(z) 8. orden Filtret har lineær fase da nulpunkterne er i par, så hvis der er et nulpunkt i z = r∠ϕ så er der også et nulpunkt i z = 1/r∠ϕ. 10Lineær fase Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 11Lineær fase Betingelse Et FIR ﬁlter med N ≥ 2 samples har lineær fase hvis dets impulsrespons er symmetrisk omkring midtpunktet, dvs. h(i) = h(N − 1 − i) for i = 0, 1, . . . , ⌊N/2⌋ − 1 n h(n) 86420 1 a0 a1 a2 a3 a4 a5 a6 n h(n) 86420 1 a0 a1 a2 a3 a4 a5 N ligeN ulige N −1 2 N −2 2 N 2 11Lineær fase Betingelse Et FIR ﬁlter med N ≥ 2 samples har lineær fase hvis dets impulsrespons er symmetrisk omkring midtpunktet, dvs. h(i) = h(N − 1 − i) for i = 0, 1, . . . , ⌊N/2⌋ − 1 n h(n) 86420 1 a0 a1 a2 a3 a4 a5 a6 n h(n) 86420 1 a0 a1 a2 a3 a4 a5 N ligeN ulige N −1 2 N −2 2 N 2 12Lineær fase Antagelse I det følgende antages det at N er ulige og den midterste sample får index M = N − 1 2 n h(n) 2M0 a0 aM a2M N ulige M Dette betyder at h(n) = h(2M − n) og ai = a2M −i 12Lineær fase Antagelse I det følgende antages det at N er ulige og den midterste sample får index M = N − 1 2 n h(n) 2M0 a0 aM a2M N ulige M Dette betyder at h(n) = h(2M − n) og ai = a2M −i 12Lineær fase Antagelse I det følgende antages det at N er ulige og den midterste sample får index M = N − 1 2 n h(n) 2M0 a0 aM a2M N ulige M Dette betyder at h(n) = h(2M − n) og ai = a2M −i 13Frekvensresponsanalyse Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 14Frekvensresponsanalyse Introduktion Når et FIR-ﬁlter designes kan ordenstallet ikke bestemmes nøjagtigt på forhånd som ved IIR-ﬁltret. Derfor kan det være nødvendigt at redesigne ﬁltret for at opnå en ønsket ﬁlterspeciﬁkation. I den følgende analyse antages det at N er ulige. n h(n) 2M0 a0 aM a2M N ulige M h1(n) h2(n) h(M ) 14Frekvensresponsanalyse Introduktion Når et FIR-ﬁlter designes kan ordenstallet ikke bestemmes nøjagtigt på forhånd som ved IIR-ﬁltret. Derfor kan det være nødvendigt at redesigne ﬁltret for at opnå en ønsket ﬁlterspeciﬁkation. I den følgende analyse antages det at N er ulige. n h(n) 2M0 a0 aM a2M N ulige M h1(n) h2(n) h(M ) 15Frekvensresponsanalyse Reformulering af impulsrespons (I) Udtrykket for et FIR-ﬁlters impulsrespons kan opdeles som følger h(n) = h1(n) + h(M ) + h2(n) Dette kan skrives h(n) = M −1∑ i=0 aiδ(n − i) + aM δ(n − M ) + 2M∑ i=M +1 aiδ(n − i) eller h(n) = M −1∑ i=0 aiδ(n − i) + aM δ(n − M ) + M −1∑ i=0 aiδ(n − (2M − i)) = aM δ(n − M ) + M −1∑ i=0 ai (δ(n − i) + δ(n − (2M − i))) 15Frekvensresponsanalyse Reformulering af impulsrespons (I) Udtrykket for et FIR-ﬁlters impulsrespons kan opdeles som følger h(n) = h1(n) + h(M ) + h2(n) Dette kan skrives h(n) = M −1∑ i=0 aiδ(n − i) + aM δ(n − M ) + 2M∑ i=M +1 aiδ(n − i) eller h(n) = M −1∑ i=0 aiδ(n − i) + aM δ(n − M ) + M −1∑ i=0 aiδ(n − (2M − i)) = aM δ(n − M ) + M −1∑ i=0 ai (δ(n − i) + δ(n − (2M − i))) 15Frekvensresponsanalyse Reformulering af impulsrespons (I) Udtrykket for et FIR-ﬁlters impulsrespons kan opdeles som følger h(n) = h1(n) + h(M ) + h2(n) Dette kan skrives h(n) = M −1∑ i=0 aiδ(n − i) + aM δ(n − M ) + 2M∑ i=M +1 aiδ(n − i) eller h(n) = M −1∑ i=0 aiδ(n − i) + aM δ(n − M ) + M −1∑ i=0 aiδ(n − (2M − i)) = aM δ(n − M ) + M −1∑ i=0 ai (δ(n − i) + δ(n − (2M − i))) 16Frekvensresponsanalyse Reformulering af impulsrespons (II) Fra impulsresponssekvensen kan overføringsfunktionen ﬁndes ved z-transformation som H(z) = aM z−M + M −1∑ i=0 ai (z−i + z−(2M −i)) = aM z−M + M −1∑ i=0 aiz−M (zM −i + z−(M −i)) For at ﬁnde frekvensresponset, erstattes z med e jωT = ejπf /fo og vi får H(ejπf /fo) = aM e−jM πf /fo + M −1∑ i=0 aie −jM πf /fo (e j(M −i)πf /fo + e−j(M −i)πf /fo) Dette kan skrives (γ := f /fo) H(γ) = e−jM πγ ( aM + M −1∑ i=0 2ai cos((M − i)γπ) ) 16Frekvensresponsanalyse Reformulering af impulsrespons (II) Fra impulsresponssekvensen kan overføringsfunktionen ﬁndes ved z-transformation som H(z) = aM z−M + M −1∑ i=0 ai (z−i + z−(2M −i)) = aM z−M + M −1∑ i=0 aiz−M (zM −i + z−(M −i)) For at ﬁnde frekvensresponset, erstattes z med e jωT = ejπf /fo og vi får H(ejπf /fo) = aM e−jM πf /fo + M −1∑ i=0 aie −jM πf /fo (e j(M −i)πf /fo + e−j(M −i)πf /fo) Dette kan skrives (γ := f /fo) H(γ) = e−jM πγ ( aM + M −1∑ i=0 2ai cos((M − i)γπ) ) 16Frekvensresponsanalyse Reformulering af impulsrespons (II) Fra impulsresponssekvensen kan overføringsfunktionen ﬁndes ved z-transformation som H(z) = aM z−M + M −1∑ i=0 ai (z−i + z−(2M −i)) = aM z−M + M −1∑ i=0 aiz−M (zM −i + z−(M −i)) For at ﬁnde frekvensresponset, erstattes z med e jωT = ejπf /fo og vi får H(ejπf /fo) = aM e−jM πf /fo + M −1∑ i=0 aie −jM πf /fo (e j(M −i)πf /fo + e−j(M −i)πf /fo) Dette kan skrives (γ := f /fo) H(γ) = e−jM πγ ( aM + M −1∑ i=0 2ai cos((M − i)γπ) ) 17Frekvensresponsanalyse Amplitude og fase Overføringsfunktionen H(γ) = e−jM πγ ( aM + M −1∑ i=0 2ai cos((M − i)γπ) ) har amplitude |H(γ)| = aM + M −1∑ i=0 2ai cos((M − i)γπ) og fase ∠H(γ) = −M πγ Dette giver en gruppeløbstid Tg = − dϕ(ω) dω = M T = N − 1 2 T hvor T er sampleintervallet [s] og ϕ(ω) er fasen af H(ω). 17Frekvensresponsanalyse Amplitude og fase Overføringsfunktionen H(γ) = e−jM πγ ( aM + M −1∑ i=0 2ai cos((M − i)γπ) ) har amplitude |H(γ)| = aM + M −1∑ i=0 2ai cos((M − i)γπ) og fase ∠H(γ) = −M πγ Dette giver en gruppeløbstid Tg = − dϕ(ω) dω = M T = N − 1 2 T hvor T er sampleintervallet [s] og ϕ(ω) er fasen af H(ω). 17Frekvensresponsanalyse Amplitude og fase Overføringsfunktionen H(γ) = e−jM πγ ( aM + M −1∑ i=0 2ai cos((M − i)γπ) ) har amplitude |H(γ)| = aM + M −1∑ i=0 2ai cos((M − i)γπ) og fase ∠H(γ) = −M πγ Dette giver en gruppeløbstid Tg = − dϕ(ω) dω = M T = N − 1 2 T hvor T er sampleintervallet [s] og ϕ(ω) er fasen af H(ω). 18Frekvensresponsanalyse Eksempel (koefﬁcienter) Betragt et FIR-ﬁlter med følgende realisationsstruktur og samplefrekvens fs = 40 kHz. z-10,005 x(n) y(n) z-1 + z-1 + z-1 + + z-1z-1 + z-1 + z-1 + + z-1z-1 + +000,2900,500-0,0420,2900-0,04200,005 Hvad er ﬁltrets M -værdi? Hvad er ﬁltrets koefﬁcienter? 18Frekvensresponsanalyse Eksempel (koefﬁcienter) Betragt et FIR-ﬁlter med følgende realisationsstruktur og samplefrekvens fs = 40 kHz. z-10,005 x(n) y(n) z-1 + z-1 + z-1 + + z-1z-1 + z-1 + z-1 + + z-1z-1 + +000,2900,500-0,0420,2900-0,04200,005 Hvad er ﬁltrets M -værdi? Hvad er ﬁltrets koefﬁcienter? 18Frekvensresponsanalyse Eksempel (koefﬁcienter) Betragt et FIR-ﬁlter med følgende realisationsstruktur og samplefrekvens fs = 40 kHz. z-10,005 x(n) y(n) z-1 + z-1 + z-1 + + z-1z-1 + z-1 + z-1 + + z-1z-1 + +000,2900,500-0,0420,2900-0,04200,005 Hvad er ﬁltrets M -værdi? Hvad er ﬁltrets koefﬁcienter? 19Frekvensresponsanalyse Eksempel (amplitude og fase) Forstærkningen af ﬁltret ﬁndes ved f = 10 kHz som |H(10k)| = 20 log [ 0, 5 + 4∑ i=0 2ai cos ((5 − i) π 2 ) ] = −6, 02 dB hvor γ = f fo = 10k 20k = 0, 5 Fasen bliver ϕ(10k) = −M γπ = − 5π 2 19Frekvensresponsanalyse Eksempel (amplitude og fase) Forstærkningen af ﬁltret ﬁndes ved f = 10 kHz som |H(10k)| = 20 log [ 0, 5 + 4∑ i=0 2ai cos ((5 − i) π 2 ) ] = −6, 02 dB hvor γ = f fo = 10k 20k = 0, 5 Fasen bliver ϕ(10k) = −M γπ = − 5π 2 20Frekvensresponsanalyse Eksempel (Bode plot) |H(f )| [dB] ϕ(f ) [◦ ] f [Hz] 0 -200 -400 0 -20 -40 -60 0 5k 10k 15k 20k -600 -800 |H(f )| ϕ(f ) 21Design af FIR-ﬁlter Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 22Design af FIR-ﬁlter Introduktion Vi benytter Fourierkoefﬁcientmetoden til udregning af FIR-ﬁltres koefﬁcienter. Denne metode er basseret på Fouriertransformation af amplitudesprekret af det ønskede ﬁlter. Ved Fouriertransformation kan et periodisk signal f (t) med periode T opløses i et uendeligt antal diskrete frekvenskomposanter ved frekvenser der er heltalsmultipla af grundfrekvensen f1 = 1/T . t f (t) T-T 0 T 2 - T 2 f H(f ) 2 T 0 1 T - 1 T - 2 T Da ﬁltrets amplitudekarakteristik |H(f )| er periodisk med fs kan denne også Fouriertransformeres. Så fåes et signal med diskrete værdier ved heltalsmultipla af 1/fs. f H(f ) fs-fs 0 fo-fo t f (t) 2 fs 0 1 fs - 1 fs - 2 fs 22Design af FIR-ﬁlter Introduktion Vi benytter Fourierkoefﬁcientmetoden til udregning af FIR-ﬁltres koefﬁcienter. Denne metode er basseret på Fouriertransformation af amplitudesprekret af det ønskede ﬁlter. Ved Fouriertransformation kan et periodisk signal f (t) med periode T opløses i et uendeligt antal diskrete frekvenskomposanter ved frekvenser der er heltalsmultipla af grundfrekvensen f1 = 1/T . t f (t) T-T 0 T 2 - T 2 f H(f ) 2 T 0 1 T - 1 T - 2 T Da ﬁltrets amplitudekarakteristik |H(f )| er periodisk med fs kan denne også Fouriertransformeres. Så fåes et signal med diskrete værdier ved heltalsmultipla af 1/fs. f H(f ) fs-fs 0 fo-fo t f (t) 2 fs 0 1 fs - 1 fs - 2 fs 22Design af FIR-ﬁlter Introduktion Ved Fouriertransformation kan et periodisk signal f (t) med periode T opløses i et uendeligt antal diskrete frekvenskomposanter ved frekvenser der er heltalsmultipla af grundfrekvensen f1 = 1/T . t f (t) T-T 0 T 2 - T 2 f H(f ) 2 T 0 1 T - 1 T - 2 T Da ﬁltrets amplitudekarakteristik |H(f )| er periodisk med fs kan denne også Fouriertransformeres. Så fåes et signal med diskrete værdier ved heltalsmultipla af 1/fs. f H(f ) fs-fs 0 fo-fo t f (t) 2 fs 0 1 fs - 1 fs - 2 fs 23Design af FIR-ﬁlter Fourier transformation Lad f (t) være en periodisk funktion med periodetid T og Fourierkoefﬁcienter cm. Så kan f (t) udtrykkes f (t) = ∞∑ m=−∞ cmej2πmf1t hvor f1 er grundfrekvensen (f1 = 1/T ). Samtidig kan Fourierkoefﬁcienterne udtrykkes cm = 1 T ∫ T /2 −T /2 f (t)e−j2πmf1tdt 24Design af FIR-ﬁlter Fourier transformation af |H(s)| Fouriertransformation kan benyttes til alle periodiske signaler inklusiv frekvensresponsfunktionen |H(s)|, dvs. |H(f )| = ∞∑ m=−∞ cmej2πmT f og Fourierkoefﬁcienterne kan udtrykkes cm = 1 fs ∫ fs/2 −fs/2 |H(f )|e −j2πmT f df 25Design af FIR-ﬁlter Fourier transformation Et FIR-ﬁlter har et endeligt impulsrespons. Derfor afskæres Fourierrækken for |H(f )| til 2M + 1 led, dvs. |H(f )| = M∑ m=−M cmej2πmT f Fourierkoefﬁcienterne er givet ved cm = 1 fs ∫ fo −fo |H(f )|e−j2πmT f df = 1 fs ∫ fo −fo |H(f )|(cos(2πmT f ) − j sin(2πmT f ))df For at ﬁltret har lineær fase skal koefﬁcienterne have enten rene cosinus komposanter eller rene sinus komposanter. Bemærk at dette ﬁlter ikke er kausalt. 25Design af FIR-ﬁlter Fourier transformation Et FIR-ﬁlter har et endeligt impulsrespons. Derfor afskæres Fourierrækken for |H(f )| til 2M + 1 led, dvs. |H(f )| = M∑ m=−M cmej2πmT f Fourierkoefﬁcienterne er givet ved cm = 1 fs ∫ fo −fo |H(f )|e−j2πmT f df = 1 fs ∫ fo −fo |H(f )|(cos(2πmT f ) − j sin(2πmT f ))df For at ﬁltret har lineær fase skal koefﬁcienterne have enten rene cosinus komposanter eller rene sinus komposanter. Bemærk at dette ﬁlter ikke er kausalt. 25Design af FIR-ﬁlter Fourier transformation Et FIR-ﬁlter har et endeligt impulsrespons. Derfor afskæres Fourierrækken for |H(f )| til 2M + 1 led, dvs. |H(f )| = M∑ m=−M cmej2πmT f Fourierkoefﬁcienterne er givet ved cm = 1 fs ∫ fo −fo |H(f )|e−j2πmT f df = 1 fs ∫ fo −fo |H(f )|(cos(2πmT f ) − j sin(2πmT f ))df For at ﬁltret har lineær fase skal koefﬁcienterne have enten rene cosinus komposanter eller rene sinus komposanter. Bemærk at dette ﬁlter ikke er kausalt. 26Design af FIR-ﬁlter Fourier transformation af lige funktion Da lavpas, højpas, båndpas og båndstopﬁltre er genereret at et amplituderespons, der er en lige funktion antages dette i det følgende, hvorved Fourierkoefﬁcienterne er givet ved cm = 1 fs ∫ fo −fo |H(f )| cos(2πmT f )df Da integranten er en lige funktion kan koefﬁcienterne udregnes som cm = c−m = 2 fs ∫ fo 0 |H(f )| cos(2πmT f )df 26Design af FIR-ﬁlter Fourier transformation af lige funktion Da lavpas, højpas, båndpas og båndstopﬁltre er genereret at et amplituderespons, der er en lige funktion antages dette i det følgende, hvorved Fourierkoefﬁcienterne er givet ved cm = 1 fs ∫ fo −fo |H(f )| cos(2πmT f )df Da integranten er en lige funktion kan koefﬁcienterne udregnes som cm = c−m = 2 fs ∫ fo 0 |H(f )| cos(2πmT f )df 27Design af FIR-ﬁlter Filterkoefﬁcienter Ud fra |H(f )| = M∑ m=−M cmej2πmT f og z = ej2πf T ses det at H(z) = M∑ m=−M cmzm Da dette ﬁlter ikke er kausalt, introduceres en forsinkelse på M samples H(z) = z−M M∑ m=−M cmzm = M∑ m=−M cmzm−M = 2M∑ i=0 cM −iz−i Ud fra ovenstående formel kan ﬁlterkoefﬁcienterne bestemmes ved ai = cM −i 27Design af FIR-ﬁlter Filterkoefﬁcienter Ud fra |H(f )| = M∑ m=−M cmej2πmT f og z = ej2πf T ses det at H(z) = M∑ m=−M cmzm Da dette ﬁlter ikke er kausalt, introduceres en forsinkelse på M samples H(z) = z−M M∑ m=−M cmzm = M∑ m=−M cmzm−M = 2M∑ i=0 cM −iz−i Ud fra ovenstående formel kan ﬁlterkoefﬁcienterne bestemmes ved ai = cM −i 28Eksempler Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 29Lavpasﬁlter Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 30Lavpasﬁlter Udregning af koefﬁcienter Et ideelt lavpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for 0 < f < fa 0 for fa < f < fo f H(f ) fs-fs 0 fo-fo fa Lavpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa 0 1 · cos(2πmT f )d2πmT f = 1 mπ [sin(2πmT f )] fa f =0 = 1 mπ sin(2πmT fa) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T fa sin(2πmT fa) 2πmT fa = 2T fa 30Lavpasﬁlter Udregning af koefﬁcienter Et ideelt lavpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for 0 < f < fa 0 for fa < f < fo Lavpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa 0 1 · cos(2πmT f )d2πmT f = 1 mπ [sin(2πmT f )] fa f =0 = 1 mπ sin(2πmT fa) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T fa sin(2πmT fa) 2πmT fa = 2T fa 30Lavpasﬁlter Udregning af koefﬁcienter Et ideelt lavpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for 0 < f < fa 0 for fa < f < fo Lavpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa 0 1 · cos(2πmT f )d2πmT f = 1 mπ [sin(2πmT f )] fa f =0 = 1 mπ sin(2πmT fa) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T fa sin(2πmT fa) 2πmT fa = 2T fa 31Lavpasﬁlter Eksempel (I) Ønskes et lavpasﬁlter med afskæringsfrekvens fa = 2 kHz via FIR-ﬁlter med 23 samples fås M = 23 − 1 2 = 11 Koefﬁcienterne kan dermed ﬁndes ud fra Fourierkoefﬁcienterne som ai = a22−i = c11−i Koefﬁcienterne kan dermed udregnes fra tidligere formler. 31Lavpasﬁlter Eksempel (I) Ønskes et lavpasﬁlter med afskæringsfrekvens fa = 2 kHz via FIR-ﬁlter med 23 samples fås M = 23 − 1 2 = 11 Koefﬁcienterne kan dermed ﬁndes ud fra Fourierkoefﬁcienterne som ai = a22−i = c11−i Koefﬁcienterne kan dermed udregnes fra tidligere formler. 31Lavpasﬁlter Eksempel (I) Ønskes et lavpasﬁlter med afskæringsfrekvens fa = 2 kHz via FIR-ﬁlter med 23 samples fås M = 23 − 1 2 = 11 Koefﬁcienterne kan dermed ﬁndes ud fra Fourierkoefﬁcienterne som ai = a22−i = c11−i Koefﬁcienterne kan dermed udregnes fra tidligere formler. 32Lavpasﬁlter Eksempel (II) |H(f )| [dB] ϕ(f ) [◦ ] f [Hz] 0 -600 0 -10 -20 -40 0 1k 2k 15k 4k -1000 -1500 |H(f )| ϕ(f ) -30 33Højpasﬁlter Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 34Højpasﬁlter Udregning af koefﬁcienter Et ideelt højpasﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for 0 < f < fa 1 for fa < f < fo f H(f ) fs-fs 0 fo-fo fa Højpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fo fa 1 · cos(2πmT f )d2πmT f = 1 mπ [sin(2πmT f )] fo f =fa = 1 mπ (sin(mπ) − sin(2πmT fa)) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T fa 34Højpasﬁlter Udregning af koefﬁcienter Et ideelt højpasﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for 0 < f < fa 1 for fa < f < fo Højpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fo fa 1 · cos(2πmT f )d2πmT f = 1 mπ [sin(2πmT f )] fo f =fa = 1 mπ (sin(mπ) − sin(2πmT fa)) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T fa 34Højpasﬁlter Udregning af koefﬁcienter Et ideelt højpasﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for 0 < f < fa 1 for fa < f < fo Højpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fo fa 1 · cos(2πmT f )d2πmT f = 1 mπ [sin(2πmT f )] fo f =fa = 1 mπ (sin(mπ) − sin(2πmT fa)) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T fa 35Båndpasﬁlter Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 36Båndpasﬁlter Udregning af koefﬁcienter Et ideelt båndpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for fa1 < f < fa2 0 ellers Båndpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa2 fa1 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(2πmT fa2) − sin(2πmT fa1 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 36Båndpasﬁlter Udregning af koefﬁcienter Et ideelt båndpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for fa1 < f < fa2 0 ellers Båndpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa2 fa1 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(2πmT fa2) − sin(2πmT fa1 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 36Båndpasﬁlter Udregning af koefﬁcienter Et ideelt båndpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for fa1 < f < fa2 0 ellers Båndpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa2 fa1 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(2πmT fa2) − sin(2πmT fa1 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 36Båndpasﬁlter Udregning af koefﬁcienter Et ideelt båndpasﬁlter har følgende amplitudekarakteristik |H(f )| = {1 for fa1 < f < fa2 0 ellers Båndpasﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa2 fa1 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(2πmT fa2) − sin(2πmT fa1 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 37Båndstopﬁlter Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 38Båndstopﬁlter Udregning af koefﬁcienter Et ideelt båndstopﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for fa1 < f < fa2 1 ellers Båndstopﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa1 0 1 · cos(2πmT f )d2πmT f + 1 mπ ∫ fo fa2 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(mπ) + sin(2πmT fa1) − sin(2πmT fa2 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 38Båndstopﬁlter Udregning af koefﬁcienter Et ideelt båndstopﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for fa1 < f < fa2 1 ellers Båndstopﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa1 0 1 · cos(2πmT f )d2πmT f + 1 mπ ∫ fo fa2 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(mπ) + sin(2πmT fa1) − sin(2πmT fa2 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 38Båndstopﬁlter Udregning af koefﬁcienter Et ideelt båndstopﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for fa1 < f < fa2 1 ellers Båndstopﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa1 0 1 · cos(2πmT f )d2πmT f + 1 mπ ∫ fo fa2 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(mπ) + sin(2πmT fa1) − sin(2πmT fa2 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 38Båndstopﬁlter Udregning af koefﬁcienter Et ideelt båndstopﬁlter har følgende amplitudekarakteristik |H(f )| = {0 for fa1 < f < fa2 1 ellers Båndstopﬁltrets koefﬁcienter kan derfor beregnes som (for m ̸= 0) cm = c−m = 1 mπ ∫ fa1 0 1 · cos(2πmT f )d2πmT f + 1 mπ ∫ fo fa2 1 · cos(2πmT f )d2πmT f = 1 mπ (sin(mπ) + sin(2πmT fa1) − sin(2πmT fa2 )) Sidste koefﬁcient er (ved brug af L’Hospitals regel) c0 = 1 − 2T (fa2 − fa1 ) Dette giver en centerfrekvens fc = fa2 − fa1 2 39Opsummering Introduktion FIR-ﬁlter Introduktion Lineær fase Frekvensresponsanalyse Design af FIR-ﬁlter Eksempler Lavpasﬁlter Højpasﬁlter Båndpasﬁlter Båndstopﬁlter Opsummering 40Opsummering FIR-ﬁlter Et ﬁnite impulse response ﬁlter (FIR-ﬁlter) med N samples har impulsresponssekvens h(n) = {an for 0 ≤ n ≤ N − 1 0 ellers Filtret har N koefﬁcienter an for n = 0, 1, . . . , N − 1. n h(n) 86420 1 a0 a1 a2 a3 a4 a5 a6 41Opsummering Lineær fase Et FIR-ﬁlter med N ≥ 2 samples har lineær fase hvis dets impulsrespons er symmetrisk omkring midtpunktet, dvs. h(i) = h(N − 1 − i) for i = 0, 1, . . . , ⌊N/2⌋ − 1 Et FIR-ﬁlter har lineær fase hvis nulpunkterne er i par, så hvis der er et nulpunkt i z = r∠ϕ så er der også et nulpunkt i z = 1/r∠ϕ. 42Opsummering Fourierkoefﬁcienter Følgende viser en oversigt over Fourierkoefﬁcienter for de ﬁre ﬁltertyper. Filtertype c0 cm = c−m ai Lavpas 2T fa 1 mπ sin(2πmT fa) cM −i Højpas 1 − 2T fa 1 mπ (sin(mπ) − sin(2πmT fa)) cM −i Båndpas 2T (fa2 − fa1) 1 mπ (sin(2πmT fa2 ) − sin(2πmT fa1 )) cM −i Båndstop 1 − 2T (fa2 − fa1) 1 mπ (sin(mπ) + sin(2πmT fa1) − sin(2πmT fa2)) cM −i","libVersion":"0.2.4","langs":""}