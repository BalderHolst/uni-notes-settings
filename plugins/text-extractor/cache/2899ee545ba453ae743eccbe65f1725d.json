{"path":"Lessons/Semester 3/signalbehandling/Slides/lektion 11 - Design af FIR filtre.pdf","text":"Lektion 11: Design af FIR-ﬁltre Signalbehandling Christoffer Sloth chsl@mmmi.sdu.dk SDU Robotics The Maersk Mc-Kinney Moller Institute University of Southern Denmark 1Agenda Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 2Introduktion Pensum for Signalbehandling Datakonvertering og digital signalbehandling herunder: 1 ▶ ideel og praktisk sampling og rekonstruktion ▶ aliasing ▶ kvantisering og dynamikområde ▶ konverteringsprincipper (A/D og D/A) ▶ implementationsprincipper (Sample & Hold, A/D, D/A) ▶ multirate sampling ▶ diskret-tid signaler og systemer i tids- og frekvensdomænet ▶ Z-transformationen ▶ overføringsfunktion for lineære tidsinvariante systemer ▶ systemanalyse ▶ frekvensanalyse ▶ lineær fase systemer ▶ realisationsstrukturer for diskret-tid systemer ▶ hovedanvendelse af digital signalbehandling herunder digitale IIR-ﬁltre og transformation af analoge ﬁltre samt digitale FIR-ﬁltre og vindues-funktioner 1 Baseret på https://odin.sdu.dk/sitecore/index.php?a=fagbesk&id=65003&listid=9093&lang=da 3Introduktion Course Overview ▶ Lektion 1: Filterfunktioner ▶ Lektion 2: Sampling og rekonstruktion ▶ Lektion 3: Fast Fourier transformation (I) ▶ Lektion 4: Fast Fourier transformation (II) ▶ Lektion 5: Introduktion til z-transformation ▶ Lektion 6: Systemanalyse i z-domæne ▶ Lektion 7: Digitale realisationsstrukturer ▶ Lektion 8: Introduktion til IIR-ﬁltre ▶ Lektion 9: Design af IIR-ﬁltre ▶ Lektion 10: Introduktion til FIR-ﬁltre ▶ Lektion 11: Design af FIR-ﬁltre ▶ Lektion 12: Anvendelse af digital signalbehandling 4Introduktion Pasbånds- og stopbåndsripple I sidste lektion blev det konkluderet at pasbånds- og stopbåndsripplen ved FIR-ﬁltre er for stor. |H(f )| [dB] ϕ(f ) [◦ ] f [Hz] 0 -600 0 -10 -20 -40 0 1k 2k 15k 4k -1000 -1500 |H(f )| ϕ(f ) -30 For at mindske ripplen, så introduceres vinduesfunktioner. 4Introduktion Pasbånds- og stopbåndsripple I sidste lektion blev det konkluderet at pasbånds- og stopbåndsripplen ved FIR-ﬁltre er for stor. |H(f )| [dB] ϕ(f ) [◦ ] f [Hz] 0 -600 0 -10 -20 -40 0 1k 2k 15k 4k -1000 -1500 |H(f )| ϕ(f ) -30 For at mindske ripplen, så introduceres vinduesfunktioner. 5Vinduesfunktioner Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 6Vinduesfunktioner Introduktion Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 7Vinduesfunktioner Fourierkoefﬁcientmetoden Fourierkoefﬁcientmetoden benyttes til at ﬁnde FIR-ﬁltres koefﬁcienter ved Fouriertransformation af frekvensresponsfunktionen |H(f )|, dvs. |H(f )| = ∞∑ m=−∞ cmej2πmT f og Fourierkoefﬁcienterne kan udtrykkes cm = 1 fs ∫ fs/2 −fs/2 |H(f )|e −j2πmT f df For at opnå et endeligt impulsrespons, så afskæres Fourierrækken for |H(f )| så den har 2M + 1 led, dvs. |H(f )| = M∑ m=−M cmej2πmT f 7Vinduesfunktioner Fourierkoefﬁcientmetoden Fourierkoefﬁcientmetoden benyttes til at ﬁnde FIR-ﬁltres koefﬁcienter ved Fouriertransformation af frekvensresponsfunktionen |H(f )|, dvs. |H(f )| = ∞∑ m=−∞ cmej2πmT f og Fourierkoefﬁcienterne kan udtrykkes cm = 1 fs ∫ fs/2 −fs/2 |H(f )|e −j2πmT f df For at opnå et endeligt impulsrespons, så afskæres Fourierrækken for |H(f )| så den har 2M + 1 led, dvs. |H(f )| = M∑ m=−M cmej2πmT f 8Vinduesfunktioner Vinduesfunktion (I) Hvis det tidligere impulsrespons ikke var blevet trunkeret, så ville det være uendeligt - dette kaldes h∞(n). For at opnå FIR-ﬁltrets impulsrespons kunne h∞(n) ganges med den rektangulære vinduesfunktion, dvs. h(n) = h∞(n)w(n) hvor w(n) = { 1 hvis − M ≤ n ≤ M 0 ellers 9Vinduesfunktioner Vinduesfunktion (II) n h∞(n) 0 M-M n w(n) 0 M-M n h(n) 0 M-M 10Vinduesfunktioner Frekvensrespons (I) Frekvensresponset for impulsresponssekvensen h(n) fås ved foldning H(f ) = H∞(f ) ∗ W (f ) = ∫ ∞ −∞ H∞(f )W (f − F )dF f W (f ) W (0) −k 2M T k 2M T n w(n) Spektret mellem nulgennemgange omkring 0 Hz kaldes main lobe. Resterende spektrum er side lobes. 10Vinduesfunktioner Frekvensrespons (I) Frekvensresponset for impulsresponssekvensen h(n) fås ved foldning H(f ) = H∞(f ) ∗ W (f ) = ∫ ∞ −∞ H∞(f )W (f − F )dF f W (f ) W (0) −k 2M T k 2M T n w(n) Spektret mellem nulgennemgange omkring 0 Hz kaldes main lobe. Resterende spektrum er side lobes. 11Vinduesfunktioner Frekvensrespons (I) Husk procedure for foldning H(f ) = H∞(f ) ∗ W (f ) Denne følger proceduren 1. W (−F ) ﬁndes ved spejling af W (f ) omkring y-aksen 2. W (−F ) forskydes fra venstre mod højre langs frekvens-aksen. 3. Produktet H∞(F )W (f − F ) udregnes 4. H(f ) er lig arealet under kurven for H∞(F )W (f − F ) 12Vinduesfunktioner Frekvensrespons (III) W (−F ) F H∞(F ) F fa F fa W (f2 − F ) W (f3 − F )W (f1 − F ) H(f ) = H∞(F ) ∗ W (f ) F fa Oscillationerne i H(f ) kaldes Gibbs oscillationer og refereres til som Gibbs fænomen. 12Vinduesfunktioner Frekvensrespons (III) W (−F ) F H∞(F ) F fa F fa W (f2 − F ) W (f3 − F )W (f1 − F ) H(f ) = H∞(F ) ∗ W (f ) F fa Oscillationerne i H(f ) kaldes Gibbs oscillationer og refereres til som Gibbs fænomen. 13Vinduesfunktioner Overblik En vinduesfunktion ønskes at have følgende karakteristika ▶ Bredden af main lobe skal være lille. Dette giver en hurtig overgang mellem pasbånd og stopbånd. ▶ Maksimalamplituden af side lobes skal være lille. Dette giver lille pasbånds- og stopbåndsripple. 14Vinduesfunktioner Udregning af ﬁlterkoefﬁcienter Når en vinduesfunktion tilføjes, så svarer dette til en ændring i FIR-ﬁltrets koefﬁcienter. FIR-ﬁltrets nye Fourierkoefﬁcienter c′ m bliver for −M ≤ m ≤ M c ′ m = cmwm hvor wm er den mte koefﬁcient for vinduesfunktionen og cm er den mthe Fourierkoefﬁcient for det ideelle ﬁlter. Nu kan ﬁlterkoefﬁcienterne udregnes som ai = c ′ M −i 14Vinduesfunktioner Udregning af ﬁlterkoefﬁcienter Når en vinduesfunktion tilføjes, så svarer dette til en ændring i FIR-ﬁltrets koefﬁcienter. FIR-ﬁltrets nye Fourierkoefﬁcienter c′ m bliver for −M ≤ m ≤ M c ′ m = cmwm hvor wm er den mte koefﬁcient for vinduesfunktionen og cm er den mthe Fourierkoefﬁcient for det ideelle ﬁlter. Nu kan ﬁlterkoefﬁcienterne udregnes som ai = c ′ M −i 14Vinduesfunktioner Udregning af ﬁlterkoefﬁcienter Når en vinduesfunktion tilføjes, så svarer dette til en ændring i FIR-ﬁltrets koefﬁcienter. FIR-ﬁltrets nye Fourierkoefﬁcienter c′ m bliver for −M ≤ m ≤ M c ′ m = cmwm hvor wm er den mte koefﬁcient for vinduesfunktionen og cm er den mthe Fourierkoefﬁcient for det ideelle ﬁlter. Nu kan ﬁlterkoefﬁcienterne udregnes som ai = c ′ M −i 15Vinduesfunktioner Rektangulær vinduet Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 16Rektangulær vinduet Deﬁnition Et rektangulært vindue er deﬁneret som w(n) = { 1 hvis − M ≤ n ≤ M 0 ellers Spektrumfunktionen for det rektangulære ﬁlter er W (f ) = sin(2πf M t) πf w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 16Rektangulær vinduet Deﬁnition Et rektangulært vindue er deﬁneret som w(n) = { 1 hvis − M ≤ n ≤ M 0 ellers Spektrumfunktionen for det rektangulære ﬁlter er W (f ) = sin(2πf M t) πf w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 17Vinduesfunktioner Bartlett vinduet Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 18Bartlett vinduet Deﬁnition Et Bartlett vindue (triangulært vindue) er deﬁneret som w(n) = {1 − |n| M hvis − M ≤ n ≤ M 0 ellers w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 18Bartlett vinduet Deﬁnition Et Bartlett vindue (triangulært vindue) er deﬁneret som w(n) = {1 − |n| M hvis − M ≤ n ≤ M 0 ellers w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 19Vinduesfunktioner Hamming og Hanning vinduet Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 20Hamming og Hanning vinduet Deﬁnition Hamming og Hanning vinduer er deﬁneret som w(n) = { α + (1 − α) cos( mπ M ) hvis − M ≤ n ≤ M 0 ellers hvor α = 0, 5 for Hanning vinduet og α = 0, 54 for Hamming vinduet. 20Hamming og Hanning vinduet Deﬁnition Hamming og Hanning vinduer er deﬁneret som w(n) = { α + (1 − α) cos( mπ M ) hvis − M ≤ n ≤ M 0 ellers hvor α = 0, 5 for Hanning vinduet og α = 0, 54 for Hamming vinduet. w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 Hamming 20Hamming og Hanning vinduet Deﬁnition Hamming og Hanning vinduer er deﬁneret som w(n) = { α + (1 − α) cos( mπ M ) hvis − M ≤ n ≤ M 0 ellers hvor α = 0, 5 for Hanning vinduet og α = 0, 54 for Hamming vinduet. w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 Hanning 21Vinduesfunktioner Kaiser vinduet Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 22Kaiser vinduet Deﬁnition Kaiser vinduet introduceres, da de øvrige vinduer kun har M som parameter, hvilket gør det umuligt at justere main lobe og side lobes uafhængigt af hinanden. Kaiser vinduer er deﬁneret som w(n) =    I0 (β√1−( n M )2) I0(β) hvis − M ≤ n ≤ M 0 ellers hvor I0(x) er en nulte ordens Besselfunktion, β er en parameter der justerer primært side lobe amplituden (normalt er β mellem 1 og 10). Besselfunktionen er deﬁneret som I0(x) = 1 + ∞∑ k=1 ( 1 k! ( x 2 )k)2 22Kaiser vinduet Deﬁnition Kaiser vinduet introduceres, da de øvrige vinduer kun har M som parameter, hvilket gør det umuligt at justere main lobe og side lobes uafhængigt af hinanden. Kaiser vinduer er deﬁneret som w(n) =    I0 (β√1−( n M )2) I0(β) hvis − M ≤ n ≤ M 0 ellers hvor I0(x) er en nulte ordens Besselfunktion, β er en parameter der justerer primært side lobe amplituden (normalt er β mellem 1 og 10). Besselfunktionen er deﬁneret som I0(x) = 1 + ∞∑ k=1 ( 1 k! ( x 2 )k)2 22Kaiser vinduet Deﬁnition Kaiser vinduet introduceres, da de øvrige vinduer kun har M som parameter, hvilket gør det umuligt at justere main lobe og side lobes uafhængigt af hinanden. Kaiser vinduer er deﬁneret som w(n) =    I0 (β√1−( n M )2) I0(β) hvis − M ≤ n ≤ M 0 ellers hvor I0(x) er en nulte ordens Besselfunktion, β er en parameter der justerer primært side lobe amplituden (normalt er β mellem 1 og 10). Besselfunktionen er deﬁneret som I0(x) = 1 + ∞∑ k=1 ( 1 k! ( x 2 )k)2 23Kaiser vinduet Eksempler w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 w(t) 1 1 t M T W (f ) [dB] 2M f fs1 5432 0 -10 -20 β = π β = 2π 24Design af FIR-ﬁltre Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 25Design af FIR-ﬁltre Introduktion Når en FIR ﬁlter designes skal følgende speciﬁceres 1. Afskæringsfrekvensen fa 2. Maksimal tilladelig bredde af overgangsområde ∆fa 3. Maksimal tilladelig stopbåndsforstærkning Hs 4. Maksimal tilladelig pasbåndsripple Hr 26Design af FIR-ﬁltre Bestemmelse af ordenstal (I) H∞(F ) F fa W (f − F ) F H∞(F )W (f1 − F ) F H(f ) f 26Design af FIR-ﬁltre Bestemmelse af ordenstal (I) H∞(F ) F fa W (f − F ) F H∞(F )W (f1 − F ) F H(f ) f 27Design af FIR-ﬁltre Bestemmelse af ordenstal (II) Det ses af sidste slide at overgangsområde ∆fa ≈ B, hvor B er main lobe bredden. Den frekvensnormerede main lobe bredde er Bn = 2M B fs = 2M ∆f fs Dermed bliver M -værdien M = Bnfs 2∆f 27Design af FIR-ﬁltre Bestemmelse af ordenstal (II) Det ses af sidste slide at overgangsområde ∆fa ≈ B, hvor B er main lobe bredden. Den frekvensnormerede main lobe bredde er Bn = 2M B fs = 2M ∆f fs Dermed bliver M -værdien M = Bnfs 2∆f 27Design af FIR-ﬁltre Bestemmelse af ordenstal (II) Det ses af sidste slide at overgangsområde ∆fa ≈ B, hvor B er main lobe bredden. Den frekvensnormerede main lobe bredde er Bn = 2M B fs = 2M ∆f fs Dermed bliver M -værdien M = Bnfs 2∆f 28Design af FIR-ﬁltre Designprocedure Konstruktionen af et FIR-ﬁlter kan forløbe efter følgende procedure 1. Vælg vinduesfunktion. Dette valg foretagespå baggrund af speciﬁcerede stopbånds- og pasbåndsripple. 2. Bestem ordenstal. Ordenstallet 2M bestemmes ud fra overgangsområde ∆fa 3. Beregn ﬁlterkoefﬁcienter. Filterkoefﬁcienterne udregnes som ai = cM −iwM −i 4. Veriﬁkation. Filtrets amplitudekarakteristik kontrolleres og om nødvendigt redesignes ﬁltret (M -værdi korrigeres). 29Design af FIR-ﬁltre Design af lavpasﬁlter (I) Følgende viser ﬁlterspeciﬁkationen. a) fa = 1, 5 kHz b) ∆f = 1 kHz c) Hs ≤ −50 dB d) fs = 8 kHz 0 Hs H(f ) [dB] fa ∆f f Grundet den store stopbåndsdæmpning skal vinduesfunktionen enten være Hamming eller Kaiser. Vi vælger Hamming. 29Design af FIR-ﬁltre Design af lavpasﬁlter (I) Følgende viser ﬁlterspeciﬁkationen. a) fa = 1, 5 kHz b) ∆f = 1 kHz c) Hs ≤ −50 dB d) fs = 8 kHz 0 Hs H(f ) [dB] fa ∆f f Grundet den store stopbåndsdæmpning skal vinduesfunktionen enten være Hamming eller Kaiser. Vi vælger Hamming. 30Design af FIR-ﬁltre Design af lavpasﬁlter (II) Ordenstallet bestemmes ud fra M = Bnfs 2∆f hvor Bn = 4 for et Hamming ﬁlter. Dermed fås M ≥ 4 · 8000 2 · 1000 = 16 Ordenstallet bliver dermed 2M = 32. 30Design af FIR-ﬁltre Design af lavpasﬁlter (II) Ordenstallet bestemmes ud fra M = Bnfs 2∆f hvor Bn = 4 for et Hamming ﬁlter. Dermed fås M ≥ 4 · 8000 2 · 1000 = 16 Ordenstallet bliver dermed 2M = 32. 30Design af FIR-ﬁltre Design af lavpasﬁlter (II) Ordenstallet bestemmes ud fra M = Bnfs 2∆f hvor Bn = 4 for et Hamming ﬁlter. Dermed fås M ≥ 4 · 8000 2 · 1000 = 16 Ordenstallet bliver dermed 2M = 32. 31Design af FIR-ﬁltre Design af lavpasﬁlter (III) 0 |H(f )| [dB] f [Hz] -50 1k 2k 3k 4k 32Opsummering Introduktion Vinduesfunktioner Introduktion Rektangulær vinduet Bartlett vinduet Hamming og Hanning vinduet Kaiser vinduet Design af FIR-ﬁltre Opsummering 33Opsummering Vinduesfunktioner Vi betragter følgende vinduesfunktioner ▶ Rektangulær ▶ Bartlett ▶ Hamming ▶ Hanning ▶ Kaiser Ved introduktion af vinduesfunktioner kan Fourierkoefﬁcienter for det modiﬁcerede ﬁlter udregnes som c ′ m = cmwm hvor wm er den mte koefﬁcient for vinduesfunktionen og cm er den mthe Fourierkoefﬁcient for det ideelle ﬁlter. Dermed bliver ﬁlterkoefﬁcienterne ai = c ′ M −i 34Opsummering Designprocedure for FIR-ﬁltre Konstruktionen af et FIR-ﬁlter kan forløbe efter følgende procedure 1. Vælg vinduesfunktion. Dette valg foretagespå baggrund af speciﬁcerede stopbånds- og pasbåndsripple. 2. Bestem ordenstal. Ordenstallet 2M bestemmes ud fra overgangsområde ∆fa 3. Beregn ﬁlterkoefﬁcienter. Filterkoefﬁcienterne udregnes som ai = cM −iwM −i 4. Veriﬁkation. Filtrets amplitudekarakteristik kontrolleres og om nødvendigt redesignes ﬁltret (M -værdi korrigeres).","libVersion":"0.2.4","langs":""}